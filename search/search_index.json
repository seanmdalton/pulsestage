{"config":{"lang":["en"],"separator":"[\\s\\-,:!=\\[\\]()\"/]+|(?!\\b)(?=[A-Z][a-z])|\\.(?!\\d)|&[lg]t;","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"PulseStage","text":"<p>Employee engagement platform combining Q&amp;A and pulse surveys.</p> <p>Anonymous question submission, upvoting, team-scoped organization, and weekly sentiment tracking with role-based access control.</p> <p> </p>"},{"location":"#quick-start","title":"Quick Start","text":"<pre><code>git clone https://github.com/seanmdalton/pulsestage.git\ncd pulsestage\n./setup.sh\ndocker compose up\n</code></pre> <p>Visit <code>http://localhost:5173</code> and log in with demo credentials (admin, alice, bob, or moderator).</p> <p>See Installation Guide for production deployment.</p>"},{"location":"#core-features","title":"Core Features","text":""},{"location":"#qa-system","title":"Q&amp;A System","text":"<ul> <li>Anonymous question submission with team assignment</li> <li>Upvoting to surface priorities</li> <li>Full-text search (PostgreSQL GIN indexes)</li> <li>Moderator workflow (answer, tag, pin, freeze)</li> <li>Bulk operations and moderation queue</li> <li>Presentation mode for all-hands meetings</li> </ul>"},{"location":"#weekly-pulse","title":"Weekly Pulse","text":"<ul> <li>Anonymous sentiment surveys with cohort rotation</li> <li>Email invitations via BullMQ queue</li> <li>One-tap response links (7-day expiration)</li> <li>Team-scoped analytics with 12-week history</li> <li>Anonymity enforcement (no userId in responses)</li> </ul>"},{"location":"#access-control","title":"Access Control","text":"<p>Five roles with team-scoped permissions: - Viewer - Browse and upvote - Member - Submit questions and upvote - Moderator - Answer, tag, pin, freeze (team-scoped) - Admin - Full access, exports, audit logs (global) - Owner - Complete control (global)</p> <p>See handbook/SECURITY_MODEL.md for details.</p>"},{"location":"#team-organization","title":"Team Organization","text":"<ul> <li>Multi-team structure (e.g., Engineering, Product)</li> <li>Team-scoped questions and pulse data</li> <li>Org-level rollups for leadership</li> <li>Primary team assignment for users</li> </ul>"},{"location":"#technology","title":"Technology","text":"<ul> <li>Backend: Node.js 24, Express, TypeScript, Prisma</li> <li>Frontend: React 19, TypeScript, Tailwind CSS, Vite</li> <li>Database: PostgreSQL 16 with full-text search</li> <li>Cache: Redis 7 for sessions and rate limiting</li> <li>Queue: BullMQ for email delivery</li> <li>Tests: 336 API tests (Vitest) + E2E (Playwright)</li> <li>Deployment: Docker Compose</li> </ul>"},{"location":"#documentation","title":"Documentation","text":""},{"location":"#getting-started","title":"Getting Started","text":"<ul> <li>Installation - Docker Compose setup</li> <li>Configuration - Environment variables</li> <li>Quick Start - 5-minute setup</li> <li>Troubleshooting - Common issues</li> </ul>"},{"location":"#user-guides","title":"User Guides","text":"<ul> <li>User Guide - Submit questions, upvote, search</li> <li>Moderator Guide - Answer, moderate, present</li> <li>Admin Guide - Manage teams, users, settings</li> </ul>"},{"location":"#handbook-architecture-operations","title":"Handbook (Architecture &amp; Operations)","text":"<ul> <li>Product Vision - Features and design philosophy</li> <li>Data Model - Database schema and invariants</li> <li>Security Model - RBAC, rate limiting, audit logging</li> <li>Authentication - Multi-mode auth (Demo, OAuth)</li> <li>Development - Workflow, testing, versioning</li> <li>Operations - Deployment, monitoring, runbooks</li> <li>API Contracts - OpenAPI spec, SSE events</li> <li>Architecture Decisions - ADRs</li> </ul>"},{"location":"#deployment","title":"Deployment","text":"<ul> <li>Production Deployment - Self-hosting guide</li> <li>Environment Variables - Configuration reference</li> <li>Monitoring - Health checks and observability</li> </ul>"},{"location":"#security","title":"Security","text":"<ul> <li>Multi-tenancy with tenant isolation</li> <li>Role-based access control (5 roles)</li> <li>Content moderation (local + OpenAI)</li> <li>Rate limiting (Redis-based, per-tenant)</li> <li>Audit logging (append-only)</li> <li>CSRF protection and security headers</li> <li>Anonymous pulse responses</li> </ul> <p>See handbook/SECURITY_MODEL.md.</p>"},{"location":"#development","title":"Development","text":"<p>Requires: Docker, Node.js 24, PostgreSQL 16, Redis 7</p> <pre><code># Start services\nmake up\n\n# Seed demo data\nmake db-seed\n\n# Run tests\nmake test\n\n# Validate before push\nmake validate-ci\n</code></pre> <p>See handbook/DEVELOPMENT.md for complete workflow.</p>"},{"location":"#license","title":"License","text":"<p>Apache License 2.0 - See LICENSE</p>"},{"location":"#support","title":"Support","text":"<ul> <li>Documentation: https://seanmdalton.github.io/pulsestage/</li> <li>Issues: https://github.com/seanmdalton/pulsestage/issues</li> <li>Discussions: https://github.com/seanmdalton/pulsestage/discussions</li> <li>Changelog: CHANGELOG.md</li> </ul>"},{"location":"about/branding/","title":"PulseStage Branding (Quick Start)","text":"<p>Primary colors - Dark background: <code>#0B1221</code> - Accent (pulse): <code>#00B3A4</code> - Text (light): <code>#F9FAFB</code> - Text (dark): <code>#0B1221</code></p> <p>Files included - <code>pulsestage-wordmark-tight-light.svg</code> / <code>pulsestage-wordmark-tight-dark.svg</code> (recommended) - <code>pulsestage-wordmark-light.svg</code> / <code>pulsestage-wordmark-dark.svg</code> (standard) - <code>pulsestage-icon-dark.svg</code> / <code>pulsestage-icon-light.svg</code> - PNG icons: 512/256/128/64/32/16 - <code>favicon.ico</code></p> <p>Usage tips - Use the light logo/icon on dark backgrounds and dark logo/icon on light backgrounds. - The tight wordmark variants are recommended for UI integration (better spacing). - Prefer the SVGs on the web and for print. Use PNGs for favicons and app icons. - In the web app, set <code>favicon.ico</code> in <code>web/public/</code>. - Docker label suggestion: <code>org.opencontainers.image.title=\"PulseStage\"</code>.</p>"},{"location":"about/changelog/","title":"Changelog","text":"<p>Documentation coming soon...</p>"},{"location":"about/license/","title":"License","text":"<p>Documentation coming soon...</p>"},{"location":"deployment/environment/","title":"Environment Variables","text":"<p>This document provides a comprehensive reference for all environment variables used by PulseStage.</p>"},{"location":"deployment/environment/#quick-start","title":"Quick Start","text":"<p>Copy the example environment file and customize it for your deployment:</p> <pre><code>cp env.example .env\n</code></pre> <p>Then edit <code>.env</code> with your specific values.</p>"},{"location":"deployment/environment/#core-configuration","title":"Core Configuration","text":""},{"location":"deployment/environment/#database","title":"Database","text":"Variable Description Required Default Example <code>DATABASE_URL</code> PostgreSQL connection string [OK] Yes - <code>postgresql://user:pass@host:5432/dbname</code> <p>Format: <code>postgresql://[user]:[password]@[host]:[port]/[database]?schema=[schema]</code></p> <p>Production recommendations: - Use connection pooling (e.g., PgBouncer) - Enable SSL: Add <code>?sslmode=require</code> to the URL - Use a dedicated database user with minimal permissions - Separate read replicas for analytics queries (future)</p>"},{"location":"deployment/environment/#redis","title":"Redis","text":"Variable Description Required Default Example <code>REDIS_URL</code> Full Redis connection string [WARNING] One of <code>REDIS_URL</code> or <code>REDIS_HOST</code> - <code>redis://redis:6379</code> <code>REDIS_HOST</code> Redis hostname [WARNING] One of <code>REDIS_URL</code> or <code>REDIS_HOST</code> <code>localhost</code> <code>redis</code> <code>REDIS_PORT</code> Redis port No <code>6379</code> <code>6379</code> <code>REDIS_PASSWORD</code> Redis authentication password No - <code>your-redis-password</code> <p>Used for: - Session storage - Rate limiting - Email queue (BullMQ)</p> <p>Production recommendations: - Enable authentication (<code>requirepass</code> in redis.conf) - Use Redis 7+ for best performance - Consider Redis Cluster for high availability - Monitor memory usage (set <code>maxmemory</code> policy)</p>"},{"location":"deployment/environment/#api-server","title":"API Server","text":"Variable Description Required Default Example <code>PORT</code> API server port No <code>3000</code> <code>3000</code> <code>NODE_ENV</code> Environment mode No <code>development</code> <code>production</code> <code>CORS_ORIGIN</code> Allowed CORS origins (comma-separated) [OK] Yes <code>http://localhost:5173</code> <code>https://app.yourdomain.com,https://admin.yourdomain.com</code> <p><code>NODE_ENV</code> behavior: - <code>development</code>: Rate limiting disabled, verbose logging - <code>production</code>: Rate limiting enabled, error logging only</p> <p>CORS configuration: - Development: Use <code>http://localhost:5173</code> - Production: Use your actual frontend domain(s) - Multiple origins: Separate with commas (no spaces)</p>"},{"location":"deployment/environment/#admin-authentication","title":"Admin Authentication","text":"Variable Description Required Default Example <code>ADMIN_KEY</code> Admin API key for protected endpoints [OK] Yes - <code>your-secure-random-string-min-32-chars</code> <p>[WARNING] Security: - Generate a secure random string: <code>openssl rand -hex 32</code> - Never commit this to version control - Rotate periodically (every 90 days recommended) - Use your secrets manager in production (AWS Secrets Manager, HashiCorp Vault, etc.)</p> <p>Used for: - <code>/admin/*</code> endpoints - Health dashboard - Email queue status - System metrics</p>"},{"location":"deployment/environment/#multi-tenancy","title":"Multi-Tenancy","text":"Variable Description Required Default Example <code>MULTI_TENANT_MODE</code> Enable multi-tenant subdomain routing No <code>false</code> <code>true</code> or <code>false</code> <code>BASE_DOMAIN</code> Base domain for tenant resolution [WARNING] Required if <code>MULTI_TENANT_MODE=true</code> - <code>pulsestage.com</code> <code>TENANT_HEADER</code> Header name for tenant override No <code>x-tenant-id</code> <code>x-tenant-slug</code> <p>Single-tenant mode (<code>MULTI_TENANT_MODE=false</code>): - One organization per deployment - Simpler setup, perfect for most use cases - Default tenant automatically created on first startup</p> <p>Multi-tenant mode (<code>MULTI_TENANT_MODE=true</code>): - Multiple organizations on one deployment - Subdomain-based routing: <code>acme.pulsestage.com</code> \u2192 ACME tenant - Requires <code>BASE_DOMAIN</code> to be set - See Multi-Tenancy Architecture for details</p> <p>Tenant resolution order (when <code>MULTI_TENANT_MODE=true</code>): 1. <code>x-tenant-id</code> or <code>x-tenant-slug</code> header (if present) 2. Subdomain extraction from <code>Host</code> header 3. Falls back to default tenant</p>"},{"location":"deployment/environment/#email-configuration","title":"Email Configuration","text":"<p>See Email Configuration Guide for complete setup instructions.</p>"},{"location":"deployment/environment/#core-email-settings","title":"Core Email Settings","text":"Variable Description Required Default Example <code>EMAIL_PROVIDER</code> Email service to use [OK] Yes - <code>smtp</code> or <code>resend</code> <code>EMAIL_FROM</code> Sender email address [OK] Yes - <code>noreply@yourdomain.com</code> <code>EMAIL_FROM_NAME</code> Sender display name No <code>PulseStage</code> <code>Your Company AMA</code> <code>FRONTEND_URL</code> Frontend URL for email links [OK] Yes - <code>https://yourdomain.com</code>"},{"location":"deployment/environment/#smtp-configuration","title":"SMTP Configuration","text":"<p>Only required when <code>EMAIL_PROVIDER=smtp</code>.</p> Variable Description Required Default Example <code>SMTP_HOST</code> SMTP server hostname [OK] Yes - <code>smtp.sendgrid.net</code> <code>SMTP_PORT</code> SMTP server port [OK] Yes - <code>587</code> <code>SMTP_SECURE</code> Use TLS (true for 465, false for 587) [OK] Yes - <code>true</code> or <code>false</code> <code>SMTP_USER</code> SMTP username [WARNING] Usually required - <code>apikey</code> <code>SMTP_PASS</code> SMTP password [WARNING] Usually required - <code>SG.xxxxx</code> <p>Common SMTP providers: - SendGrid: <code>smtp.sendgrid.net:587</code>, user=<code>apikey</code>, pass=<code>SG.xxxxx</code> - AWS SES: <code>email-smtp.us-east-1.amazonaws.com:587</code>, SMTP credentials from IAM - Mailgun: <code>smtp.mailgun.org:587</code>, username/password from Mailgun - Gmail (dev only): <code>smtp.gmail.com:587</code>, use App Password</p>"},{"location":"deployment/environment/#resend-configuration","title":"Resend Configuration","text":"<p>Only required when <code>EMAIL_PROVIDER=resend</code>.</p> Variable Description Required Default Example <code>RESEND_API_KEY</code> Resend API key [OK] Yes - <code>re_xxxxxxxxxxxxx</code> <p>Setup: 1. Sign up at resend.com 2. Verify your sending domain 3. Generate API key (starts with <code>re_</code>)</p>"},{"location":"deployment/environment/#server-sent-events-sse","title":"Server-Sent Events (SSE)","text":"Variable Description Required Default Example <code>SSE_HEARTBEAT_INTERVAL</code> Heartbeat interval in milliseconds No <code>30000</code> (30s) <code>15000</code> <p>Purpose: Keep SSE connections alive through proxies/load balancers.</p> <p>Recommendations: - Default (30s) works for most deployments - Lower (15s) if connections drop frequently - Higher (60s) to reduce server load (if stable network)</p>"},{"location":"deployment/environment/#frontend-configuration","title":"Frontend Configuration","text":"Variable Description Required Default Example <code>WEBSITE_TITLE</code> Browser tab title No <code>PulseStage</code> <code>Your Company AMA</code> <p>Note: Frontend-specific variables are configured in <code>web/.env</code> (not shown here). See <code>web/README.md</code>.</p>"},{"location":"deployment/environment/#development-only-variables","title":"Development-Only Variables","text":"<p>These are used for local development and testing. Do not use in production.</p> Variable Description Default Example <code>MOCK_AUTH</code> Enable mock SSO authentication <code>false</code> <code>true</code> <code>LOG_LEVEL</code> Logging verbosity <code>info</code> <code>debug</code>"},{"location":"deployment/environment/#example-configurations","title":"Example Configurations","text":""},{"location":"deployment/environment/#local-development-docker-composeoverrideyaml","title":"Local Development (docker-compose.override.yaml)","text":"<pre><code>environment:\n  DATABASE_URL: postgresql://app:app@db:5432/ama\n  REDIS_URL: redis://redis:6379\n  CORS_ORIGIN: http://localhost:5173\n  NODE_ENV: development\n  ADMIN_KEY: dev-admin-key\n\n  # Email (Mailpit)\n  EMAIL_PROVIDER: smtp\n  SMTP_HOST: mailpit\n  SMTP_PORT: 1025\n  SMTP_SECURE: false\n  EMAIL_FROM: noreply@pulsestage.local\n  FRONTEND_URL: http://localhost:5173\n\n  # Single-tenant mode\n  MULTI_TENANT_MODE: false\n</code></pre>"},{"location":"deployment/environment/#production-awsdigitaloceanetc","title":"Production (AWS/DigitalOcean/etc.)","text":"<pre><code># Database\nDATABASE_URL=postgresql://pulsestage:SECURE_PASSWORD@db.internal:5432/pulsestage?sslmode=require\n\n# Redis\nREDIS_URL=redis://:SECURE_REDIS_PASSWORD@redis.internal:6379\n\n# API\nPORT=3000\nNODE_ENV=production\nCORS_ORIGIN=https://ama.yourcompany.com\nADMIN_KEY=&lt;generated-with-openssl-rand-hex-32&gt;\n\n# Email (Resend)\nEMAIL_PROVIDER=resend\nRESEND_API_KEY=re_xxxxxxxxxxxx\nEMAIL_FROM=noreply@yourcompany.com\nEMAIL_FROM_NAME=Company AMA\nFRONTEND_URL=https://ama.yourcompany.com\n\n# Single-tenant\nMULTI_TENANT_MODE=false\n</code></pre>"},{"location":"deployment/environment/#production-multi-tenant-saas","title":"Production Multi-Tenant (SaaS)","text":"<pre><code># Database\nDATABASE_URL=postgresql://pulsestage:SECURE_PASSWORD@db.internal:5432/pulsestage?sslmode=require\n\n# Redis\nREDIS_URL=redis://:SECURE_REDIS_PASSWORD@redis.internal:6379\n\n# API\nPORT=3000\nNODE_ENV=production\nCORS_ORIGIN=https://*.pulsestage.com\nADMIN_KEY=&lt;generated-with-openssl-rand-hex-32&gt;\n\n# Email (Resend)\nEMAIL_PROVIDER=resend\nRESEND_API_KEY=re_xxxxxxxxxxxx\nEMAIL_FROM=noreply@pulsestage.com\nEMAIL_FROM_NAME=PulseStage\nFRONTEND_URL=https://pulsestage.com\n\n# Multi-tenant\nMULTI_TENANT_MODE=true\nBASE_DOMAIN=pulsestage.com\n</code></pre>"},{"location":"deployment/environment/#security-best-practices","title":"Security Best Practices","text":""},{"location":"deployment/environment/#1-never-commit-secrets","title":"1. Never Commit Secrets","text":"<pre><code># [ERROR] Bad: Committed .env file\ngit add .env\ngit commit -m \"Add config\"\n\n# [OK] Good: .env is in .gitignore\ngit add env.example\ngit commit -m \"Add example config\"\n</code></pre>"},{"location":"deployment/environment/#2-use-secrets-management","title":"2. Use Secrets Management","text":"<p>Development: - Store in <code>.env</code> file (already ignored by git) - Share securely via 1Password, LastPass, etc.</p> <p>Production: - AWS: Secrets Manager, Systems Manager Parameter Store - Kubernetes: Secrets, External Secrets Operator - Docker Swarm: Docker Secrets - Ansible: Ansible Vault</p>"},{"location":"deployment/environment/#3-rotate-credentials-regularly","title":"3. Rotate Credentials Regularly","text":"Credential Rotation Frequency <code>ADMIN_KEY</code> Every 90 days Database password Every 180 days Redis password Every 180 days Email API keys Every 180 days or on compromise"},{"location":"deployment/environment/#4-principle-of-least-privilege","title":"4. Principle of Least Privilege","text":"<ul> <li>Database user: Only <code>SELECT</code>, <code>INSERT</code>, <code>UPDATE</code>, <code>DELETE</code> (no <code>DROP</code>, <code>ALTER</code>)</li> <li>Redis: Use ACLs if available (Redis 6+)</li> <li>Email API keys: Restricted to \"Mail Send\" permission only</li> </ul>"},{"location":"deployment/environment/#validation","title":"Validation","text":"<p>Check your configuration is correct:</p> <pre><code># Check API starts without errors\ndocker compose up -d api\ndocker compose logs api --tail 50\n\n# Verify database connection\ndocker compose exec api npx prisma db pull\n\n# Verify Redis connection\ndocker compose exec api node -e \"const Redis = require('ioredis'); const r = new Redis({host:'redis'}); r.ping().then(console.log)\"\n\n# Verify email configuration\ncurl http://localhost:3000/admin/email-queue \\\n  -H \"X-Admin-Key: your-admin-key\"\n</code></pre>"},{"location":"deployment/environment/#troubleshooting","title":"Troubleshooting","text":""},{"location":"deployment/environment/#api-wont-start","title":"API won't start","text":"<p>Check logs: <pre><code>docker compose logs api --tail 100\n</code></pre></p> <p>Common issues: - <code>DATABASE_URL</code> malformed \u2192 Check syntax - Can't connect to Redis \u2192 Verify <code>REDIS_URL</code> and Redis is running - <code>ADMIN_KEY</code> not set \u2192 Add to environment variables</p>"},{"location":"deployment/environment/#cors-errors-in-browser","title":"CORS errors in browser","text":"<p>Symptom: Console shows \"CORS policy: No 'Access-Control-Allow-Origin' header\"</p> <p>Fix: Ensure <code>CORS_ORIGIN</code> matches your frontend URL exactly.</p> <pre><code># Development\nCORS_ORIGIN=http://localhost:5173\n\n# Production\nCORS_ORIGIN=https://ama.yourcompany.com\n</code></pre>"},{"location":"deployment/environment/#emails-not-sending","title":"Emails not sending","text":"<p>See Email Configuration Guide.</p>"},{"location":"deployment/environment/#reference","title":"Reference","text":"<p>For more information: - Production Deployment Guide - Email Configuration - Multi-Tenancy Architecture - Security Overview</p>"},{"location":"deployment/monitoring/","title":"Monitoring","text":"<p>Monitor PulseStage in production to ensure reliability and performance.</p>"},{"location":"deployment/monitoring/#health-endpoints","title":"Health Endpoints","text":""},{"location":"deployment/monitoring/#api-health-check","title":"API Health Check","text":"<pre><code>curl https://api.yourdomain.com/health\n</code></pre> <p>Response: <pre><code>{\n  \"status\": \"ok\",\n  \"timestamp\": \"2025-10-15T12:00:00.000Z\",\n  \"uptime\": \"2d 4h 30m\",\n  \"database\": {\n    \"status\": \"connected\",\n    \"latency\": \"5ms\"\n  },\n  \"redis\": {\n    \"status\": \"connected\",\n    \"latency\": \"2ms\"\n  },\n  \"rateLimiting\": {\n    \"status\": \"active\",\n    \"requestsInLastHour\": 1234\n  },\n  \"auth\": {\n    \"mode\": \"production\",\n    \"strategies\": [\"github\", \"google\"]\n  }\n}\n</code></pre></p>"},{"location":"deployment/monitoring/#frontend-health","title":"Frontend Health","text":"<pre><code>curl -I https://yourdomain.com\n</code></pre> <p>Should return <code>200 OK</code>.</p>"},{"location":"deployment/monitoring/#application-metrics","title":"Application Metrics","text":""},{"location":"deployment/monitoring/#built-in-health-dashboard","title":"Built-in Health Dashboard","text":"<p>Visit <code>/admin/health</code> for real-time metrics:</p> <ul> <li>System Status: API, database, Redis connectivity</li> <li>Rate Limiting: Request counts and limits</li> <li>Auth Status: Enabled authentication modes</li> <li>Uptime: Service uptime</li> </ul> <p>Access: Requires admin role</p>"},{"location":"deployment/monitoring/#key-metrics-to-monitor","title":"Key Metrics to Monitor","text":"Metric Endpoint Target API Response Time <code>/health</code> &lt; 100ms Database Latency <code>/health</code> &lt; 10ms Redis Latency <code>/health</code> &lt; 5ms Error Rate Application logs &lt; 1% Uptime <code>/health</code> &gt; 99.9%"},{"location":"deployment/monitoring/#logging","title":"Logging","text":""},{"location":"deployment/monitoring/#application-logs","title":"Application Logs","text":"<p>Docker Compose: <pre><code>docker compose logs -f api\ndocker compose logs -f web\n</code></pre></p> <p>Production: <pre><code>journalctl -u pulsestage-api -f\njournalctl -u pulsestage-web -f\n</code></pre></p>"},{"location":"deployment/monitoring/#log-levels","title":"Log Levels","text":"<ul> <li>ERROR: Critical issues requiring immediate attention</li> <li>WARN: Potential problems</li> <li>INFO: General application flow</li> <li>DEBUG: Detailed debugging (development only)</li> </ul>"},{"location":"deployment/monitoring/#important-log-patterns","title":"Important Log Patterns","text":"<p>Session Issues: <pre><code>\ud83c\udf6a Session config: secure=true, sameSite=lax\n</code></pre></p> <p>Authentication: <pre><code>\ud83d\udd10 Auth modes enabled: github, google\n</code></pre></p> <p>Database: <pre><code>[OK] Database connected successfully\n[ERROR] Database connection failed\n</code></pre></p> <p>Redis: <pre><code> Redis connected for rate limiting\n[ERROR] Failed to connect to Redis\n</code></pre></p>"},{"location":"deployment/monitoring/#audit-logging","title":"Audit Logging","text":"<p>PulseStage logs all admin actions for compliance:</p> <ul> <li>User role changes</li> <li>Team member additions/removals</li> <li>Question moderation (pin, freeze, delete)</li> <li>Bulk operations</li> <li>Settings changes</li> </ul> <p>Access audit logs: <pre><code># Via Admin Panel\n/admin/audit\n\n# Via API\ncurl -H \"Authorization: Bearer $TOKEN\" \\\n  https://api.yourdomain.com/admin/audit?limit=100\n</code></pre></p>"},{"location":"deployment/monitoring/#alerting","title":"Alerting","text":""},{"location":"deployment/monitoring/#set-up-alerts","title":"Set Up Alerts","text":"<p>Monitor these conditions:</p> <ol> <li>API Health Check Fails</li> <li>Check: <code>curl https://api.yourdomain.com/health</code></li> <li> <p>Alert: Response code \u2260 200</p> </li> <li> <p>High Error Rate</p> </li> <li>Check: Application logs</li> <li> <p>Alert: Error count &gt; 10/minute</p> </li> <li> <p>Database Connection Lost</p> </li> <li>Check: <code>/health</code> endpoint</li> <li> <p>Alert: <code>database.status \u2260 \"connected\"</code></p> </li> <li> <p>Redis Connection Lost</p> </li> <li>Check: <code>/health</code> endpoint</li> <li> <p>Alert: <code>redis.status \u2260 \"connected\"</code></p> </li> <li> <p>High Response Time</p> </li> <li>Check: API response time</li> <li>Alert: Response time &gt; 1 second</li> </ol>"},{"location":"deployment/monitoring/#example-uptime-monitoring","title":"Example: Uptime Monitoring","text":"<p>Using Uptime Robot (free):</p> <ol> <li>Add HTTP(s) Monitor</li> <li>URL: <code>https://api.yourdomain.com/health</code></li> <li>Monitoring Interval: 5 minutes</li> <li>Alert Contacts: Email, SMS, Slack</li> </ol> <p>Using Healthchecks.io:</p> <pre><code># Add to crontab\n*/5 * * * * curl -fsS --retry 3 https://hc-ping.com/your-uuid-here &gt; /dev/null\n</code></pre>"},{"location":"deployment/monitoring/#performance-monitoring","title":"Performance Monitoring","text":""},{"location":"deployment/monitoring/#database-performance","title":"Database Performance","text":"<pre><code># Check slow queries\ndocker compose exec postgres psql -U postgres -d pulsestage -c \"\n  SELECT query, calls, mean_exec_time\n  FROM pg_stat_statements\n  ORDER BY mean_exec_time DESC\n  LIMIT 10;\n\"\n</code></pre>"},{"location":"deployment/monitoring/#redis-performance","title":"Redis Performance","text":"<pre><code># Check Redis stats\ndocker compose exec redis redis-cli INFO stats\n</code></pre>"},{"location":"deployment/monitoring/#api-performance","title":"API Performance","text":"<p>Monitor response times for key endpoints: - <code>GET /questions</code> - Should be &lt; 200ms - <code>GET /teams</code> - Should be &lt; 100ms - <code>POST /questions</code> - Should be &lt; 300ms - <code>GET /health</code> - Should be &lt; 50ms</p>"},{"location":"deployment/monitoring/#resource-usage","title":"Resource Usage","text":""},{"location":"deployment/monitoring/#docker-stats","title":"Docker Stats","text":"<pre><code>docker stats\n</code></pre> <p>Monitor: - CPU usage: Should be &lt; 80% - Memory usage: Should be &lt; 80% - Network I/O: Watch for anomalies</p>"},{"location":"deployment/monitoring/#disk-usage","title":"Disk Usage","text":"<pre><code># Check database size\ndocker compose exec postgres psql -U postgres -c \"\n  SELECT pg_database.datname,\n         pg_size_pretty(pg_database_size(pg_database.datname)) AS size\n  FROM pg_database;\n\"\n\n# Check disk space\ndf -h\n</code></pre>"},{"location":"deployment/monitoring/#backup-verification","title":"Backup Verification","text":"<p>Regularly verify backups work:</p> <pre><code># Test database backup\ndocker compose exec postgres pg_dump -U postgres pulsestage &gt; test-backup.sql\n\n# Test restore to separate database\ndocker compose exec postgres createdb -U postgres test_restore\ndocker compose exec -T postgres psql -U postgres test_restore &lt; test-backup.sql\n</code></pre>"},{"location":"deployment/monitoring/#security-monitoring","title":"Security Monitoring","text":""},{"location":"deployment/monitoring/#failed-login-attempts","title":"Failed Login Attempts","text":"<p>Monitor for brute force attacks:</p> <pre><code># Check logs for repeated failures\ndocker compose logs api | grep \"Authentication failed\"\n</code></pre>"},{"location":"deployment/monitoring/#unusual-activity","title":"Unusual Activity","text":"<p>Watch for: - Bulk operations outside business hours - Repeated 401/403 errors - Unusual rate limit hits</p>"},{"location":"deployment/monitoring/#rate-limiting","title":"Rate Limiting","text":"<pre><code># Check rate limit stats\ncurl https://api.yourdomain.com/health | jq '.rateLimiting'\n</code></pre>"},{"location":"deployment/monitoring/#troubleshooting","title":"Troubleshooting","text":""},{"location":"deployment/monitoring/#high-cpu-usage","title":"High CPU Usage","text":"<ol> <li>Check slow queries</li> <li>Review recent changes</li> <li>Check for infinite loops in logs</li> </ol>"},{"location":"deployment/monitoring/#high-memory-usage","title":"High Memory Usage","text":"<ol> <li>Check for memory leaks</li> <li>Review Redis memory usage</li> <li>Check database connections</li> </ol>"},{"location":"deployment/monitoring/#slow-response-times","title":"Slow Response Times","text":"<ol> <li>Check database performance</li> <li>Check Redis performance</li> <li>Review recent deployments</li> <li>Check resource utilization</li> </ol>"},{"location":"deployment/monitoring/#see-also","title":"See Also","text":"<ul> <li>Production Runbook - Operational procedures</li> <li>Troubleshooting Guide - Common issues</li> <li>Health Dashboard - Admin interface</li> </ul>"},{"location":"deployment/production/","title":"Production Deployment","text":"<p>Deploy PulseStage to production using Docker Compose.</p>"},{"location":"deployment/production/#prerequisites","title":"Prerequisites","text":"<ul> <li>Linux server (Ubuntu 22.04+ recommended)</li> <li>Docker and Docker Compose</li> <li>Domain name with SSL certificate</li> <li>PostgreSQL 16 (managed or self-hosted)</li> <li>Redis 7 (managed or self-hosted)</li> </ul>"},{"location":"deployment/production/#quick-deploy","title":"Quick Deploy","text":"<pre><code># Clone repository\ngit clone https://github.com/seanmdalton/pulsestage.git\ncd pulsestage\n\n# Generate secrets\n./setup.sh\n\n# Configure for production\ncp .env.example .env\nnano .env\n\n# Start services\ndocker compose up -d\n</code></pre>"},{"location":"deployment/production/#environment-configuration","title":"Environment Configuration","text":""},{"location":"deployment/production/#required-settings","title":"Required Settings","text":"<pre><code># Server\nNODE_ENV=production\nPORT=3000\n\n# Database (use managed PostgreSQL recommended)\nDATABASE_URL=postgresql://user:password@host:5432/database\n\n# Redis (use managed Redis recommended)\nREDIS_URL=redis://host:6379\n\n# Sessions (generate with: openssl rand -hex 32)\nSESSION_SECRET=your_generated_secret\nADMIN_SESSION_SECRET=your_generated_secret\n\n# CSRF (generate with: openssl rand -base64 32)\nCSRF_SECRET=your_generated_secret\n\n# Frontend\nCORS_ORIGIN=https://yourdomain.com\n</code></pre>"},{"location":"deployment/production/#authentication","title":"Authentication","text":"<p>Disable demo mode and configure OAuth:</p> <pre><code>AUTH_MODE_DEMO=false\n\n# GitHub OAuth (recommended)\nGITHUB_CLIENT_ID=your_github_client_id\nGITHUB_CLIENT_SECRET=your_github_client_secret\nGITHUB_CALLBACK_URL=https://yourdomain.com/auth/github/callback\n\n# Optional: Google OAuth\nGOOGLE_CLIENT_ID=your_google_client_id\nGOOGLE_CLIENT_SECRET=your_google_client_secret\nGOOGLE_CALLBACK_URL=https://yourdomain.com/auth/google/callback\n</code></pre> <p>See GitHub OAuth Setup and Google OAuth Setup.</p>"},{"location":"deployment/production/#email","title":"Email","text":"<p>Required for pulse invitations:</p> <pre><code># Using Resend (recommended)\nEMAIL_PROVIDER=resend\nRESEND_API_KEY=your_resend_api_key\nRESEND_FROM=noreply@yourdomain.com\n\n# Or SMTP\nEMAIL_PROVIDER=smtp\nSMTP_HOST=smtp.example.com\nSMTP_PORT=587\nSMTP_USER=your_user\nSMTP_PASS=your_password\nSMTP_FROM=noreply@yourdomain.com\n</code></pre>"},{"location":"deployment/production/#content-moderation-optional","title":"Content Moderation (Optional)","text":"<pre><code>OPENAI_API_KEY=your_openai_api_key\nOPENAI_MODERATION_ENABLED=true\n</code></pre> <p>See handbook/TRUST_AND_SAFETY.md.</p>"},{"location":"deployment/production/#docker-compose","title":"Docker Compose","text":""},{"location":"deployment/production/#pin-versions","title":"Pin Versions","text":"<p>Production should use specific versions, not <code>latest</code>:</p> <pre><code>services:\n  api:\n    image: ghcr.io/seanmdalton/pulsestage-api:0.1.0\n  web:\n    image: ghcr.io/seanmdalton/pulsestage-web:0.1.0\n</code></pre> <p>Available tags: - <code>0.1.0</code> (exact version) - <code>0.1</code> (minor version) - <code>0</code> (major version) - <code>latest</code> (always newest)</p> <p>See CHANGELOG.md for versions.</p>"},{"location":"deployment/production/#resource-limits","title":"Resource Limits","text":"<pre><code>services:\n  api:\n    deploy:\n      resources:\n        limits:\n          cpus: '1.0'\n          memory: 1G\n        reservations:\n          cpus: '0.5'\n          memory: 512M\n</code></pre>"},{"location":"deployment/production/#reverse-proxy","title":"Reverse Proxy","text":""},{"location":"deployment/production/#nginx-configuration","title":"Nginx Configuration","text":"<pre><code>server {\n    listen 443 ssl http2;\n    server_name yourdomain.com;\n\n    ssl_certificate /path/to/cert.pem;\n    ssl_certificate_key /path/to/key.pem;\n\n    # Frontend\n    location / {\n        proxy_pass http://localhost:5173;\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n    }\n\n    # API\n    location /api/ {\n        proxy_pass http://localhost:3000/;\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n    }\n\n    # SSE (Server-Sent Events)\n    location /events {\n        proxy_pass http://localhost:3000/events;\n        proxy_set_header Connection '';\n        proxy_http_version 1.1;\n        chunked_transfer_encoding off;\n        proxy_buffering off;\n        proxy_cache off;\n    }\n}\n\n# HTTP redirect to HTTPS\nserver {\n    listen 80;\n    server_name yourdomain.com;\n    return 301 https://$server_name$request_uri;\n}\n</code></pre>"},{"location":"deployment/production/#traefik-configuration","title":"Traefik Configuration","text":"<pre><code>services:\n  traefik:\n    image: traefik:v2.10\n    command:\n      - \"--providers.docker=true\"\n      - \"--entrypoints.web.address=:80\"\n      - \"--entrypoints.websecure.address=:443\"\n      - \"--certificatesresolvers.letsencrypt.acme.email=your@email.com\"\n      - \"--certificatesresolvers.letsencrypt.acme.storage=/letsencrypt/acme.json\"\n      - \"--certificatesresolvers.letsencrypt.acme.httpchallenge.entrypoint=web\"\n    ports:\n      - \"80:80\"\n      - \"443:443\"\n    volumes:\n      - \"/var/run/docker.sock:/var/run/docker.sock:ro\"\n      - \"./letsencrypt:/letsencrypt\"\n\n  api:\n    labels:\n      - \"traefik.enable=true\"\n      - \"traefik.http.routers.api.rule=Host(`yourdomain.com`) &amp;&amp; PathPrefix(`/api`)\"\n      - \"traefik.http.routers.api.entrypoints=websecure\"\n      - \"traefik.http.routers.api.tls.certresolver=letsencrypt\"\n\n  web:\n    labels:\n      - \"traefik.enable=true\"\n      - \"traefik.http.routers.web.rule=Host(`yourdomain.com`)\"\n      - \"traefik.http.routers.web.entrypoints=websecure\"\n      - \"traefik.http.routers.web.tls.certresolver=letsencrypt\"\n</code></pre>"},{"location":"deployment/production/#database","title":"Database","text":""},{"location":"deployment/production/#using-managed-postgresql","title":"Using Managed PostgreSQL","text":"<p>Recommended providers: - AWS RDS PostgreSQL - Google Cloud SQL for PostgreSQL - Azure Database for PostgreSQL - Supabase - Neon - DigitalOcean Managed Databases</p> <p>Minimum requirements: - PostgreSQL 16+ - 2GB RAM - 20GB storage</p>"},{"location":"deployment/production/#self-hosted-postgresql","title":"Self-Hosted PostgreSQL","text":"<p>If self-hosting, use PostgreSQL Docker service from <code>docker-compose.yaml</code>.</p> <p>Important: Configure backups.</p>"},{"location":"deployment/production/#backups","title":"Backups","text":""},{"location":"deployment/production/#postgresql-backups","title":"PostgreSQL Backups","text":"<pre><code># Daily backup script\npg_dump $DATABASE_URL &gt; backup-$(date +%Y%m%d).sql\n\n# Restore from backup\npsql $DATABASE_URL &lt; backup-20250101.sql\n</code></pre>"},{"location":"deployment/production/#automated-backups","title":"Automated Backups","text":"<p>Add to crontab:</p> <pre><code>0 2 * * * /path/to/backup-script.sh\n</code></pre>"},{"location":"deployment/production/#backup-retention","title":"Backup Retention","text":"<p>Recommended: - Daily backups: Keep 7 days - Weekly backups: Keep 4 weeks - Monthly backups: Keep 12 months</p>"},{"location":"deployment/production/#monitoring","title":"Monitoring","text":""},{"location":"deployment/production/#health-checks","title":"Health Checks","text":"<p>Configure monitoring for these endpoints:</p> <ul> <li>Liveness: <code>https://yourdomain.com/health/live</code></li> <li>Readiness: <code>https://yourdomain.com/health/ready</code></li> <li>Full health: <code>https://yourdomain.com/health</code></li> </ul> <p>Expected response (healthy): <pre><code>{\n  \"status\": \"ok\",\n  \"timestamp\": \"2025-01-01T00:00:00.000Z\",\n  \"uptime\": 123456,\n  \"database\": \"ok\",\n  \"redis\": \"ok\"\n}\n</code></pre></p> <p>See Monitoring for detailed monitoring setup.</p>"},{"location":"deployment/production/#updates","title":"Updates","text":""},{"location":"deployment/production/#update-to-new-version","title":"Update to New Version","text":"<ol> <li> <p>Check changelog: CHANGELOG.md</p> </li> <li> <p>Pull new images: <pre><code>docker compose pull\n</code></pre></p> </li> <li> <p>Run migrations: <pre><code>docker compose exec api npx prisma migrate deploy\n</code></pre></p> </li> <li> <p>Restart services: <pre><code>docker compose up -d\n</code></pre></p> </li> <li> <p>Verify health: <pre><code>curl https://yourdomain.com/health\n</code></pre></p> </li> </ol>"},{"location":"deployment/production/#rollback","title":"Rollback","text":"<pre><code># Edit docker-compose.yaml to previous version\ndocker compose up -d\n</code></pre>"},{"location":"deployment/production/#security","title":"Security","text":""},{"location":"deployment/production/#environment-variables","title":"Environment Variables","text":"<ul> <li>Store in <code>.env</code> files (never commit to git)</li> <li>Use strong, randomly generated secrets</li> <li>Rotate secrets periodically</li> </ul>"},{"location":"deployment/production/#ssltls","title":"SSL/TLS","text":"<ul> <li>Use Let's Encrypt or commercial certificate</li> <li>Force HTTPS (redirect HTTP to HTTPS)</li> <li>Enable HSTS header</li> </ul>"},{"location":"deployment/production/#rate-limiting","title":"Rate Limiting","text":"<p>Rate limiting is enabled by default in production:</p> <pre><code>RATE_LIMIT_ENABLED=true\n</code></pre> <p>See handbook/SECURITY_MODEL.md.</p>"},{"location":"deployment/production/#audit-logging","title":"Audit Logging","text":"<p>Audit logs track all admin/moderator actions:</p> <ul> <li>View in Admin \u2192 Audit Logs</li> <li>Stored in database (append-only)</li> <li>Includes actor, action, entity, timestamp</li> </ul> <p>See handbook/SECURITY_MODEL.md.</p>"},{"location":"deployment/production/#scaling","title":"Scaling","text":""},{"location":"deployment/production/#horizontal-scaling","title":"Horizontal Scaling","text":"<p>Run multiple API instances behind load balancer:</p> <pre><code>services:\n  api:\n    deploy:\n      replicas: 3\n</code></pre> <p>Requires: - Shared PostgreSQL - Shared Redis (for sessions) - Load balancer (Nginx, Traefik, or cloud LB)</p>"},{"location":"deployment/production/#vertical-scaling","title":"Vertical Scaling","text":"<p>Increase resources in <code>docker-compose.yaml</code>:</p> <pre><code>services:\n  api:\n    deploy:\n      resources:\n        limits:\n          cpus: '2.0'\n          memory: 2G\n</code></pre>"},{"location":"deployment/production/#troubleshooting","title":"Troubleshooting","text":""},{"location":"deployment/production/#services-wont-start","title":"Services Won't Start","text":"<pre><code># View logs\ndocker compose logs -f\n\n# Check service status\ndocker compose ps\n</code></pre>"},{"location":"deployment/production/#database-connection-issues","title":"Database Connection Issues","text":"<pre><code># Test connection\ndocker compose exec api npx prisma db push --preview-feature\n\n# Verify DATABASE_URL\necho $DATABASE_URL\n</code></pre>"},{"location":"deployment/production/#redis-connection-issues","title":"Redis Connection Issues","text":"<pre><code># Test Redis\nredis-cli -u $REDIS_URL ping\n</code></pre>"},{"location":"deployment/production/#support","title":"Support","text":"<ul> <li>Monitoring Guide - Set up monitoring</li> <li>Environment Variables - All configuration options</li> <li>handbook/OPERATIONS.md - Operations runbook</li> <li>GitHub Issues - Report issues</li> </ul>"},{"location":"getting-started/configuration/","title":"Configuration","text":"<p>PulseStage is configured via environment variables.</p>"},{"location":"getting-started/configuration/#core-settings","title":"Core Settings","text":""},{"location":"getting-started/configuration/#required","title":"Required","text":"<pre><code># Database\nDATABASE_URL=postgresql://user:password@host:5432/database\n\n# Sessions (generate with: openssl rand -hex 32)\nSESSION_SECRET=your_session_secret\nADMIN_SESSION_SECRET=your_admin_session_secret\n\n# CSRF Protection (generate with: openssl rand -base64 32)\nCSRF_SECRET=your_csrf_secret\n\n# Redis\nREDIS_URL=redis://localhost:6379\n</code></pre>"},{"location":"getting-started/configuration/#optional","title":"Optional","text":"<pre><code># Server\nPORT=3000\nNODE_ENV=development  # or production\n\n# Frontend\nCORS_ORIGIN=http://localhost:5173\n\n# Tenant (multi-tenancy)\nDEFAULT_TENANT=default\n</code></pre>"},{"location":"getting-started/configuration/#authentication","title":"Authentication","text":""},{"location":"getting-started/configuration/#demo-mode-development","title":"Demo Mode (Development)","text":"<pre><code>AUTH_MODE_DEMO=true  # Auto-enabled when NODE_ENV=development\n</code></pre> <p>Provides 4 pre-seeded demo users. Not for production.</p>"},{"location":"getting-started/configuration/#oauth-production","title":"OAuth (Production)","text":""},{"location":"getting-started/configuration/#github-oauth","title":"GitHub OAuth","text":"<pre><code>GITHUB_CLIENT_ID=your_github_client_id\nGITHUB_CLIENT_SECRET=your_github_client_secret\nGITHUB_CALLBACK_URL=http://localhost:3000/auth/github/callback\n</code></pre>"},{"location":"getting-started/configuration/#google-oauth","title":"Google OAuth","text":"<pre><code>GOOGLE_CLIENT_ID=your_google_client_id\nGOOGLE_CLIENT_SECRET=your_google_client_secret\nGOOGLE_CALLBACK_URL=http://localhost:3000/auth/google/callback\n</code></pre> <p>See handbook/AUTHENTICATION.md for OAuth setup.</p>"},{"location":"getting-started/configuration/#email","title":"Email","text":""},{"location":"getting-started/configuration/#smtp","title":"SMTP","text":"<pre><code>EMAIL_PROVIDER=smtp\nSMTP_HOST=smtp.example.com\nSMTP_PORT=587\nSMTP_USER=your_smtp_user\nSMTP_PASS=your_smtp_password\nSMTP_FROM=noreply@example.com\n</code></pre>"},{"location":"getting-started/configuration/#resend","title":"Resend","text":"<pre><code>EMAIL_PROVIDER=resend\nRESEND_API_KEY=your_resend_api_key\nRESEND_FROM=noreply@example.com\n</code></pre>"},{"location":"getting-started/configuration/#disable-email-development","title":"Disable Email (Development)","text":"<pre><code>EMAIL_ENABLED=false\n</code></pre> <p>See handbook/INTEGRATIONS/EMAIL.md.</p>"},{"location":"getting-started/configuration/#content-moderation","title":"Content Moderation","text":""},{"location":"getting-started/configuration/#openai-moderation-optional","title":"OpenAI Moderation (Optional)","text":"<pre><code>OPENAI_API_KEY=your_openai_api_key\nOPENAI_MODERATION_ENABLED=true\n</code></pre> <p>Enables AI-powered content moderation alongside local filters.</p> <p>See handbook/TRUST_AND_SAFETY.md.</p>"},{"location":"getting-started/configuration/#pulse-system","title":"Pulse System","text":"<pre><code># Pulse invitations (requires email)\nPULSE_INVITES_ENABLED=true\n\n# Cohort size (users per cohort)\nPULSE_COHORT_SIZE=20\n\n# Invitation schedule (cron format: daily at 9 AM)\nPULSE_INVITE_CRON=0 9 * * *\n</code></pre> <p>See handbook/PULSE_SYSTEM.md.</p>"},{"location":"getting-started/configuration/#rate-limiting","title":"Rate Limiting","text":"<pre><code># Enable/disable rate limiting\nRATE_LIMIT_ENABLED=true  # Auto-disabled when NODE_ENV=development\n\n# Redis required for rate limiting\nREDIS_URL=redis://localhost:6379\n</code></pre> <p>Rate limiting is disabled in development by default.</p> <p>See handbook/SECURITY_MODEL.md.</p>"},{"location":"getting-started/configuration/#feature-flags","title":"Feature Flags","text":"<pre><code># Presentation mode\nPRESENTATION_MODE_ENABLED=true\n\n# Data exports\nEXPORTS_ENABLED=true\n\n# Audit logging\nAUDIT_LOG_ENABLED=true\n</code></pre>"},{"location":"getting-started/configuration/#branding","title":"Branding","text":"<pre><code># Website title\nWEBSITE_TITLE=PulseStage\n\n# Welcome message (markdown supported)\nWELCOME_MESSAGE=Welcome to PulseStage!\n\n# Logo URL (optional)\nLOGO_URL=https://example.com/logo.png\n</code></pre>"},{"location":"getting-started/configuration/#development","title":"Development","text":"<pre><code># Mock SSO for testing\nMOCK_SSO=true\nSSO_PROVIDER=mock\n\n# Mailpit (local email testing)\nSMTP_HOST=mailpit\nSMTP_PORT=1025\n</code></pre>"},{"location":"getting-started/configuration/#environment-files","title":"Environment Files","text":"<ul> <li><code>.env</code> - API configuration</li> <li><code>web/.env</code> - Frontend configuration</li> </ul> <p>Example <code>.env</code>: <pre><code>DATABASE_URL=postgresql://app:app@localhost:5432/ama\nSESSION_SECRET=generated_by_setup_script\nADMIN_SESSION_SECRET=generated_by_setup_script\nCSRF_SECRET=generated_by_setup_script\nREDIS_URL=redis://localhost:6379\nNODE_ENV=development\n</code></pre></p> <p>Example <code>web/.env</code>: <pre><code>VITE_API_URL=http://localhost:3000\nVITE_WEBSITE_TITLE=PulseStage\n</code></pre></p>"},{"location":"getting-started/configuration/#generate-secrets","title":"Generate Secrets","text":"<pre><code># Session secrets\nopenssl rand -hex 32\n\n# CSRF secret\nopenssl rand -base64 32\n</code></pre> <p>Or use <code>./setup.sh</code> which auto-generates all secrets.</p>"},{"location":"getting-started/configuration/#next-steps","title":"Next Steps","text":"<ul> <li>First Steps - Initial setup</li> <li>Production Deployment - Production configuration</li> <li>handbook/OPERATIONS.md - Operational details</li> </ul>"},{"location":"getting-started/first-steps/","title":"First Steps","text":"<p>Set up PulseStage for your organization.</p>"},{"location":"getting-started/first-steps/#1-configure-authentication","title":"1. Configure Authentication","text":""},{"location":"getting-started/first-steps/#for-production","title":"For Production","text":"<p>Disable demo mode and configure OAuth:</p> <pre><code># .env\nNODE_ENV=production\nAUTH_MODE_DEMO=false\n\n# GitHub OAuth (recommended)\nGITHUB_CLIENT_ID=your_github_client_id\nGITHUB_CLIENT_SECRET=your_github_client_secret\nGITHUB_CALLBACK_URL=https://your-domain.com/auth/github/callback\n\n# Optional: Google OAuth\nGOOGLE_CLIENT_ID=your_google_client_id\nGOOGLE_CLIENT_SECRET=your_google_client_secret\nGOOGLE_CALLBACK_URL=https://your-domain.com/auth/google/callback\n</code></pre> <p>See handbook/AUTHENTICATION.md for OAuth setup instructions.</p>"},{"location":"getting-started/first-steps/#2-create-teams","title":"2. Create Teams","text":"<ol> <li>Log in as admin</li> <li>Navigate to Admin \u2192 Teams</li> <li>Click \"Create Team\"</li> <li>Enter team details:</li> <li>Name (e.g., \"Engineering\")</li> <li>Slug (e.g., \"engineering\")</li> <li>Description (optional)</li> </ol> <p>Recommended teams: - Engineering - Product - Marketing - Sales - General</p>"},{"location":"getting-started/first-steps/#3-invite-users","title":"3. Invite Users","text":"<p>Users are automatically created on first OAuth login.</p>"},{"location":"getting-started/first-steps/#assign-team-memberships","title":"Assign Team Memberships","text":"<ol> <li>Admin \u2192 Teams \u2192 [Team Name]</li> <li>Click \"Manage Members\"</li> <li>Add users and assign roles:</li> <li>Viewer - Browse and upvote</li> <li>Member - Submit questions and upvote</li> <li>Moderator - Answer and moderate questions</li> <li>Admin - Full access (all teams)</li> <li>Owner - Complete control</li> </ol>"},{"location":"getting-started/first-steps/#set-primary-teams","title":"Set Primary Teams","text":"<p>Each user needs a primary team:</p> <ol> <li>Admin \u2192 Users \u2192 [User Name]</li> <li>Select \"Primary Team\"</li> <li>Save</li> </ol> <p>Primary team determines: - Default team view on login - Pulse invitation cohort - Team-scoped notifications</p>"},{"location":"getting-started/first-steps/#4-configure-email-optional","title":"4. Configure Email (Optional)","text":"<p>Required for pulse invitations and notifications.</p>"},{"location":"getting-started/first-steps/#using-resend-recommended","title":"Using Resend (Recommended)","text":"<pre><code># .env\nEMAIL_PROVIDER=resend\nRESEND_API_KEY=your_resend_api_key\nRESEND_FROM=noreply@yourdomain.com\n</code></pre>"},{"location":"getting-started/first-steps/#using-smtp","title":"Using SMTP","text":"<pre><code># .env\nEMAIL_PROVIDER=smtp\nSMTP_HOST=smtp.example.com\nSMTP_PORT=587\nSMTP_USER=your_smtp_user\nSMTP_PASS=your_smtp_password\nSMTP_FROM=noreply@yourdomain.com\n</code></pre> <p>See handbook/INTEGRATIONS/EMAIL.md.</p>"},{"location":"getting-started/first-steps/#5-enable-pulse-invitations-optional","title":"5. Enable Pulse Invitations (Optional)","text":"<p>Weekly sentiment surveys with email invitations.</p> <pre><code># .env\nPULSE_INVITES_ENABLED=true\nPULSE_COHORT_SIZE=20\nPULSE_INVITE_CRON=0 9 * * *  # Daily at 9 AM\n</code></pre> <p>Requires email configuration.</p> <p>See handbook/PULSE_SYSTEM.md.</p>"},{"location":"getting-started/first-steps/#6-customize-branding-optional","title":"6. Customize Branding (Optional)","text":"<pre><code># .env\nWEBSITE_TITLE=Your Company Q&amp;A\nWELCOME_MESSAGE=Welcome to our employee engagement platform!\n\n# web/.env\nVITE_WEBSITE_TITLE=Your Company Q&amp;A\n</code></pre>"},{"location":"getting-started/first-steps/#7-set-up-monitoring","title":"7. Set Up Monitoring","text":""},{"location":"getting-started/first-steps/#health-checks","title":"Health Checks","text":"<ul> <li>Liveness: <code>http://your-domain.com/health/live</code></li> <li>Readiness: <code>http://your-domain.com/health/ready</code></li> <li>Full health: <code>http://your-domain.com/health</code></li> </ul>"},{"location":"getting-started/first-steps/#audit-logs","title":"Audit Logs","text":"<p>View all admin/moderator actions:</p> <ol> <li>Admin \u2192 Audit Logs</li> <li>Filter by:</li> <li>Actor (who performed action)</li> <li>Action (what was done)</li> <li>Entity (what was affected)</li> <li>Date range</li> </ol>"},{"location":"getting-started/first-steps/#common-tasks","title":"Common Tasks","text":""},{"location":"getting-started/first-steps/#reset-demo-data","title":"Reset Demo Data","text":"<pre><code>make db-seed\n</code></pre>"},{"location":"getting-started/first-steps/#view-email-queue","title":"View Email Queue","text":"<p>Admin \u2192 Email Queue</p> <p>Shows all pending and sent emails.</p>"},{"location":"getting-started/first-steps/#export-data","title":"Export Data","text":"<p>Admin \u2192 Export</p> <p>Export questions, pulse responses, or audit logs as CSV/JSON.</p>"},{"location":"getting-started/first-steps/#manage-tags","title":"Manage Tags","text":"<p>Admin \u2192 Tags</p> <p>Create, edit, or delete question tags.</p>"},{"location":"getting-started/first-steps/#next-steps","title":"Next Steps","text":"<ul> <li>User Guide - User features</li> <li>Moderator Guide - Moderation workflow</li> <li>Admin Guide - Administration</li> <li>Production Deployment - Production setup</li> </ul>"},{"location":"getting-started/installation/","title":"Installation","text":"<p>Install PulseStage using Docker Compose.</p>"},{"location":"getting-started/installation/#prerequisites","title":"Prerequisites","text":"<ul> <li>Docker and Docker Compose</li> <li>Git</li> </ul>"},{"location":"getting-started/installation/#installation_1","title":"Installation","text":"<ol> <li> <p>Clone repository: <pre><code>git clone https://github.com/seanmdalton/pulsestage.git\ncd pulsestage\n</code></pre></p> </li> <li> <p>Run setup script: <pre><code>./setup.sh\n</code></pre></p> </li> </ol> <p>This creates <code>.env</code> files with generated secrets for: - <code>SESSION_SECRET</code> - <code>ADMIN_SESSION_SECRET</code> - <code>CSRF_SECRET</code></p> <ol> <li>Start services: <pre><code>docker compose up -d\n</code></pre></li> </ol> <p>Services start: - API: <code>http://localhost:3000</code> - Frontend: <code>http://localhost:5173</code> - PostgreSQL: <code>localhost:5432</code> - Redis: <code>localhost:6379</code> - Mailpit: <code>http://localhost:8025</code> (email testing)</p> <ol> <li>Verify installation: <pre><code>curl http://localhost:3000/health\n</code></pre></li> </ol> <p>Expected: <code>{\"status\":\"ok\"}</code></p>"},{"location":"getting-started/installation/#demo-mode","title":"Demo Mode","text":"<p>Default configuration uses demo mode with 4 pre-seeded users: - admin@pulsestage.app - alice@pulsestage.app - bob@pulsestage.app - moderator@pulsestage.app</p> <p>Visit <code>http://localhost:5173</code> and click any demo user to log in.</p>"},{"location":"getting-started/installation/#production-setup","title":"Production Setup","text":"<p>For production deployment:</p> <ol> <li> <p>Disable demo mode (<code>.env</code>): <pre><code>NODE_ENV=production\nAUTH_MODE_DEMO=false\n</code></pre></p> </li> <li> <p>Configure OAuth (required when demo mode disabled): <pre><code>GITHUB_CLIENT_ID=your_github_client_id\nGITHUB_CLIENT_SECRET=your_github_client_secret\n</code></pre></p> </li> </ol> <p>See Configuration for all environment variables.</p> <p>See Production Deployment for complete production setup.</p>"},{"location":"getting-started/installation/#next-steps","title":"Next Steps","text":"<ul> <li>Configuration - Environment variables</li> <li>First Steps - Create teams and invite users</li> <li>Troubleshooting - Common issues</li> </ul>"},{"location":"getting-started/quick-start/","title":"Quick Start","text":"<p>Get PulseStage running in 5 minutes.</p>"},{"location":"getting-started/quick-start/#install","title":"Install","text":"<pre><code>git clone https://github.com/seanmdalton/pulsestage.git\ncd pulsestage\n./setup.sh\ndocker compose up -d\n</code></pre>"},{"location":"getting-started/quick-start/#access","title":"Access","text":"<p>Visit <code>http://localhost:5173</code></p>"},{"location":"getting-started/quick-start/#log-in","title":"Log In","text":"<p>Click any demo user: - admin - Full access - alice - Member (Engineering team) - bob - Member (Product team) - moderator - Moderator (Product team)</p>"},{"location":"getting-started/quick-start/#try-it-out","title":"Try It Out","text":""},{"location":"getting-started/quick-start/#as-a-user-alice-or-bob","title":"As a User (alice or bob)","text":"<ol> <li>Navigate to your team (Engineering or Product)</li> <li>Click \"Submit Question\"</li> <li>Enter a question (anonymous by default)</li> <li>Upvote other questions</li> </ol>"},{"location":"getting-started/quick-start/#as-a-moderator-moderator","title":"As a Moderator (moderator)","text":"<ol> <li>Navigate to Product team</li> <li>Click \"Moderation Queue\"</li> <li>Answer questions</li> <li>Tag, pin, or freeze questions</li> </ol>"},{"location":"getting-started/quick-start/#as-an-admin-admin","title":"As an Admin (admin)","text":"<ol> <li>Click \"Admin\" in navigation</li> <li>View audit logs</li> <li>Manage teams and users</li> <li>Monitor email queue</li> </ol>"},{"location":"getting-started/quick-start/#whats-included","title":"What's Included","text":"<p>Demo data includes: - 50 users (4 login + 46 dummy users) - 2 teams (Engineering, Product) - 36 Q&amp;A questions (10 open + 10 answered per team) - 12 weeks of pulse historical data - 800+ pulse responses</p>"},{"location":"getting-started/quick-start/#stop-services","title":"Stop Services","text":"<pre><code>docker compose down\n</code></pre>"},{"location":"getting-started/quick-start/#reset-data","title":"Reset Data","text":"<pre><code>make db-seed\n</code></pre>"},{"location":"getting-started/quick-start/#next-steps","title":"Next Steps","text":"<ul> <li>Configuration - Customize settings</li> <li>First Steps - Set up for your organization</li> <li>User Guide - Learn features</li> </ul>"},{"location":"getting-started/troubleshooting/","title":"Troubleshooting","text":"<p>Common issues and solutions.</p>"},{"location":"getting-started/troubleshooting/#services-not-starting","title":"Services Not Starting","text":""},{"location":"getting-started/troubleshooting/#check-docker-services","title":"Check Docker Services","text":"<pre><code>docker compose ps\n</code></pre> <p>All services should show \"Up\": - api - web - db (PostgreSQL) - redis - mailpit</p>"},{"location":"getting-started/troubleshooting/#restart-services","title":"Restart Services","text":"<pre><code>docker compose down\ndocker compose up -d\n</code></pre>"},{"location":"getting-started/troubleshooting/#view-logs","title":"View Logs","text":"<pre><code># All services\ndocker compose logs -f\n\n# Specific service\ndocker compose logs -f api\ndocker compose logs -f web\n</code></pre>"},{"location":"getting-started/troubleshooting/#cannot-log-in","title":"Cannot Log In","text":""},{"location":"getting-started/troubleshooting/#demo-mode-not-working","title":"Demo Mode Not Working","text":"<ol> <li>Verify demo mode enabled: <pre><code># Check .env\ngrep AUTH_MODE_DEMO .env\n</code></pre></li> </ol> <p>Should show: <code>AUTH_MODE_DEMO=true</code> (or empty in development)</p> <ol> <li> <p>Check API logs: <pre><code>docker compose logs -f api | grep -i auth\n</code></pre></p> </li> <li> <p>Verify database seeded: <pre><code>docker compose exec db psql -U app -d ama -c \"SELECT email FROM \\\"User\\\" WHERE email LIKE '%@pulsestage.app';\"\n</code></pre></p> </li> </ol> <p>Should show 4 demo users.</p>"},{"location":"getting-started/troubleshooting/#oauth-not-working","title":"OAuth Not Working","text":"<ol> <li> <p>Verify OAuth configuration in <code>.env</code>: <pre><code>GITHUB_CLIENT_ID=your_client_id\nGITHUB_CLIENT_SECRET=your_secret\nGITHUB_CALLBACK_URL=http://localhost:3000/auth/github/callback\n</code></pre></p> </li> <li> <p>Check OAuth callback URL matches GitHub/Google OAuth app settings</p> </li> <li> <p>Verify environment is production: <pre><code>NODE_ENV=production\nAUTH_MODE_DEMO=false\n</code></pre></p> </li> </ol>"},{"location":"getting-started/troubleshooting/#no-data-empty-dashboard","title":"No Data / Empty Dashboard","text":""},{"location":"getting-started/troubleshooting/#reseed-database","title":"Reseed Database","text":"<pre><code>make db-seed\n</code></pre> <p>This creates: - 50 users - 2 teams - 36 questions - 12 weeks of pulse data</p>"},{"location":"getting-started/troubleshooting/#verify-seed-data","title":"Verify Seed Data","text":"<pre><code>make db-test-seed\n</code></pre> <p>Expected output: - Users: 50 - Teams: 2 - Questions: 36 - Pulse responses: 800+</p>"},{"location":"getting-started/troubleshooting/#database-connection-errors","title":"Database Connection Errors","text":""},{"location":"getting-started/troubleshooting/#postgresql-not-accessible","title":"PostgreSQL Not Accessible","text":"<ol> <li> <p>Check PostgreSQL running: <pre><code>docker compose ps db\n</code></pre></p> </li> <li> <p>Test connection: <pre><code>docker compose exec db psql -U app -d ama -c \"SELECT 1;\"\n</code></pre></p> </li> <li> <p>Verify DATABASE_URL in <code>.env</code>: <pre><code>DATABASE_URL=postgresql://app:app@db:5432/ama\n</code></pre></p> </li> </ol>"},{"location":"getting-started/troubleshooting/#run-migrations","title":"Run Migrations","text":"<pre><code>docker compose exec api npx prisma migrate deploy\n</code></pre>"},{"location":"getting-started/troubleshooting/#redis-connection-errors","title":"Redis Connection Errors","text":"<ol> <li> <p>Check Redis running: <pre><code>docker compose ps redis\n</code></pre></p> </li> <li> <p>Test connection: <pre><code>docker compose exec redis redis-cli ping\n</code></pre></p> </li> </ol> <p>Expected: <code>PONG</code></p> <ol> <li>Verify REDIS_URL in <code>.env</code>: <pre><code>REDIS_URL=redis://redis:6379\n</code></pre></li> </ol>"},{"location":"getting-started/troubleshooting/#port-conflicts","title":"Port Conflicts","text":""},{"location":"getting-started/troubleshooting/#port-already-in-use","title":"Port Already in Use","text":"<p>If ports 3000, 5173, 5432, 6379, or 8025 are in use:</p> <ol> <li> <p>Find process using port: <pre><code>sudo lsof -i :3000\n</code></pre></p> </li> <li> <p>Kill process: <pre><code>sudo kill -9 &lt;PID&gt;\n</code></pre></p> </li> <li> <p>Or change ports in <code>docker-compose.yaml</code>: <pre><code>ports:\n  - \"3001:3000\"  # Use 3001 instead of 3000\n</code></pre></p> </li> </ol>"},{"location":"getting-started/troubleshooting/#email-not-sending","title":"Email Not Sending","text":""},{"location":"getting-started/troubleshooting/#check-email-configuration","title":"Check Email Configuration","text":"<pre><code># Verify email provider in .env\ngrep EMAIL_PROVIDER .env\n</code></pre>"},{"location":"getting-started/troubleshooting/#test-with-mailpit-development","title":"Test with Mailpit (Development)","text":"<ol> <li>Access Mailpit: <code>http://localhost:8025</code></li> <li>Check emails in Mailpit inbox</li> <li>Verify SMTP settings: <pre><code>SMTP_HOST=mailpit\nSMTP_PORT=1025\n</code></pre></li> </ol>"},{"location":"getting-started/troubleshooting/#production-email-issues","title":"Production Email Issues","text":"<ol> <li>Verify credentials for SMTP or Resend</li> <li>Check email queue:</li> <li>Admin \u2192 Email Queue</li> <li>View logs: <pre><code>docker compose logs -f api | grep -i email\n</code></pre></li> </ol>"},{"location":"getting-started/troubleshooting/#permission-errors","title":"Permission Errors","text":""},{"location":"getting-started/troubleshooting/#cannot-answer-questions","title":"Cannot Answer Questions","text":"<ol> <li>Verify role:</li> <li>Admin \u2192 Users \u2192 [Your User]</li> <li> <p>Check team memberships and roles</p> </li> <li> <p>Required role: Moderator, Admin, or Owner</p> </li> </ol>"},{"location":"getting-started/troubleshooting/#cannot-access-admin-panel","title":"Cannot Access Admin Panel","text":"<ol> <li>Required role: Admin or Owner</li> <li>Verify in database: <pre><code>docker compose exec db psql -U app -d ama -c \"SELECT email, role FROM \\\"User\\\" WHERE email = 'your@email.com';\"\n</code></pre></li> </ol>"},{"location":"getting-started/troubleshooting/#performance-issues","title":"Performance Issues","text":""},{"location":"getting-started/troubleshooting/#slow-search","title":"Slow Search","text":"<p>Full-text search requires GIN indexes:</p> <pre><code>docker compose exec api npx prisma migrate deploy\n</code></pre> <p>Verify indexes: <pre><code>docker compose exec db psql -U app -d ama -c \"\\d \\\"Question\\\";\"\n</code></pre></p> <p>Should show <code>question_search_idx</code> (GIN index).</p>"},{"location":"getting-started/troubleshooting/#high-memory-usage","title":"High Memory Usage","text":"<ol> <li> <p>Check Docker resource limits: <pre><code>docker stats\n</code></pre></p> </li> <li> <p>Increase Docker memory (Docker Desktop \u2192 Settings \u2192 Resources)</p> </li> <li> <p>Reduce worker processes in production</p> </li> </ol>"},{"location":"getting-started/troubleshooting/#frontend-not-loading","title":"Frontend Not Loading","text":""},{"location":"getting-started/troubleshooting/#white-screen-blank-page","title":"White Screen / Blank Page","text":"<ol> <li> <p>Check frontend logs: <pre><code>docker compose logs -f web\n</code></pre></p> </li> <li> <p>Verify API accessible: <pre><code>curl http://localhost:3000/health\n</code></pre></p> </li> <li> <p>Check CORS settings in <code>.env</code>: <pre><code>CORS_ORIGIN=http://localhost:5173\n</code></pre></p> </li> </ol>"},{"location":"getting-started/troubleshooting/#401-unauthorized-errors","title":"401 Unauthorized Errors","text":"<ol> <li>Clear cookies: Browser DevTools \u2192 Application \u2192 Cookies \u2192 Clear</li> <li>Log out and back in</li> <li>Verify session secrets in <code>.env</code> are set</li> </ol>"},{"location":"getting-started/troubleshooting/#pre-flight-check-failures","title":"Pre-Flight Check Failures","text":"<p>Run diagnostics:</p> <pre><code>make preflight\n</code></pre> <p>This checks: - Docker services - Database connectivity - API health - Frontend accessibility - Authentication flow - Seed data integrity</p> <p>Exit code 0 = all checks passed</p> <p>Exit code 1 = see output for failed checks</p>"},{"location":"getting-started/troubleshooting/#still-having-issues","title":"Still Having Issues?","text":"<ol> <li> <p>Check logs: <pre><code>docker compose logs -f\n</code></pre></p> </li> <li> <p>Verify environment variables: <pre><code>cat .env\ncat web/.env\n</code></pre></p> </li> <li> <p>Reset everything: <pre><code>docker compose down -v  # WARNING: Deletes all data\n./setup.sh\ndocker compose up -d\nmake db-seed\n</code></pre></p> </li> <li> <p>Open an issue: GitHub Issues</p> </li> </ol> <p>Include: - Error messages - Docker logs - Environment (OS, Docker version) - Steps to reproduce</p>"},{"location":"guides/admin/audit-logging/","title":"Audit Logging","text":"<p>Track all administrative and moderation actions.</p>"},{"location":"guides/admin/audit-logging/#overview","title":"Overview","text":"<p>Audit logs record: - Who performed the action (actor) - What action was taken - What was affected (entity) - When it occurred - Before/after state (for changes) - IP address and user agent</p> <p>Purpose: - Compliance and accountability - Security monitoring - Troubleshooting - Change tracking</p>"},{"location":"guides/admin/audit-logging/#view-audit-logs","title":"View Audit Logs","text":"<p>Admin \u2192 Audit Logs</p>"},{"location":"guides/admin/audit-logging/#log-entries","title":"Log Entries","text":"<p>Each entry shows: - Actor: User who performed action - Action: What was done (e.g., \"QUESTION_ANSWER\", \"USER_ROLE_CHANGE\") - Entity: What was affected (question ID, user ID, etc.) - Timestamp: When action occurred - Details: Before/after state, additional context - IP Address: Actor's IP - User Agent: Actor's browser/client</p>"},{"location":"guides/admin/audit-logging/#actions-logged","title":"Actions Logged","text":""},{"location":"guides/admin/audit-logging/#user-management","title":"User Management","text":"<ul> <li><code>USER_CREATE</code> - User created</li> <li><code>USER_UPDATE</code> - User updated</li> <li><code>USER_DELETE</code> - User deleted</li> <li><code>USER_ROLE_CHANGE</code> - Role assigned/changed</li> <li><code>USER_TEAM_ADD</code> - Added to team</li> <li><code>USER_TEAM_REMOVE</code> - Removed from team</li> </ul>"},{"location":"guides/admin/audit-logging/#question-management","title":"Question Management","text":"<ul> <li><code>QUESTION_CREATE</code> - Question submitted</li> <li><code>QUESTION_ANSWER</code> - Question answered</li> <li><code>QUESTION_PIN</code> - Question pinned</li> <li><code>QUESTION_UNPIN</code> - Question unpinned</li> <li><code>QUESTION_FREEZE</code> - Question frozen</li> <li><code>QUESTION_UNFREEZE</code> - Question unfrozen</li> <li><code>QUESTION_DELETE</code> - Question deleted</li> <li><code>QUESTION_TAG_ADD</code> - Tag added</li> <li><code>QUESTION_TAG_REMOVE</code> - Tag removed</li> </ul>"},{"location":"guides/admin/audit-logging/#team-management","title":"Team Management","text":"<ul> <li><code>TEAM_CREATE</code> - Team created</li> <li><code>TEAM_UPDATE</code> - Team updated</li> <li><code>TEAM_DELETE</code> - Team deleted</li> <li><code>TEAM_MEMBER_ADD</code> - Member added</li> <li><code>TEAM_MEMBER_REMOVE</code> - Member removed</li> <li><code>TEAM_MEMBER_ROLE_CHANGE</code> - Member role changed</li> </ul>"},{"location":"guides/admin/audit-logging/#system-administration","title":"System Administration","text":"<ul> <li><code>SETTINGS_UPDATE</code> - Tenant settings changed</li> <li><code>TAG_CREATE</code> - Tag created</li> <li><code>TAG_UPDATE</code> - Tag updated</li> <li><code>TAG_DELETE</code> - Tag deleted</li> <li><code>EXPORT_CREATE</code> - Data export generated</li> </ul>"},{"location":"guides/admin/audit-logging/#moderation","title":"Moderation","text":"<ul> <li><code>CONTENT_MODERATE</code> - Content flagged</li> <li><code>CONTENT_APPROVE</code> - Content approved</li> <li><code>CONTENT_REJECT</code> - Content rejected</li> </ul>"},{"location":"guides/admin/audit-logging/#filter-logs","title":"Filter Logs","text":""},{"location":"guides/admin/audit-logging/#by-actor","title":"By Actor","text":"<p>Search by user email or name to see all their actions.</p>"},{"location":"guides/admin/audit-logging/#by-action","title":"By Action","text":"<p>Filter by specific action type (e.g., all role changes).</p>"},{"location":"guides/admin/audit-logging/#by-entity","title":"By Entity","text":"<p>Filter by entity ID (e.g., all actions on specific question).</p>"},{"location":"guides/admin/audit-logging/#by-date-range","title":"By Date Range","text":"<p>Select start and end dates.</p>"},{"location":"guides/admin/audit-logging/#combined-filters","title":"Combined Filters","text":"<p>Use multiple filters together (e.g., actor + action + date range).</p>"},{"location":"guides/admin/audit-logging/#export-logs","title":"Export Logs","text":"<ol> <li>Admin \u2192 Audit Logs</li> <li>Apply filters (optional)</li> <li>Click \"Export\"</li> <li>Choose format: CSV or JSON</li> <li>Download</li> </ol> <p>Use cases: - Compliance reports - Security investigations - Change tracking - Data retention</p>"},{"location":"guides/admin/audit-logging/#log-retention","title":"Log Retention","text":"<ul> <li>Logs are append-only (cannot be modified or deleted)</li> <li>Retained indefinitely by default</li> <li>No automatic deletion</li> </ul> <p>Custom retention: Configure in database or implement archival process.</p>"},{"location":"guides/admin/audit-logging/#common-queries","title":"Common Queries","text":""},{"location":"guides/admin/audit-logging/#who-answered-this-question","title":"Who Answered This Question?","text":"<ol> <li>Filter by Entity: Question ID</li> <li>Filter by Action: <code>QUESTION_ANSWER</code></li> </ol>"},{"location":"guides/admin/audit-logging/#who-changed-this-users-role","title":"Who Changed This User's Role?","text":"<ol> <li>Filter by Entity: User ID</li> <li>Filter by Action: <code>USER_ROLE_CHANGE</code></li> </ol>"},{"location":"guides/admin/audit-logging/#all-actions-by-user","title":"All Actions by User","text":"<ol> <li>Filter by Actor: User email</li> </ol>"},{"location":"guides/admin/audit-logging/#all-failed-login-attempts","title":"All Failed Login Attempts","text":"<ol> <li>Filter by Action: <code>LOGIN_FAILED</code></li> </ol>"},{"location":"guides/admin/audit-logging/#changes-in-last-24-hours","title":"Changes in Last 24 Hours","text":"<ol> <li>Filter by Date: Yesterday to Now</li> </ol>"},{"location":"guides/admin/audit-logging/#security-monitoring","title":"Security Monitoring","text":""},{"location":"guides/admin/audit-logging/#suspicious-activity","title":"Suspicious Activity","text":"<p>Monitor for: - Multiple failed login attempts - Unusual role changes - Bulk deletions - Off-hours administrative actions</p>"},{"location":"guides/admin/audit-logging/#investigation-workflow","title":"Investigation Workflow","text":"<ol> <li>Identify issue: Notice suspicious activity</li> <li>Check audit logs: Filter by relevant criteria</li> <li>Verify actor: Confirm user identity</li> <li>Review actions: Examine what was done</li> <li>Take action: Revert changes if needed, contact user</li> </ol>"},{"location":"guides/admin/audit-logging/#compliance","title":"Compliance","text":"<p>Audit logs provide evidence for: - SOC 2 compliance - GDPR data handling - Internal audits - Security incidents</p>"},{"location":"guides/admin/audit-logging/#log-details","title":"Log Details","text":""},{"location":"guides/admin/audit-logging/#beforeafter-state","title":"Before/After State","text":"<p>Changes show: <pre><code>{\n  \"before\": {\n    \"role\": \"member\"\n  },\n  \"after\": {\n    \"role\": \"admin\"\n  }\n}\n</code></pre></p>"},{"location":"guides/admin/audit-logging/#contextual-information","title":"Contextual Information","text":"<p>Some logs include: - Reason (if provided) - IP address - User agent - Session ID - Bulk operation ID (for batch changes)</p>"},{"location":"guides/admin/audit-logging/#access-control","title":"Access Control","text":"<p>Who can view audit logs: - Admins - Owners</p> <p>Who cannot view: - Viewers - Members - Moderators</p> <p>Visibility: - All actions across all teams - No team-scoping for audit logs</p>"},{"location":"guides/admin/audit-logging/#best-practices","title":"Best Practices","text":"<ol> <li>Regular reviews: Check logs weekly for unusual activity</li> <li>Compliance reporting: Export logs monthly/quarterly</li> <li>Incident response: Check logs first when investigating issues</li> <li>Role changes: Always review who changed roles and why</li> <li>Data exports: Monitor who exports data</li> </ol>"},{"location":"guides/admin/audit-logging/#limitations","title":"Limitations","text":"<p>Not logged: - User logins (except failures) - Question views - Upvotes - Search queries - Pulse responses (anonymous by design)</p> <p>Why: Privacy and performance. Only administrative actions are logged.</p>"},{"location":"guides/admin/audit-logging/#troubleshooting","title":"Troubleshooting","text":""},{"location":"guides/admin/audit-logging/#cannot-find-log-entry","title":"Cannot Find Log Entry","text":"<p>Check: - Correct date range selected - Filters not too restrictive - Action actually occurred (verify in UI)</p>"},{"location":"guides/admin/audit-logging/#log-shows-wrong-actor","title":"Log Shows Wrong Actor","text":"<p>Possible causes: - System action (shows as \"system\" actor) - Automated process (cron, queue worker) - Impersonation (admin acting as user)</p>"},{"location":"guides/admin/audit-logging/#export-fails","title":"Export Fails","text":"<p>Solutions: - Reduce date range - Apply more specific filters - Contact support if persists</p>"},{"location":"guides/admin/audit-logging/#related-documentation","title":"Related Documentation","text":"<ul> <li>handbook/SECURITY_MODEL.md - Security model</li> <li>Roles &amp; Permissions - Who can do what</li> <li>Data Export - Export other data</li> </ul>"},{"location":"guides/admin/export/","title":"Data Export","text":"<p>Export questions, pulse responses, and audit logs.</p>"},{"location":"guides/admin/export/#export-types","title":"Export Types","text":""},{"location":"guides/admin/export/#questions-export","title":"Questions Export","text":"<p>Export all questions with: - Question text - Author (if not anonymous) - Team - Tags - Status (open/answered) - Upvote count - Answer text and author - Created date - Answered date</p>"},{"location":"guides/admin/export/#pulse-export","title":"Pulse Export","text":"<p>Export pulse responses with: - Question text - Response value (1-5) - Team - Cohort - Response date - No user identification (anonymous by design)</p>"},{"location":"guides/admin/export/#audit-logs-export","title":"Audit Logs Export","text":"<p>Export administrative actions with: - Actor - Action - Entity - Timestamp - Before/after state - IP address - User agent</p>"},{"location":"guides/admin/export/#export-format","title":"Export Format","text":"<p>Choose between: - CSV: Spreadsheet-compatible, easy to analyze - JSON: Structured data, API-compatible</p>"},{"location":"guides/admin/export/#export-questions","title":"Export Questions","text":"<ol> <li>Admin \u2192 Export</li> <li>Select \"Questions\"</li> <li>Choose filters (optional):</li> <li>Team</li> <li>Status (open/answered/all)</li> <li>Date range</li> <li>Tags</li> <li>Select format (CSV or JSON)</li> <li>Click \"Export\"</li> <li>Download file</li> </ol> <p>File name: <code>questions-YYYY-MM-DD.csv</code></p>"},{"location":"guides/admin/export/#export-pulse-responses","title":"Export Pulse Responses","text":"<ol> <li>Admin \u2192 Export</li> <li>Select \"Pulse Responses\"</li> <li>Choose filters (optional):</li> <li>Team</li> <li>Date range</li> <li>Question</li> <li>Select format (CSV or JSON)</li> <li>Click \"Export\"</li> <li>Download file</li> </ol> <p>File name: <code>pulse-YYYY-MM-DD.csv</code></p> <p>Privacy: No userId or email in export (anonymous).</p>"},{"location":"guides/admin/export/#export-audit-logs","title":"Export Audit Logs","text":"<ol> <li>Admin \u2192 Audit Logs</li> <li>Apply filters (optional)</li> <li>Click \"Export\"</li> <li>Select format (CSV or JSON)</li> <li>Download file</li> </ol> <p>File name: <code>audit-log-YYYY-MM-DD.csv</code></p>"},{"location":"guides/admin/export/#csv-format","title":"CSV Format","text":""},{"location":"guides/admin/export/#questions-csv","title":"Questions CSV","text":"<pre><code>id,text,author_email,team,tags,status,upvotes,answer_text,answer_author,created_at,answered_at\n1,\"Question text?\",\"alice@example.com\",\"Engineering\",\"Benefits,Policy\",answered,5,\"Answer text\",\"bob@example.com\",\"2025-01-01T10:00:00Z\",\"2025-01-02T14:00:00Z\"\n</code></pre>"},{"location":"guides/admin/export/#pulse-csv","title":"Pulse CSV","text":"<pre><code>id,question_text,response_value,team,cohort,created_at\n1,\"How satisfied are you?\",4,\"Engineering\",\"Weekday\",\"2025-01-01T10:00:00Z\"\n</code></pre>"},{"location":"guides/admin/export/#audit-log-csv","title":"Audit Log CSV","text":"<pre><code>id,actor_email,action,entity_type,entity_id,timestamp,before,after,ip_address\n1,\"admin@example.com\",\"USER_ROLE_CHANGE\",\"User\",\"123\",\"2025-01-01T10:00:00Z\",\"{\"\"role\"\":\"\"member\"\"}\",\"{\"\"role\"\":\"\"admin\"\"}\",\"192.168.1.1\"\n</code></pre>"},{"location":"guides/admin/export/#json-format","title":"JSON Format","text":"<p>Structured data with full object details:</p> <pre><code>{\n  \"questions\": [\n    {\n      \"id\": 1,\n      \"text\": \"Question text?\",\n      \"author\": {\n        \"email\": \"alice@example.com\",\n        \"name\": \"Alice\"\n      },\n      \"team\": {\n        \"id\": 1,\n        \"name\": \"Engineering\",\n        \"slug\": \"engineering\"\n      },\n      \"tags\": [\"Benefits\", \"Policy\"],\n      \"status\": \"answered\",\n      \"upvotes\": 5,\n      \"answer\": {\n        \"text\": \"Answer text\",\n        \"author\": {\n          \"email\": \"bob@example.com\",\n          \"name\": \"Bob\"\n        },\n        \"createdAt\": \"2025-01-02T14:00:00Z\"\n      },\n      \"createdAt\": \"2025-01-01T10:00:00Z\"\n    }\n  ],\n  \"meta\": {\n    \"total\": 1,\n    \"exportedAt\": \"2025-01-15T10:00:00Z\",\n    \"filters\": {\n      \"team\": \"Engineering\",\n      \"status\": \"answered\"\n    }\n  }\n}\n</code></pre>"},{"location":"guides/admin/export/#use-cases","title":"Use Cases","text":""},{"location":"guides/admin/export/#compliance-reporting","title":"Compliance Reporting","text":"<p>Export audit logs quarterly for: - SOC 2 compliance - Internal audits - Security reviews</p>"},{"location":"guides/admin/export/#data-analysis","title":"Data Analysis","text":"<p>Export questions and pulse responses for: - Trend analysis - Topic modeling - Sentiment analysis - Executive dashboards</p>"},{"location":"guides/admin/export/#backup","title":"Backup","text":"<p>Regular exports for: - Data backup - Disaster recovery - Migration</p>"},{"location":"guides/admin/export/#external-tools","title":"External Tools","text":"<p>Export and import into: - Excel/Google Sheets (CSV) - BI tools (Tableau, PowerBI) - Data warehouses - Analytics platforms</p>"},{"location":"guides/admin/export/#automation","title":"Automation","text":""},{"location":"guides/admin/export/#api-export-future","title":"API Export (Future)","text":"<p>Programmatic export via API:</p> <pre><code>curl -X POST https://api.yourdomain.com/admin/export \\\n  -H \"Authorization: Bearer $TOKEN\" \\\n  -d '{\"type\":\"questions\",\"format\":\"json\"}'\n</code></pre> <p>Status: Not yet implemented. Manual export only.</p>"},{"location":"guides/admin/export/#scheduled-exports-future","title":"Scheduled Exports (Future)","text":"<p>Configure automatic exports: - Daily/weekly/monthly schedule - Email or upload to S3 - Filtered by team/date</p> <p>Status: Not yet implemented.</p>"},{"location":"guides/admin/export/#security","title":"Security","text":""},{"location":"guides/admin/export/#access-control","title":"Access Control","text":"<p>Only admins and owners can export data.</p>"},{"location":"guides/admin/export/#audit-trail","title":"Audit Trail","text":"<p>All exports are logged: - Who exported - What was exported - When - Filters applied</p> <p>View in Admin \u2192 Audit Logs (action: <code>EXPORT_CREATE</code>).</p>"},{"location":"guides/admin/export/#data-privacy","title":"Data Privacy","text":"<p>Pulse exports: - No userId or email (anonymous by design) - Only aggregated response data</p> <p>Question exports: - Anonymous questions: No author information - Named questions: Author included</p>"},{"location":"guides/admin/export/#limitations","title":"Limitations","text":""},{"location":"guides/admin/export/#size-limits","title":"Size Limits","text":"<p>Maximum rows per export: - Questions: 10,000 - Pulse responses: 100,000 - Audit logs: 100,000</p> <p>Workaround: Export in date range chunks.</p>"},{"location":"guides/admin/export/#performance","title":"Performance","text":"<p>Large exports may take time: - &lt; 1,000 rows: Instant - 1,000-10,000 rows: Few seconds - 10,000+ rows: Up to 1 minute</p>"},{"location":"guides/admin/export/#filters","title":"Filters","text":"<p>Not all fields are filterable: - Questions: Team, status, tags, date - Pulse: Team, question, date - Audit logs: Actor, action, entity, date</p>"},{"location":"guides/admin/export/#troubleshooting","title":"Troubleshooting","text":""},{"location":"guides/admin/export/#export-times-out","title":"Export Times Out","text":"<p>Solutions: - Reduce date range - Apply more specific filters - Export in smaller chunks</p>"},{"location":"guides/admin/export/#csv-opens-incorrectly-in-excel","title":"CSV Opens Incorrectly in Excel","text":"<p>Solutions: - Use UTF-8 encoding - Import as data (not open directly) - Use Google Sheets instead</p>"},{"location":"guides/admin/export/#missing-data-in-export","title":"Missing Data in Export","text":"<p>Check: - Filters applied correctly - Date range includes data - You have permission to view data</p>"},{"location":"guides/admin/export/#best-practices","title":"Best Practices","text":"<ol> <li>Regular backups: Export monthly</li> <li>Compliance: Export audit logs quarterly</li> <li>Analysis: Export questions/pulse for insights</li> <li>Security: Store exports securely, encrypt if needed</li> <li>Retention: Delete old exports per policy</li> </ol>"},{"location":"guides/admin/export/#related-documentation","title":"Related Documentation","text":"<ul> <li>Audit Logging - View and filter logs</li> <li>handbook/SECURITY_MODEL.md - Data security</li> <li>handbook/DATA_MODEL_SNAPSHOT.md - Data structure</li> </ul>"},{"location":"guides/admin/moderation-stats/","title":"Moderation Stats","text":"<p>Track moderator activity and performance.</p>"},{"location":"guides/admin/moderation-stats/#overview","title":"Overview","text":"<p>Moderation stats show: - Which moderators are most active - Average response times - Question answer rates - Team moderation health</p> <p>Access: Admin \u2192 Moderation \u2192 Stats</p>"},{"location":"guides/admin/moderation-stats/#metrics","title":"Metrics","text":""},{"location":"guides/admin/moderation-stats/#per-moderator","title":"Per Moderator","text":"<p>Activity: - Questions answered - Tags applied - Questions pinned/frozen - Bulk operations performed</p> <p>Timing: - Average time to first answer - Total moderation time - Active hours per week</p> <p>Quality: - Questions answered vs. team total - Answer length (average) - Tags per question (average)</p>"},{"location":"guides/admin/moderation-stats/#per-team","title":"Per Team","text":"<p>Coverage: - Open question count - Average time to answer - Moderator count - Questions per moderator</p> <p>Trends: - Questions answered per week - Response time trend - Open question backlog</p>"},{"location":"guides/admin/moderation-stats/#view-stats","title":"View Stats","text":""},{"location":"guides/admin/moderation-stats/#moderator-leaderboard","title":"Moderator Leaderboard","text":"<ol> <li>Admin \u2192 Moderation \u2192 Stats</li> <li>View \"Moderator Activity\"</li> </ol> <p>Shows top moderators by: - Questions answered - Response time - Overall activity</p>"},{"location":"guides/admin/moderation-stats/#team-dashboard","title":"Team Dashboard","text":"<ol> <li>Admin \u2192 Moderation \u2192 Stats</li> <li>Select team</li> <li>View team-specific metrics</li> </ol>"},{"location":"guides/admin/moderation-stats/#time-range","title":"Time Range","text":"<p>Select period: - Last 7 days - Last 30 days - Last 90 days - All time - Custom range</p>"},{"location":"guides/admin/moderation-stats/#key-indicators","title":"Key Indicators","text":""},{"location":"guides/admin/moderation-stats/#healthy-moderation","title":"Healthy Moderation","text":"<p>Signs: - Average response time &lt; 24 hours - Open question backlog &lt; 10 - Multiple active moderators per team - Even distribution of workload</p>"},{"location":"guides/admin/moderation-stats/#needs-attention","title":"Needs Attention","text":"<p>Warning signs: - Average response time &gt; 48 hours - Open question backlog &gt; 20 - Single moderator doing all work - Declining activity trend</p>"},{"location":"guides/admin/moderation-stats/#use-cases","title":"Use Cases","text":""},{"location":"guides/admin/moderation-stats/#performance-reviews","title":"Performance Reviews","text":"<p>Export stats for moderator performance reviews: 1. Filter by moderator and date range 2. View activity metrics 3. Export as CSV</p>"},{"location":"guides/admin/moderation-stats/#capacity-planning","title":"Capacity Planning","text":"<p>Identify teams needing more moderators: 1. View team stats 2. Check open question backlog 3. Compare moderator counts 4. Add moderators if needed</p>"},{"location":"guides/admin/moderation-stats/#recognition","title":"Recognition","text":"<p>Recognize active moderators: 1. View leaderboard 2. Identify top contributors 3. Thank/reward high performers</p>"},{"location":"guides/admin/moderation-stats/#moderation-workflow","title":"Moderation Workflow","text":""},{"location":"guides/admin/moderation-stats/#question-lifecycle","title":"Question Lifecycle","text":"<p>Metrics tracked: 1. Submitted \u2192 Question created 2. Reviewed \u2192 Moderator views question 3. Answered \u2192 Moderator provides answer 4. Tagged \u2192 Question categorized 5. Pinned/Frozen \u2192 Special handling</p> <p>Time to answer = Time from submission to answer</p>"},{"location":"guides/admin/moderation-stats/#bulk-operations","title":"Bulk Operations","text":"<p>Tracked separately: - Bulk tag operations - Bulk pin operations - Bulk freeze operations - Bulk delete operations</p>"},{"location":"guides/admin/moderation-stats/#reports","title":"Reports","text":""},{"location":"guides/admin/moderation-stats/#weekly-report","title":"Weekly Report","text":"<p>Automatically generated: - Total questions answered - Average response time - Top moderators - Teams needing attention</p> <p>Access: Admin \u2192 Reports \u2192 Weekly Moderation</p>"},{"location":"guides/admin/moderation-stats/#monthly-report","title":"Monthly Report","text":"<p>Comprehensive overview: - All metrics - Trend comparisons - Team rankings - Moderator performance</p> <p>Access: Admin \u2192 Reports \u2192 Monthly Moderation</p>"},{"location":"guides/admin/moderation-stats/#benchmarks","title":"Benchmarks","text":""},{"location":"guides/admin/moderation-stats/#response-time","title":"Response Time","text":"<p>Excellent: &lt; 6 hours Good: 6-24 hours Acceptable: 24-48 hours Needs improvement: &gt; 48 hours</p>"},{"location":"guides/admin/moderation-stats/#question-backlog","title":"Question Backlog","text":"<p>Excellent: 0-5 open questions Good: 5-10 open questions Acceptable: 10-20 open questions Needs improvement: &gt; 20 open questions</p>"},{"location":"guides/admin/moderation-stats/#moderator-activity","title":"Moderator Activity","text":"<p>Active: &gt; 10 questions/month Moderate: 5-10 questions/month Low: 1-5 questions/month Inactive: 0 questions/month</p>"},{"location":"guides/admin/moderation-stats/#optimize-moderation","title":"Optimize Moderation","text":""},{"location":"guides/admin/moderation-stats/#add-moderators","title":"Add Moderators","text":"<p>If response times are slow: 1. Check team stats 2. Identify understaffed teams 3. Promote active members to moderators</p> <p>See Team Management.</p>"},{"location":"guides/admin/moderation-stats/#redistribute-workload","title":"Redistribute Workload","text":"<p>If one moderator is overloaded: 1. View moderator stats 2. Identify imbalanced workload 3. Encourage other moderators to participate</p>"},{"location":"guides/admin/moderation-stats/#set-expectations","title":"Set Expectations","text":"<p>Share targets with moderators: - Aim for &lt; 24 hour response time - Answer 2-3 questions per week - Keep backlog &lt; 10 questions</p>"},{"location":"guides/admin/moderation-stats/#privacy","title":"Privacy","text":""},{"location":"guides/admin/moderation-stats/#whats-not-tracked","title":"What's NOT Tracked","text":"<ul> <li>Individual question views</li> <li>Search queries</li> <li>Time spent reading</li> <li>Draft answers</li> </ul> <p>Why: Privacy and simplicity. Only completed actions tracked.</p>"},{"location":"guides/admin/moderation-stats/#data-access","title":"Data Access","text":"<p>Only admins and owners can view moderation stats.</p> <p>Moderators cannot see: - Other moderators' stats - Team-wide comparisons - Leaderboards</p>"},{"location":"guides/admin/moderation-stats/#export-stats","title":"Export Stats","text":"<ol> <li>Admin \u2192 Moderation \u2192 Stats</li> <li>Apply filters</li> <li>Click \"Export\"</li> <li>Choose CSV or JSON</li> <li>Download</li> </ol> <p>Use cases: - Performance reports - Capacity planning - Executive dashboards</p>"},{"location":"guides/admin/moderation-stats/#troubleshooting","title":"Troubleshooting","text":""},{"location":"guides/admin/moderation-stats/#stats-not-updating","title":"Stats Not Updating","text":"<p>Check: - Refresh page - Clear cache - Verify actions were completed (not drafts)</p>"},{"location":"guides/admin/moderation-stats/#missing-moderator","title":"Missing Moderator","text":"<p>Reasons: - Moderator has no activity in selected time range - Moderator role was recently assigned - Moderator was removed from team</p>"},{"location":"guides/admin/moderation-stats/#incorrect-numbers","title":"Incorrect Numbers","text":"<p>Solutions: - Check time range selected - Verify filters - Contact support if persists</p>"},{"location":"guides/admin/moderation-stats/#related-documentation","title":"Related Documentation","text":"<ul> <li>Roles &amp; Permissions - Moderator role</li> <li>Team Management - Assign moderators</li> <li>Audit Logging - Detailed action logs</li> <li>Moderator Guide - Moderator workflows</li> </ul>"},{"location":"guides/admin/overview/","title":"Admin Guide","text":"<p>Administrative features and workflows for PulseStage.</p>"},{"location":"guides/admin/overview/#admin-role","title":"Admin Role","text":"<p>Admins have full access to all features: - Manage teams and users - Configure tenant settings - View audit logs - Monitor email queue - Export data - Manage tags - Access all team content</p> <p>See Roles &amp; Permissions for complete role details.</p>"},{"location":"guides/admin/overview/#quick-links","title":"Quick Links","text":"<ul> <li>Roles &amp; Permissions - Manage user roles</li> <li>Team Management - Create and manage teams</li> <li>Tag Management - Organize questions with tags</li> <li>Audit Logging - Track all administrative actions</li> <li>Data Export - Export questions, pulse, audit logs</li> <li>Moderation Stats - View moderation metrics</li> </ul>"},{"location":"guides/admin/overview/#common-tasks","title":"Common Tasks","text":""},{"location":"guides/admin/overview/#access-admin-panel","title":"Access Admin Panel","text":"<p>Navigate to Admin \u2192 Overview in the main navigation.</p>"},{"location":"guides/admin/overview/#manage-users","title":"Manage Users","text":"<ol> <li>Admin \u2192 Users</li> <li>Search for user by email or name</li> <li>Click user to edit:</li> <li>Assign roles (viewer, member, moderator, admin, owner)</li> <li>Set primary team</li> <li>Add/remove team memberships</li> </ol>"},{"location":"guides/admin/overview/#create-teams","title":"Create Teams","text":"<ol> <li>Admin \u2192 Teams</li> <li>Click \"Create Team\"</li> <li>Enter details:</li> <li>Name (e.g., \"Engineering\")</li> <li>Slug (e.g., \"engineering\")</li> <li>Description (optional)</li> </ol> <p>See Team Management.</p>"},{"location":"guides/admin/overview/#monitor-activity","title":"Monitor Activity","text":"<ol> <li>Audit Logs: Admin \u2192 Audit Logs</li> <li>Filter by actor, action, entity, date</li> <li> <p>Export as CSV/JSON</p> </li> <li> <p>Email Queue: Admin \u2192 Email Queue</p> </li> <li>View pending and sent emails</li> <li> <p>Retry failed emails</p> </li> <li> <p>Moderation Stats: Admin \u2192 Moderation</p> </li> <li>View moderator activity</li> <li>Track response times</li> </ol>"},{"location":"guides/admin/overview/#configure-settings","title":"Configure Settings","text":"<p>Admin \u2192 Tenant Settings:</p> <ul> <li>Branding</li> <li>Website title</li> <li>Welcome message</li> <li> <p>Logo URL</p> </li> <li> <p>Theme</p> </li> <li>Choose from 3 built-in themes</li> <li> <p>Light/dark mode preference</p> </li> <li> <p>Features</p> </li> <li>Enable/disable pulse invitations</li> <li>Configure cohort size</li> <li>Set participation threshold</li> </ul> <p>See handbook/ADMIN_GUIDE.md for complete admin documentation.</p>"},{"location":"guides/admin/overview/#system-administration","title":"System Administration","text":""},{"location":"guides/admin/overview/#health-monitoring","title":"Health Monitoring","text":"<p>Check system health: - API: <code>http://localhost:3000/health</code> - Database connectivity - Redis connectivity - Rate limiting status</p>"},{"location":"guides/admin/overview/#email-configuration","title":"Email Configuration","text":"<p>Monitor email delivery: 1. Admin \u2192 Email Queue 2. View all pending and sent emails 3. Retry failed emails 4. Check email provider status</p> <p>See handbook/INTEGRATIONS/EMAIL.md.</p>"},{"location":"guides/admin/overview/#security-monitoring","title":"Security Monitoring","text":"<ol> <li>Audit Logs: Track all admin/moderator actions</li> <li>Rate Limiting: Monitor API request rates</li> <li>Content Moderation: Review flagged content</li> </ol> <p>See handbook/SECURITY_MODEL.md.</p>"},{"location":"guides/admin/overview/#data-management","title":"Data Management","text":""},{"location":"guides/admin/overview/#backups","title":"Backups","text":"<p>Export data regularly: - Questions: Admin \u2192 Export \u2192 Questions - Pulse: Admin \u2192 Export \u2192 Pulse Responses - Audit Logs: Admin \u2192 Export \u2192 Audit Logs</p> <p>Format: CSV or JSON</p>"},{"location":"guides/admin/overview/#data-retention","title":"Data Retention","text":"<ul> <li>Audit logs: Retained indefinitely</li> <li>Pulse responses: Anonymous, retained indefinitely</li> <li>Questions: Retained until deleted</li> <li>User data: Retained until account deleted</li> </ul>"},{"location":"guides/admin/overview/#troubleshooting","title":"Troubleshooting","text":""},{"location":"guides/admin/overview/#cannot-access-admin-panel","title":"Cannot Access Admin Panel","text":"<p>Verify your role: 1. Contact another admin or owner 2. Check database: <code>SELECT role FROM \"User\" WHERE email='your@email.com';</code></p> <p>Required role: Admin or Owner</p>"},{"location":"guides/admin/overview/#users-cannot-log-in","title":"Users Cannot Log In","text":"<ol> <li>Check authentication configuration (Admin \u2192 Tenant Settings)</li> <li>Verify OAuth apps are configured</li> <li>Check audit logs for failed login attempts</li> </ol>"},{"location":"guides/admin/overview/#email-not-sending","title":"Email Not Sending","text":"<ol> <li>Admin \u2192 Email Queue</li> <li>Check failed emails</li> <li>Verify email provider configuration</li> <li>Test with Admin \u2192 Send Test Email</li> </ol>"},{"location":"guides/admin/overview/#best-practices","title":"Best Practices","text":"<ol> <li>Regular Audits: Review audit logs weekly</li> <li>Role Assignment: Grant minimum necessary permissions</li> <li>Team Organization: Create teams that match your org structure</li> <li>Tag Management: Maintain consistent tag taxonomy</li> <li>Data Exports: Regular backups of critical data</li> </ol>"},{"location":"guides/admin/overview/#next-steps","title":"Next Steps","text":"<ul> <li>Roles &amp; Permissions - Understand role model</li> <li>Team Management - Set up teams</li> <li>handbook/ADMIN_GUIDE.md - Complete admin documentation</li> </ul>"},{"location":"guides/admin/roles-permissions/","title":"Roles &amp; Permissions","text":"<p>PulseStage uses role-based access control (RBAC) with 5 roles.</p>"},{"location":"guides/admin/roles-permissions/#roles","title":"Roles","text":""},{"location":"guides/admin/roles-permissions/#viewer","title":"Viewer","text":"<p>Scope: Team-scoped</p> <p>Permissions: - Browse questions - View answers - Upvote questions - View pulse dashboard (team only)</p> <p>Cannot: - Submit questions - Answer questions - Moderate content - Access admin features</p>"},{"location":"guides/admin/roles-permissions/#member","title":"Member","text":"<p>Scope: Team-scoped</p> <p>Permissions: - All Viewer permissions, plus: - Submit questions (anonymous or named) - Respond to pulse invitations - Search and filter questions</p> <p>Cannot: - Answer questions - Moderate content - Access admin features</p> <p>Default role for new users.</p>"},{"location":"guides/admin/roles-permissions/#moderator","title":"Moderator","text":"<p>Scope: Team-scoped</p> <p>Permissions: - All Member permissions, plus: - Answer questions (team only) - Tag questions (team only) - Pin questions (team only) - Freeze questions (team only) - Access moderation queue (team only) - Use presentation mode (team only) - Bulk operations (team only)</p> <p>Cannot: - Moderate other teams' content - Access admin features - Manage users</p> <p>Key feature: Team-scoped permissions. Moderators can only moderate their assigned teams.</p>"},{"location":"guides/admin/roles-permissions/#admin","title":"Admin","text":"<p>Scope: Global (all teams)</p> <p>Permissions: - All Moderator permissions (all teams), plus: - View audit logs - Export data (CSV/JSON) - Manage teams (create, edit, delete) - Manage tags (create, edit, delete) - Monitor email queue - Configure tenant settings - Manage user roles - View moderation stats</p> <p>Cannot: - Delete users - Change owner role</p>"},{"location":"guides/admin/roles-permissions/#owner","title":"Owner","text":"<p>Scope: Global (all teams)</p> <p>Permissions: - All Admin permissions, plus: - Delete users - Assign/revoke owner role - Complete system control</p> <p>Highest privilege level.</p>"},{"location":"guides/admin/roles-permissions/#permission-matrix","title":"Permission Matrix","text":"Permission Viewer Member Moderator Admin Owner Browse questions \u2713 \u2713 \u2713 \u2713 \u2713 Upvote \u2713 \u2713 \u2713 \u2713 \u2713 Submit questions - \u2713 \u2713 \u2713 \u2713 Answer questions - - \u2713 (team) \u2713 (all) \u2713 (all) Tag/Pin/Freeze - - \u2713 (team) \u2713 (all) \u2713 (all) Presentation mode - - \u2713 (team) \u2713 (all) \u2713 (all) View audit logs - - - \u2713 \u2713 Export data - - - \u2713 \u2713 Manage teams - - - \u2713 \u2713 Manage users - - - \u2713 \u2713 Delete users - - - - \u2713 Assign owner - - - - \u2713"},{"location":"guides/admin/roles-permissions/#assigning-roles","title":"Assigning Roles","text":""},{"location":"guides/admin/roles-permissions/#user-roles","title":"User Roles","text":"<ol> <li>Admin \u2192 Users \u2192 [User Name]</li> <li>Select role from dropdown</li> <li>Save</li> </ol> <p>Note: User must be logged in at least once before role can be assigned.</p>"},{"location":"guides/admin/roles-permissions/#team-roles","title":"Team Roles","text":"<p>Users can have different roles per team:</p> <ol> <li>Admin \u2192 Teams \u2192 [Team Name]</li> <li>Click \"Manage Members\"</li> <li>Add user and select role</li> <li>Save</li> </ol> <p>Example: - Alice: Moderator (Engineering), Member (Product) - Bob: Admin (global)</p>"},{"location":"guides/admin/roles-permissions/#role-strategy","title":"Role Strategy","text":""},{"location":"guides/admin/roles-permissions/#small-organizations-50-users","title":"Small Organizations (&lt; 50 users)","text":"<ul> <li>Most users: Member</li> <li>Team leads: Moderator (their team)</li> <li>1-2 people: Admin</li> <li>1 person: Owner</li> </ul>"},{"location":"guides/admin/roles-permissions/#large-organizations-50-users","title":"Large Organizations (50+ users)","text":"<ul> <li>All employees: Member or Viewer</li> <li>Team leads: Moderator (their team)</li> <li>Department heads: Admin</li> <li>1-2 people: Owner</li> </ul>"},{"location":"guides/admin/roles-permissions/#external-users-contractors-partners","title":"External Users (Contractors, Partners)","text":"<ul> <li>Default: Viewer</li> <li>If contributing: Member</li> <li>Never: Moderator, Admin, or Owner</li> </ul>"},{"location":"guides/admin/roles-permissions/#security-considerations","title":"Security Considerations","text":""},{"location":"guides/admin/roles-permissions/#principle-of-least-privilege","title":"Principle of Least Privilege","text":"<p>Grant minimum permissions necessary: - Default to Member for regular users - Moderator only for active team moderators - Admin only for system administrators - Owner only for 1-2 trusted individuals</p>"},{"location":"guides/admin/roles-permissions/#role-changes","title":"Role Changes","text":"<p>All role changes are logged in audit log: - Actor (who changed role) - Target (whose role changed) - Old role \u2192 New role - Timestamp</p> <p>View in Admin \u2192 Audit Logs.</p>"},{"location":"guides/admin/roles-permissions/#team-scoped-security","title":"Team-Scoped Security","text":"<p>Moderators can only: - View their assigned teams - Moderate content in their teams - Cannot access other teams' private content</p> <p>Admins and owners can access all teams.</p>"},{"location":"guides/admin/roles-permissions/#role-validation","title":"Role Validation","text":""},{"location":"guides/admin/roles-permissions/#check-users-roles","title":"Check User's Roles","text":"<p>Admin \u2192 Users \u2192 [User Name]</p> <p>Shows: - Global role - Team memberships and roles - Primary team</p>"},{"location":"guides/admin/roles-permissions/#verify-permissions","title":"Verify Permissions","text":"<p>Test as user: 1. Admin \u2192 Users \u2192 [User Name] 2. Click \"Impersonate User\" (if available) 3. Verify permissions work as expected</p> <p>Or check database: <pre><code>SELECT u.email, u.role, tm.team_id, tm.role as team_role\nFROM \"User\" u\nLEFT JOIN \"TeamMembership\" tm ON u.id = tm.user_id\nWHERE u.email = 'user@example.com';\n</code></pre></p>"},{"location":"guides/admin/roles-permissions/#common-issues","title":"Common Issues","text":""},{"location":"guides/admin/roles-permissions/#user-cannot-submit-questions","title":"User Cannot Submit Questions","text":"<p>Check: 1. Role is Member or higher 2. User is member of at least one team 3. User has set primary team</p>"},{"location":"guides/admin/roles-permissions/#moderator-cannot-answer-questions","title":"Moderator Cannot Answer Questions","text":"<p>Check: 1. Question is in moderator's team 2. Moderator role is assigned for that team 3. Question is not frozen</p>"},{"location":"guides/admin/roles-permissions/#admin-cannot-access-feature","title":"Admin Cannot Access Feature","text":"<p>Check: 1. Feature is enabled in tenant settings 2. User role is Admin or Owner 3. Browser cookies/session are valid</p>"},{"location":"guides/admin/roles-permissions/#best-practices","title":"Best Practices","text":"<ol> <li>Regular audits - Review role assignments quarterly</li> <li>Offboarding - Remove roles when users leave</li> <li>Team changes - Update team memberships when users change teams</li> <li>Document decisions - Keep record of why users have elevated roles</li> </ol>"},{"location":"guides/admin/roles-permissions/#related-documentation","title":"Related Documentation","text":"<ul> <li>Team Management - Assign team roles</li> <li>Audit Logging - Track role changes</li> <li>handbook/SECURITY_MODEL.md - Security model details</li> <li>handbook/DECISIONS/ADR-0003-roles.md - Role design decisions</li> </ul>"},{"location":"guides/admin/tag-management/","title":"Tag Management","text":"<p>Create and manage tags to organize questions.</p>"},{"location":"guides/admin/tag-management/#tags-overview","title":"Tags Overview","text":"<p>Tags help: - Categorize questions by topic - Filter questions in search - Group related questions - Track trending topics</p>"},{"location":"guides/admin/tag-management/#create-tag","title":"Create Tag","text":"<ol> <li>Admin \u2192 Tags</li> <li>Click \"Create Tag\"</li> <li>Enter:</li> <li>Name: Tag name (e.g., \"Benefits\")</li> <li>Color: Visual identifier (optional)</li> <li>Click \"Create\"</li> </ol> <p>Tag naming: - Keep short (1-2 words) - Use clear, common terms - Avoid abbreviations - Use singular form (e.g., \"Benefit\" not \"Benefits\")</p>"},{"location":"guides/admin/tag-management/#edit-tag","title":"Edit Tag","text":"<ol> <li>Admin \u2192 Tags</li> <li>Click tag name</li> <li>Update name or color</li> <li>Save</li> </ol> <p>Note: Renaming updates all tagged questions.</p>"},{"location":"guides/admin/tag-management/#delete-tag","title":"Delete Tag","text":"<ol> <li>Admin \u2192 Tags</li> <li>Click tag</li> <li>Click \"Delete\"</li> <li>Confirm</li> </ol> <p>Effect: Removes tag from all questions (questions remain).</p>"},{"location":"guides/admin/tag-management/#tag-usage","title":"Tag Usage","text":""},{"location":"guides/admin/tag-management/#apply-tags","title":"Apply Tags","text":"<p>Moderators and admins can tag questions:</p> <ol> <li>View question</li> <li>Click \"Tag\" button</li> <li>Select existing tags or create new</li> <li>Save</li> </ol>"},{"location":"guides/admin/tag-management/#bulk-tagging","title":"Bulk Tagging","text":"<ol> <li>Moderation Queue</li> <li>Select multiple questions</li> <li>Click \"Tag\"</li> <li>Select tags</li> <li>Apply</li> </ol>"},{"location":"guides/admin/tag-management/#auto-tagging","title":"Auto-Tagging","text":"<p>Presentation mode includes auto-tagging workflow:</p> <ol> <li>View question in presentation mode</li> <li>Press <code>T</code> to tag</li> <li>Select tags</li> <li>Question auto-tagged and moved to next</li> </ol> <p>See Moderator Guide.</p>"},{"location":"guides/admin/tag-management/#tag-analytics","title":"Tag Analytics","text":"<p>View tag statistics:</p> <ol> <li>Admin \u2192 Tags</li> </ol> <p>Shows per tag: - Question count - Last used date - Most active team</p>"},{"location":"guides/admin/tag-management/#tag-strategy","title":"Tag Strategy","text":""},{"location":"guides/admin/tag-management/#recommended-tags","title":"Recommended Tags","text":"<p>Product/Feature: - Product - Feature Request - Bug Report</p> <p>Topics: - Benefits - Career - Culture - Policy - Technology - Process</p> <p>Event-Specific: - All Hands Q4 2025 - Town Hall January</p> <p>Urgency: - Urgent - Follow-up Required</p>"},{"location":"guides/admin/tag-management/#tag-taxonomy","title":"Tag Taxonomy","text":"<p>Keep it simple: - 10-20 tags max - Clear, non-overlapping categories - Review and consolidate quarterly</p>"},{"location":"guides/admin/tag-management/#tag-consistency","title":"Tag Consistency","text":""},{"location":"guides/admin/tag-management/#enforce-standards","title":"Enforce Standards","text":"<ol> <li>Naming convention: Document approved tags</li> <li>Training: Educate moderators on tag usage</li> <li>Cleanup: Merge duplicate/similar tags regularly</li> </ol>"},{"location":"guides/admin/tag-management/#merge-tags","title":"Merge Tags","text":"<p>To consolidate tags: 1. Create preferred tag (if doesn't exist) 2. Bulk retag questions from old tag to new tag 3. Delete old tag</p> <p>Example: Merge \"Compensation\" and \"Pay\" \u2192 \"Compensation\"</p>"},{"location":"guides/admin/tag-management/#tag-permissions","title":"Tag Permissions","text":"<p>Can create tags: - Moderators (when tagging questions) - Admins - Owners</p> <p>Can manage tags (edit/delete): - Admins - Owners</p>"},{"location":"guides/admin/tag-management/#common-tasks","title":"Common Tasks","text":""},{"location":"guides/admin/tag-management/#clean-up-unused-tags","title":"Clean Up Unused Tags","text":"<ol> <li>Admin \u2192 Tags</li> <li>Sort by \"Question Count\"</li> <li>Delete tags with 0 questions</li> </ol>"},{"location":"guides/admin/tag-management/#rename-tag","title":"Rename Tag","text":"<ol> <li>Admin \u2192 Tags \u2192 [Tag Name]</li> <li>Edit name</li> <li>Save</li> </ol> <p>All questions update automatically.</p>"},{"location":"guides/admin/tag-management/#seasonal-tag-cleanup","title":"Seasonal Tag Cleanup","text":"<p>After events: 1. Review event-specific tags 2. Keep if useful for reference 3. Delete if no longer relevant</p>"},{"location":"guides/admin/tag-management/#best-practices","title":"Best Practices","text":"<ol> <li>Consistency: Use same tags across teams</li> <li>Clarity: Avoid ambiguous tag names</li> <li>Maintenance: Review tags quarterly</li> <li>Documentation: Maintain list of approved tags</li> <li>Training: Educate moderators on tagging</li> </ol>"},{"location":"guides/admin/tag-management/#troubleshooting","title":"Troubleshooting","text":""},{"location":"guides/admin/tag-management/#cannot-delete-tag","title":"Cannot Delete Tag","text":"<p>Reasons: - Tag is in use (shows question count) - Solution: Retag questions, then delete</p>"},{"location":"guides/admin/tag-management/#tag-not-appearing","title":"Tag Not Appearing","text":"<p>Check: - Tag was created successfully - Refresh page - Check spelling</p>"},{"location":"guides/admin/tag-management/#duplicate-tags","title":"Duplicate Tags","text":"<p>Fix: 1. Decide which tag to keep 2. Retag all questions 3. Delete duplicate</p>"},{"location":"guides/admin/tag-management/#related-documentation","title":"Related Documentation","text":"<ul> <li>Moderator Guide - How to tag questions</li> <li>User Guide - Search by tags</li> </ul>"},{"location":"guides/admin/team-management/","title":"Team Management","text":"<p>Create and manage teams to organize questions and users.</p>"},{"location":"guides/admin/team-management/#team-structure","title":"Team Structure","text":"<p>Teams organize: - Questions (team-scoped) - Pulse data (team-scoped with org rollups) - Moderators (team-scoped permissions) - Users (primary team + memberships)</p>"},{"location":"guides/admin/team-management/#create-team","title":"Create Team","text":"<ol> <li>Admin \u2192 Teams</li> <li>Click \"Create Team\"</li> <li>Enter:</li> <li>Name: Display name (e.g., \"Engineering\")</li> <li>Slug: URL-friendly (e.g., \"engineering\")</li> <li> <p>Description: Optional team description</p> </li> <li> <p>Click \"Create\"</p> </li> </ol> <p>Slug requirements: - Lowercase - No spaces (use hyphens) - Alphanumeric + hyphens only - Cannot be: \"all\", \"admin\", \"api\"</p>"},{"location":"guides/admin/team-management/#edit-team","title":"Edit Team","text":"<ol> <li>Admin \u2192 Teams \u2192 [Team Name]</li> <li>Click \"Edit\"</li> <li>Update name, slug, or description</li> <li>Save</li> </ol> <p>Note: Changing slug changes team URLs.</p>"},{"location":"guides/admin/team-management/#delete-team","title":"Delete Team","text":"<ol> <li>Admin \u2192 Teams \u2192 [Team Name]</li> <li>Click \"Delete\"</li> <li>Confirm deletion</li> </ol> <p>Warning: This deletes: - All team questions - All team pulse data - Team memberships</p> <p>Cannot be undone.</p>"},{"location":"guides/admin/team-management/#manage-team-members","title":"Manage Team Members","text":""},{"location":"guides/admin/team-management/#add-members","title":"Add Members","text":"<ol> <li>Admin \u2192 Teams \u2192 [Team Name] \u2192 \"Manage Members\"</li> <li>Click \"Add Member\"</li> <li>Search for user by email/name</li> <li>Select role:</li> <li>Viewer</li> <li>Member</li> <li>Moderator</li> <li>Click \"Add\"</li> </ol>"},{"location":"guides/admin/team-management/#change-member-role","title":"Change Member Role","text":"<ol> <li>Admin \u2192 Teams \u2192 [Team Name] \u2192 \"Manage Members\"</li> <li>Find user</li> <li>Click role dropdown</li> <li>Select new role</li> <li>Save</li> </ol>"},{"location":"guides/admin/team-management/#remove-members","title":"Remove Members","text":"<ol> <li>Admin \u2192 Teams \u2192 [Team Name] \u2192 \"Manage Members\"</li> <li>Find user</li> <li>Click \"Remove\"</li> <li>Confirm</li> </ol> <p>Note: Users must belong to at least one team.</p>"},{"location":"guides/admin/team-management/#primary-team","title":"Primary Team","text":"<p>Each user has one primary team:</p> <ul> <li>Determines default view on login</li> <li>Used for pulse cohort assignment</li> <li>Shown in user profile</li> </ul> <p>Set primary team: 1. Admin \u2192 Users \u2192 [User Name] 2. Select \"Primary Team\" 3. Save</p>"},{"location":"guides/admin/team-management/#team-visibility","title":"Team Visibility","text":"<p>All teams are visible to all users (public).</p> <p>Privacy: - Questions are team-scoped - Pulse data is team-scoped - Moderator permissions are team-scoped</p> <p>Users can: - View all teams - Switch between teams - See question counts per team</p>"},{"location":"guides/admin/team-management/#bulk-operations","title":"Bulk Operations","text":""},{"location":"guides/admin/team-management/#bulk-add-members","title":"Bulk Add Members","text":"<ol> <li> <p>Create CSV file: <pre><code>email,team,role\nalice@example.com,engineering,member\nbob@example.com,engineering,moderator\n</code></pre></p> </li> <li> <p>Admin \u2192 Teams \u2192 [Team Name] \u2192 \"Import Members\"</p> </li> <li>Upload CSV</li> <li>Review and confirm</li> </ol>"},{"location":"guides/admin/team-management/#bulk-update-roles","title":"Bulk Update Roles","text":"<ol> <li>Admin \u2192 Teams \u2192 [Team Name] \u2192 \"Manage Members\"</li> <li>Select multiple users</li> <li>Click \"Change Role\"</li> <li>Select new role</li> <li>Confirm</li> </ol>"},{"location":"guides/admin/team-management/#team-analytics","title":"Team Analytics","text":"<p>View team statistics:</p> <ol> <li>Admin \u2192 Teams \u2192 [Team Name] \u2192 \"Analytics\"</li> </ol> <p>Shows: - Total members - Active questions - Answered questions - Pulse participation rate - Moderator activity</p>"},{"location":"guides/admin/team-management/#common-tasks","title":"Common Tasks","text":""},{"location":"guides/admin/team-management/#create-department-teams","title":"Create Department Teams","text":"<p>Recommended structure: - Engineering - Product - Marketing - Sales - Customer Success - General (for company-wide questions)</p>"},{"location":"guides/admin/team-management/#reorganize-teams","title":"Reorganize Teams","text":"<p>When teams change: 1. Create new team 2. Move users to new team 3. Archive old team (optional)</p> <p>Cannot: Move questions between teams (by design).</p>"},{"location":"guides/admin/team-management/#seasonal-teams","title":"Seasonal Teams","text":"<p>For temporary teams (e.g., \"All Hands 2025\"): 1. Create team 2. Use for event 3. Delete or archive after event</p>"},{"location":"guides/admin/team-management/#best-practices","title":"Best Practices","text":"<ol> <li>Naming: Use clear, recognized team names</li> <li>Size: Keep teams &lt; 100 members for best experience</li> <li>Moderators: Assign 2-3 moderators per team</li> <li>Primary teams: Ensure all users have primary team set</li> <li>Cleanup: Delete unused teams periodically</li> </ol>"},{"location":"guides/admin/team-management/#troubleshooting","title":"Troubleshooting","text":""},{"location":"guides/admin/team-management/#cannot-delete-team","title":"Cannot Delete Team","text":"<p>Reasons: - Team has questions (delete questions first) - Team has members (remove members first) - You don't have admin/owner role</p>"},{"location":"guides/admin/team-management/#users-not-seeing-team","title":"Users Not Seeing Team","text":"<p>Check: - Team is created - User is logged in - Team hasn't been deleted</p>"},{"location":"guides/admin/team-management/#moderator-cannot-access-team","title":"Moderator Cannot Access Team","text":"<p>Check: - Moderator is member of team - Moderator role is assigned for that team - Team exists</p>"},{"location":"guides/admin/team-management/#related-documentation","title":"Related Documentation","text":"<ul> <li>Roles &amp; Permissions - Team roles</li> <li>handbook/DATA_MODEL_SNAPSHOT.md - Team data model</li> <li>handbook/PRODUCT_VISION.md - Team-first architecture</li> </ul>"},{"location":"guides/moderator/answering-questions/","title":"Answering Questions","text":"<p>Provide clear, helpful answers to questions.</p>"},{"location":"guides/moderator/answering-questions/#answer-a-question","title":"Answer a Question","text":"<ol> <li>Click question to view details</li> <li>Click \"Answer\" button</li> <li>Write answer in editor (markdown supported)</li> <li>Preview (optional)</li> <li>Click \"Submit Answer\"</li> </ol> <p>Answer appears immediately.</p>"},{"location":"guides/moderator/answering-questions/#answer-format","title":"Answer Format","text":"<p>Use markdown: - Bold: <code>**text**</code> - Italic: <code>*text*</code> - Lists: <code>- item</code> or <code>1. item</code> - Links: <code>[text](url)</code> - Code: <code>`code`</code></p> <p>Structure: 1. Direct answer first 2. Context/explanation 3. Next steps or resources</p>"},{"location":"guides/moderator/answering-questions/#good-answers","title":"Good Answers","text":"<p>Clear: - Answer the specific question - Be direct and concise - Avoid jargon</p> <p>Complete: - Provide context - Explain reasoning - Include timeline if relevant</p> <p>Helpful: - Add resources or links - Suggest follow-up if needed - Be honest if you don't know</p>"},{"location":"guides/moderator/answering-questions/#examples","title":"Examples","text":"<p>Good: <pre><code>We'll roll out remote work policy by end of Q1 2025.\n\nPolicy will include:\n- 2 days/week in office required\n- Flexible scheduling within team\n- Full documentation in handbook by Feb 1\n\nNext: HR will email details to all employees in January.\n</code></pre></p> <p>Poor: <pre><code>We're working on it.\n</code></pre></p>"},{"location":"guides/moderator/answering-questions/#edit-answer","title":"Edit Answer","text":"<ol> <li>View question</li> <li>Click \"Edit Answer\"</li> <li>Update text</li> <li>Save</li> </ol> <p>Note: Edit history is tracked in audit log.</p>"},{"location":"guides/moderator/answering-questions/#delete-answer","title":"Delete Answer","text":"<p>Click \"Delete Answer\" to remove.</p> <p>Use rarely: Only if answer is wrong or inappropriate.</p>"},{"location":"guides/moderator/answering-questions/#answer-status","title":"Answer Status","text":"<p>Once answered, question: - Moves to \"Answered\" tab - Shows answer with your name - Can still be upvoted - Can be frozen to lock</p>"},{"location":"guides/moderator/answering-questions/#team-scoped","title":"Team-Scoped","text":"<p>You can only answer questions in your assigned teams.</p> <p>Questions in other teams will not show \"Answer\" button.</p>"},{"location":"guides/moderator/answering-questions/#bulk-answering","title":"Bulk Answering","text":"<p>Not currently supported. Answer questions individually.</p>"},{"location":"guides/moderator/answering-questions/#tips","title":"Tips","text":"<ol> <li>Answer soon - Aim for &lt; 48 hours</li> <li>Be thorough - Complete answers prevent follow-ups</li> <li>Use markdown - Format for readability</li> <li>Link resources - Reference documentation</li> <li>Tag first - Tag before answering to organize</li> </ol>"},{"location":"guides/moderator/answering-questions/#related","title":"Related","text":"<ul> <li>Tagging - Organize before answering</li> <li>Moderation Queue - Find questions to answer</li> <li>Presentation Mode - Answer during presentations</li> </ul>"},{"location":"guides/moderator/moderation-queue/","title":"Moderation Queue","text":"<p>Dedicated interface for managing questions efficiently.</p>"},{"location":"guides/moderator/moderation-queue/#access-queue","title":"Access Queue","text":"<ol> <li>Navigate to your team</li> <li>Click \"Moderation Queue\"</li> </ol>"},{"location":"guides/moderator/moderation-queue/#queue-features","title":"Queue Features","text":"<p>View: - All questions (open and answered) - Quick actions (pin, freeze, answer, tag) - Filters and sorting - Bulk operations</p> <p>Benefits: - See all questions at once - Faster moderation workflow - Bulk operations support</p>"},{"location":"guides/moderator/moderation-queue/#quick-actions","title":"Quick Actions","text":"<p>Each question has action buttons: - \ud83d\udccc Pin - Highlight important - \u2744\ufe0f Freeze - Lock interaction - \ud83d\udcac Answer - Provide answer - \ud83c\udff7\ufe0f Tag - Add tags - \ud83d\uddd1\ufe0f Delete - Remove question</p>"},{"location":"guides/moderator/moderation-queue/#filters","title":"Filters","text":"<p>By status: - Open - Answered - Pinned - Frozen - All</p> <p>By tag: Select tag from dropdown</p> <p>By date: Custom date range</p> <p>By text: Search question text</p>"},{"location":"guides/moderator/moderation-queue/#sorting","title":"Sorting","text":"<p>Sort by: - Upvotes (most first) - Date (newest first) - Date (oldest first)</p>"},{"location":"guides/moderator/moderation-queue/#bulk-operations","title":"Bulk Operations","text":"<ol> <li>Select multiple questions (checkboxes)</li> <li>Choose action:</li> <li>Tag all</li> <li>Pin all</li> <li>Freeze all</li> <li>Delete all</li> <li>Confirm</li> </ol> <p>Use cases: - Tag all questions from meeting - Pin top 5 questions - Freeze answered questions - Delete spam questions</p>"},{"location":"guides/moderator/moderation-queue/#keyboard-shortcuts","title":"Keyboard Shortcuts","text":"<ul> <li><code>j</code> / <code>k</code> - Next/previous question</li> <li><code>a</code> - Answer question</li> <li><code>t</code> - Tag question</li> <li><code>p</code> - Pin/unpin question</li> <li><code>f</code> - Freeze/unfreeze question</li> </ul>"},{"location":"guides/moderator/moderation-queue/#tips","title":"Tips","text":"<ol> <li>Review daily - Check queue for new questions</li> <li>Filter strategically - Focus on open questions</li> <li>Bulk tag - Efficient for multiple questions</li> <li>Use shortcuts - Faster navigation</li> <li>Prioritize by upvotes - Answer popular questions first</li> </ol>"},{"location":"guides/moderator/moderation-queue/#related","title":"Related","text":"<ul> <li>Answering Questions</li> <li>Tagging</li> <li>Presentation Mode</li> </ul>"},{"location":"guides/moderator/overview/","title":"Moderator Guide","text":"<p>Moderate questions, provide answers, and manage content for your teams.</p>"},{"location":"guides/moderator/overview/#moderator-role","title":"Moderator Role","text":"<p>Moderators have team-scoped permissions to: - Answer questions (your teams only) - Tag questions - Pin important questions - Freeze questions to lock interaction - Access moderation queue - Use presentation mode - Perform bulk operations</p> <p>See Admin Guide - Roles.</p>"},{"location":"guides/moderator/overview/#quick-links","title":"Quick Links","text":"<ul> <li>Answering Questions - Provide answers</li> <li>Moderation Queue - Manage queue</li> <li>Presentation Mode - Present at all-hands</li> <li>Tagging - Organize questions</li> </ul>"},{"location":"guides/moderator/overview/#common-tasks","title":"Common Tasks","text":""},{"location":"guides/moderator/overview/#answer-question","title":"Answer Question","text":"<ol> <li>Click question</li> <li>Click \"Answer\"</li> <li>Write answer (markdown supported)</li> <li>Click \"Submit Answer\"</li> </ol> <p>See Answering Questions.</p>"},{"location":"guides/moderator/overview/#tag-question","title":"Tag Question","text":"<ol> <li>Click question</li> <li>Click \"Tag\"</li> <li>Select or create tags</li> <li>Save</li> </ol> <p>See Tagging.</p>"},{"location":"guides/moderator/overview/#pin-question","title":"Pin Question","text":"<p>Click pin icon (\ud83d\udccc) to highlight important questions.</p> <p>Pinned questions appear at top of list.</p>"},{"location":"guides/moderator/overview/#freeze-question","title":"Freeze Question","text":"<p>Click freeze icon (\u2744\ufe0f) to lock question.</p> <p>Frozen questions cannot be upvoted or answered (until unfrozen).</p>"},{"location":"guides/moderator/overview/#use-moderation-queue","title":"Use Moderation Queue","text":"<ol> <li>Navigate to team</li> <li>Click \"Moderation Queue\"</li> <li>View all questions with quick actions</li> <li>Filter, sort, and bulk operate</li> </ol> <p>See Moderation Queue.</p>"},{"location":"guides/moderator/overview/#team-scoped-permissions","title":"Team-Scoped Permissions","text":"<p>Moderators can only moderate their assigned teams.</p> <p>Example: If you're moderator for Engineering: - \u2705 Can answer Engineering questions - \u2705 Can tag Engineering questions - \u274c Cannot answer Product questions - \u274c Cannot access Product moderation queue</p> <p>Check your teams: Profile \u2192 Team Memberships</p>"},{"location":"guides/moderator/overview/#moderation-workflow","title":"Moderation Workflow","text":"<p>Typical flow: 1. Review - Check moderation queue for new questions 2. Triage - Tag questions by topic 3. Prioritize - Pin urgent questions 4. Answer - Provide answers 5. Follow-up - Freeze if no further discussion needed</p> <p>Target: Answer questions within 24-48 hours.</p>"},{"location":"guides/moderator/overview/#bulk-operations","title":"Bulk Operations","text":"<p>Select multiple questions to: - Tag all - Pin all - Freeze all - Delete all (use carefully)</p> <p>Access: Moderation Queue \u2192 Select questions \u2192 Bulk Actions</p>"},{"location":"guides/moderator/overview/#presentation-mode","title":"Presentation Mode","text":"<p>Full-screen mode for all-hands meetings:</p> <ol> <li>Navigate to team</li> <li>Click \"Present\"</li> <li>Use keyboard shortcuts to navigate</li> <li>Tag questions live with <code>T</code> key</li> </ol> <p>See Presentation Mode.</p>"},{"location":"guides/moderator/overview/#best-practices","title":"Best Practices","text":"<ol> <li>Answer promptly - Aim for &lt; 48 hour response</li> <li>Be thorough - Answer completely, provide context</li> <li>Tag consistently - Use established tags</li> <li>Pin sparingly - Only truly important questions</li> <li>Freeze when done - Lock resolved questions</li> </ol>"},{"location":"guides/moderator/overview/#moderation-stats","title":"Moderation Stats","text":"<p>Admins can view your activity: - Questions answered - Response time - Tags applied</p> <p>Purpose: Performance tracking and capacity planning.</p> <p>See Admin Guide - Moderation Stats.</p>"},{"location":"guides/moderator/overview/#tips","title":"Tips","text":"<ol> <li>Check queue daily - Stay on top of new questions</li> <li>Use bulk operations - Save time with multiple questions</li> <li>Coordinate with team - Divide workload with other moderators</li> <li>Ask for help - Tag questions for other moderators if needed</li> <li>Use presentation mode - Efficient for all-hands prep</li> </ol>"},{"location":"guides/moderator/overview/#permissions-summary","title":"Permissions Summary","text":"Action Team-Scoped Requires View questions No Member+ Answer questions Yes Moderator+ Tag questions Yes Moderator+ Pin questions Yes Moderator+ Freeze questions Yes Moderator+ Delete questions Yes Moderator+ Bulk operations Yes Moderator+ Presentation mode Yes Moderator+"},{"location":"guides/moderator/overview/#related-documentation","title":"Related Documentation","text":"<ul> <li>Answering Questions</li> <li>Moderation Queue</li> <li>Presentation Mode</li> <li>Tagging</li> <li>Admin Guide - Roles</li> </ul>"},{"location":"guides/moderator/presentation-mode/","title":"Presentation Mode","text":"<p>Full-screen question display for all-hands meetings and town halls.</p>"},{"location":"guides/moderator/presentation-mode/#access-presentation-mode","title":"Access Presentation Mode","text":"<ol> <li>Navigate to your team</li> <li>Click \"Present\" button</li> <li>Full-screen mode activates</li> </ol>"},{"location":"guides/moderator/presentation-mode/#features","title":"Features","text":"<p>Display: - Full-screen question view - Clean, readable layout - Automatic font scaling - Dark mode support</p> <p>Controls: - Keyboard navigation - Live tag filtering - Auto-tagging workflow - Quick answer access</p>"},{"location":"guides/moderator/presentation-mode/#keyboard-shortcuts","title":"Keyboard Shortcuts","text":"<p>Navigation: - <code>\u2192</code> or <code>Space</code> - Next question - <code>\u2190</code> - Previous question - <code>Home</code> - First question - <code>End</code> - Last question - <code>Esc</code> - Exit presentation mode</p> <p>Actions: - <code>T</code> - Tag current question - <code>A</code> - Answer current question - <code>P</code> - Pin current question - <code>F</code> - Freeze current question</p> <p>Filtering: - <code>1-9</code> - Filter by tag number - <code>0</code> - Clear tag filter</p>"},{"location":"guides/moderator/presentation-mode/#tag-filtering","title":"Tag Filtering","text":"<p>Filter by tag during presentation:</p> <ol> <li>Press number key (1-9) for tag</li> <li>View only questions with that tag</li> <li>Press <code>0</code> to clear filter</li> </ol> <p>Use case: \"Show all Benefits questions\"</p>"},{"location":"guides/moderator/presentation-mode/#auto-tagging-workflow","title":"Auto-Tagging Workflow","text":"<p>Efficient tagging during presentation:</p> <ol> <li>View question</li> <li>Press <code>T</code> to tag</li> <li>Select tags</li> <li>Save</li> <li>Automatically advance to next question</li> </ol> <p>Use case: Tag all questions before all-hands.</p>"},{"location":"guides/moderator/presentation-mode/#preparation-workflow","title":"Preparation Workflow","text":"<p>Before meeting: 1. Enter presentation mode 2. Review all questions 3. Use auto-tagging (press <code>T</code>) 4. Tag by topic 5. Pin top 5-10 questions 6. Answer where possible</p> <p>During meeting: 1. Filter by tag as topics arise 2. Read questions aloud 3. Provide answers live 4. Pin follow-ups</p> <p>After meeting: 1. Answer remaining pinned questions 2. Freeze answered questions 3. Follow up on action items</p>"},{"location":"guides/moderator/presentation-mode/#display-settings","title":"Display Settings","text":"<p>Font size: Auto-scales based on question length</p> <p>Theme: Uses your selected theme (dark/light)</p> <p>Layout: Optimized for 16:9 displays</p>"},{"location":"guides/moderator/presentation-mode/#tips","title":"Tips","text":"<ol> <li>Practice - Try presentation mode before meeting</li> <li>Tag in advance - Tag all questions beforehand</li> <li>Pin priorities - Pin top questions to answer live</li> <li>Use filters - Show relevant questions per topic</li> <li>Freeze after - Lock answered questions post-meeting</li> </ol>"},{"location":"guides/moderator/presentation-mode/#projector-setup","title":"Projector Setup","text":"<p>Recommended: - 1080p or higher resolution - Dark mode for better contrast - Test before meeting</p> <p>Shortcuts visible: Brief overlay shows shortcuts on enter.</p>"},{"location":"guides/moderator/presentation-mode/#team-scoped","title":"Team-Scoped","text":"<p>Presentation mode only shows your team's questions.</p> <p>Switch teams before entering presentation mode if needed.</p>"},{"location":"guides/moderator/presentation-mode/#related","title":"Related","text":"<ul> <li>Answering Questions</li> <li>Tagging</li> <li>Moderation Queue</li> <li>handbook/PRODUCT_VISION.md - Presentation mode feature details</li> </ul>"},{"location":"guides/moderator/tagging/","title":"Tagging Questions","text":"<p>Organize questions with tags for easy filtering and categorization.</p>"},{"location":"guides/moderator/tagging/#why-tag","title":"Why Tag","text":"<p>Tags help: - Categorize questions by topic - Filter in search - Track trending topics - Organize presentation mode</p>"},{"location":"guides/moderator/tagging/#tag-a-question","title":"Tag a Question","text":"<ol> <li>Click question</li> <li>Click \"Tag\" button</li> <li>Select existing tags or create new</li> <li>Save</li> </ol> <p>Create new tag: Type name and press Enter.</p>"},{"location":"guides/moderator/tagging/#bulk-tagging","title":"Bulk Tagging","text":"<ol> <li>Moderation Queue \u2192 Select questions</li> <li>Click \"Tag\"</li> <li>Select tags</li> <li>Apply to all</li> </ol>"},{"location":"guides/moderator/tagging/#tag-strategy","title":"Tag Strategy","text":"<p>Common tags: - Benefits - Career - Culture - Policy - Product - Technology</p> <p>Event tags: - All Hands Q4 2025 - Town Hall January</p> <p>Use existing tags when possible to maintain consistency.</p> <p>See Admin Guide - Tag Management for tag best practices.</p>"},{"location":"guides/moderator/tagging/#remove-tags","title":"Remove Tags","text":"<ol> <li>Click question</li> <li>Click tag's \"x\" icon</li> <li>Confirm</li> </ol>"},{"location":"guides/moderator/tagging/#tag-colors","title":"Tag Colors","text":"<p>Admins assign colors to tags for visual distinction.</p>"},{"location":"guides/moderator/tagging/#tips","title":"Tips","text":"<ol> <li>Tag before answering - Organize first</li> <li>Use existing tags - Maintain consistency</li> <li>Avoid duplicates - Check for similar tags</li> <li>Be specific - \"Benefits\" not \"Misc\"</li> <li>Coordinate - Align with other moderators on tag usage</li> </ol>"},{"location":"guides/moderator/tagging/#related","title":"Related","text":"<ul> <li>Admin Guide - Tag Management</li> <li>User Guide - Search</li> </ul>"},{"location":"guides/user/overview/","title":"User Guide","text":"<p>Learn how to use PulseStage to submit questions, upvote, and track answers.</p>"},{"location":"guides/user/overview/#quick-start","title":"Quick Start","text":"<ol> <li>Log in - Use demo mode or OAuth (GitHub/Google)</li> <li>Select team - Choose your team from navigation</li> <li>Browse questions - View open and answered questions</li> <li>Submit question - Click \"Submit Question\"</li> <li>Upvote - Click upvote arrow on important questions</li> </ol>"},{"location":"guides/user/overview/#features","title":"Features","text":""},{"location":"guides/user/overview/#submit-questions","title":"Submit Questions","text":"<p>Submit Questions Guide</p> <ul> <li>Anonymous or named submission</li> <li>Assign to team</li> <li>Real-time submission</li> </ul>"},{"location":"guides/user/overview/#upvote-questions","title":"Upvote Questions","text":"<p>Upvoting Guide</p> <ul> <li>Signal important questions</li> <li>Cannot upvote own questions</li> <li>See total upvote count</li> </ul>"},{"location":"guides/user/overview/#search-browse","title":"Search &amp; Browse","text":"<p>Search &amp; Browse Guide</p> <ul> <li>Full-text search</li> <li>Filter by tags, status, date</li> <li>Team filtering</li> </ul>"},{"location":"guides/user/overview/#team-switching","title":"Team Switching","text":"<p>Teams Guide</p> <ul> <li>Switch between teams</li> <li>See question counts per team</li> <li>Set primary team</li> </ul>"},{"location":"guides/user/overview/#profile","title":"Profile","text":"<p>Profile Guide</p> <ul> <li>Manage your information</li> <li>Set primary team</li> <li>View your activity</li> </ul>"},{"location":"guides/user/overview/#roles","title":"Roles","text":"<p>Your role determines what you can do:</p> <p>Viewer: - Browse questions - Upvote questions - View answers</p> <p>Member: (default) - All Viewer permissions - Submit questions - Respond to pulse surveys</p> <p>Moderator: - All Member permissions - Answer questions (your teams) - Tag, pin, freeze questions - Access moderation queue</p> <p>See Admin Guide - Roles for complete role details.</p>"},{"location":"guides/user/overview/#common-tasks","title":"Common Tasks","text":""},{"location":"guides/user/overview/#submit-anonymous-question","title":"Submit Anonymous Question","text":"<ol> <li>Click \"Submit Question\"</li> <li>Enter question text</li> <li>Select team</li> <li>Leave \"Submit anonymously\" checked</li> <li>Click \"Submit\"</li> </ol>"},{"location":"guides/user/overview/#find-answered-questions","title":"Find Answered Questions","text":"<ol> <li>Click \"Answered\" tab</li> <li>Or search with status filter: \"Answered\"</li> </ol>"},{"location":"guides/user/overview/#search-by-tag","title":"Search by Tag","text":"<ol> <li>Use search bar</li> <li>Click tag or type <code>tag:benefits</code></li> <li>View filtered results</li> </ol>"},{"location":"guides/user/overview/#change-teams","title":"Change Teams","text":"<p>Click team name in navigation and select different team.</p>"},{"location":"guides/user/overview/#tips","title":"Tips","text":"<ol> <li>Be specific - Clear questions get better answers</li> <li>Check existing - Search before submitting duplicates</li> <li>Upvote strategically - Highlight truly important questions</li> <li>Use tags - Filter by topic when searching</li> <li>Check back - Questions typically answered within 24-48 hours</li> </ol>"},{"location":"guides/user/overview/#getting-help","title":"Getting Help","text":"<ul> <li>Questions about features: Submit question to \"General\" team</li> <li>Technical issues: See Troubleshooting</li> <li>Contact admin: Use contact information provided by your organization</li> </ul>"},{"location":"guides/user/overview/#related-documentation","title":"Related Documentation","text":"<ul> <li>Submitting Questions</li> <li>Upvoting</li> <li>Search &amp; Browse</li> <li>Teams</li> <li>Profile</li> </ul>"},{"location":"guides/user/profile/","title":"Profile","text":"<p>Manage your user profile and settings.</p>"},{"location":"guides/user/profile/#access-profile","title":"Access Profile","text":"<p>Click profile icon \u2192 \"Profile\"</p>"},{"location":"guides/user/profile/#profile-information","title":"Profile Information","text":"<p>View: - Name - Email - Primary team - Role (viewer, member, moderator, admin, owner) - Team memberships</p> <p>Edit: - Primary team - Display preferences</p> <p>Cannot edit: - Name (synced from OAuth) - Email (synced from OAuth) - Role (set by admin) - Team memberships (set by admin)</p>"},{"location":"guides/user/profile/#primary-team","title":"Primary Team","text":"<p>Your primary team determines: - Default team view on login - Pulse cohort assignment - Team shown in profile</p> <p>Change primary team: 1. Profile \u2192 \"Primary Team\" 2. Select from dropdown 3. Save</p> <p>Must: Be a member of the team you select.</p>"},{"location":"guides/user/profile/#display-preferences","title":"Display Preferences","text":""},{"location":"guides/user/profile/#theme","title":"Theme","text":"<p>Choose theme: - Refined Teal (default) - Professional Blue - Modern Purple</p>"},{"location":"guides/user/profile/#dark-mode","title":"Dark Mode","text":"<p>Toggle dark mode on/off.</p> <p>Auto-detect: Uses system preference if not set.</p>"},{"location":"guides/user/profile/#activity","title":"Activity","text":"<p>View your activity: - Questions submitted - Questions upvoted - Pulse responses (count only, anonymous)</p> <p>Privacy: Others cannot see your activity.</p>"},{"location":"guides/user/profile/#email-notifications","title":"Email Notifications","text":"<p>Configure email preferences: - Pulse invitations - Question answers (for your questions) - Team announcements</p> <p>Default: Pulse invitations enabled.</p>"},{"location":"guides/user/profile/#oauth-connections","title":"OAuth Connections","text":"<p>View connected OAuth providers: - GitHub - Google</p> <p>Disconnect: Contact admin to disconnect OAuth.</p>"},{"location":"guides/user/profile/#privacy","title":"Privacy","text":""},{"location":"guides/user/profile/#whats-public","title":"What's Public","text":"<ul> <li>Name (if you submit named questions)</li> <li>Role (to other users)</li> <li>Team memberships</li> </ul>"},{"location":"guides/user/profile/#whats-private","title":"What's Private","text":"<ul> <li>Email (only admins can see)</li> <li>Question upvotes</li> <li>Pulse responses (always anonymous)</li> <li>Activity history</li> </ul>"},{"location":"guides/user/profile/#account-actions","title":"Account Actions","text":""},{"location":"guides/user/profile/#log-out","title":"Log Out","text":"<p>Click profile icon \u2192 \"Log Out\"</p>"},{"location":"guides/user/profile/#change-role","title":"Change Role","text":"<p>Contact admin to request role change.</p>"},{"location":"guides/user/profile/#leave-team","title":"Leave Team","text":"<p>Contact admin to be removed from team.</p>"},{"location":"guides/user/profile/#delete-account","title":"Delete Account","text":"<p>Contact admin to delete your account.</p> <p>Data retention: - Anonymous questions remain (no attribution) - Named questions remain but anonymized - Pulse responses remain (no user link) - Upvotes removed</p>"},{"location":"guides/user/profile/#troubleshooting","title":"Troubleshooting","text":""},{"location":"guides/user/profile/#cannot-change-primary-team","title":"Cannot Change Primary Team","text":"<p>Reasons: - Not a member of selected team - Team no longer exists</p> <p>Solution: Contact admin.</p>"},{"location":"guides/user/profile/#profile-not-updating","title":"Profile Not Updating","text":"<p>Try: - Refresh page - Clear cache - Log out and back in</p>"},{"location":"guides/user/profile/#oauth-info-outdated","title":"OAuth Info Outdated","text":"<p>Profile syncs with OAuth provider on login. Log out and back in to refresh.</p>"},{"location":"guides/user/profile/#related","title":"Related","text":"<ul> <li>Teams - Team structure</li> <li>Admin Guide - For role/team changes</li> </ul>"},{"location":"guides/user/search-browse/","title":"Search &amp; Browse","text":"<p>Find questions and answers using search and filters.</p>"},{"location":"guides/user/search-browse/#search","title":"Search","text":"<p>Type in the search box to find questions.</p> <p>Searches: - Question text - Answer text - Tags</p> <p>Features: - Full-text search - Prefix matching (e.g., \"comp\" finds \"compensation\") - Debounced (waits for you to stop typing) - Real-time results</p>"},{"location":"guides/user/search-browse/#filters","title":"Filters","text":""},{"location":"guides/user/search-browse/#by-status","title":"By Status","text":"<ul> <li>Open - Unanswered questions</li> <li>Answered - Questions with answers</li> <li>All - Both open and answered</li> </ul>"},{"location":"guides/user/search-browse/#by-team","title":"By Team","text":"<p>Select team from navigation to filter by team.</p> <p>Or use \"All Teams\" to see organization-wide questions (admins/owners only).</p>"},{"location":"guides/user/search-browse/#by-tag","title":"By Tag","text":"<p>Click a tag or search <code>tag:benefits</code> to filter by tag.</p> <p>Multiple tags: Use multiple tag filters to narrow results.</p>"},{"location":"guides/user/search-browse/#by-date","title":"By Date","text":"<p>Select date range: - Last 7 days - Last 30 days - Last 90 days - All time - Custom range</p>"},{"location":"guides/user/search-browse/#sorting","title":"Sorting","text":"<p>Sort results by: - Upvotes (default) - Most upvoted first - Recent - Newest first - Oldest - Oldest first</p>"},{"location":"guides/user/search-browse/#advanced-search","title":"Advanced Search","text":""},{"location":"guides/user/search-browse/#tag-search","title":"Tag Search","text":"<pre><code>tag:benefits\n</code></pre>"},{"location":"guides/user/search-browse/#multiple-terms","title":"Multiple Terms","text":"<pre><code>remote work policy\n</code></pre> <p>Finds questions containing all terms.</p>"},{"location":"guides/user/search-browse/#exact-phrases","title":"Exact Phrases","text":"<p>Not currently supported. Search finds questions containing all words.</p>"},{"location":"guides/user/search-browse/#browse-by-team","title":"Browse by Team","text":"<ol> <li>Click team name in navigation</li> <li>View team's questions</li> <li>Switch teams as needed</li> </ol> <p>Each team shows: - Question count (open/answered) - Team-specific questions only - Team moderators' answers</p>"},{"location":"guides/user/search-browse/#view-question-details","title":"View Question Details","text":"<p>Click any question to see: - Full question text - Upvote count - Tags - Answer (if answered) - Answer author - Dates (submitted, answered)</p>"},{"location":"guides/user/search-browse/#tips","title":"Tips","text":"<ol> <li>Search before submitting - Avoid duplicates</li> <li>Use tags - Filter by topic quickly</li> <li>Try variants - \"compensation\", \"pay\", \"salary\" may yield different results</li> <li>Check date range - Expand if not finding results</li> <li>Browse teams - Question might be in different team</li> </ol>"},{"location":"guides/user/search-browse/#keyboard-shortcuts","title":"Keyboard Shortcuts","text":"<ul> <li><code>/</code> - Focus search box</li> <li><code>Esc</code> - Clear search</li> </ul>"},{"location":"guides/user/search-browse/#search-performance","title":"Search Performance","text":"<p>Full-text search uses PostgreSQL GIN indexes for fast results.</p> <p>Performance: - &lt; 100ms for most searches - Searches entire question and answer text - Case-insensitive</p>"},{"location":"guides/user/search-browse/#no-results","title":"No Results?","text":"<p>Try: 1. Remove filters 2. Expand date range 3. Check different team 4. Try synonyms or broader terms 5. Browse without search</p>"},{"location":"guides/user/search-browse/#related","title":"Related","text":"<ul> <li>Submitting Questions - Ask new question</li> <li>Upvoting - Vote on results</li> <li>Teams - Team structure</li> </ul>"},{"location":"guides/user/submitting-questions/","title":"Submitting Questions","text":"<p>Submit questions for your team's Q&amp;A sessions.</p>"},{"location":"guides/user/submitting-questions/#submit-a-question","title":"Submit a Question","text":"<ol> <li>Click \"Submit Question\" button</li> <li>Enter your question</li> <li>Select team</li> <li>Choose anonymous or named</li> <li>Click \"Submit\"</li> </ol>"},{"location":"guides/user/submitting-questions/#anonymous-vs-named","title":"Anonymous vs. Named","text":"<p>Anonymous (default): - Your name is hidden - Encourages honest questions - Cannot be traced to you</p> <p>Named: - Your name is shown - Useful for follow-up questions - Shows accountability</p> <p>Tip: Most questions are submitted anonymously.</p>"},{"location":"guides/user/submitting-questions/#team-selection","title":"Team Selection","text":"<p>Questions are team-specific: - Select the relevant team (Engineering, Product, etc.) - Question appears only in that team's view - Team moderators will answer</p> <p>Default: Your primary team is pre-selected.</p>"},{"location":"guides/user/submitting-questions/#question-guidelines","title":"Question Guidelines","text":"<p>Good questions: - Specific and clear - Relevant to team - Appropriate for public forum</p> <p>Examples: - \"What are our plans for remote work policy?\" - \"How will the new product launch affect our roadmap?\" - \"Can we get an update on the hiring timeline?\"</p> <p>Avoid: - Personal HR issues (use HR directly) - Confidential information - Attacks or inappropriate content</p>"},{"location":"guides/user/submitting-questions/#after-submission","title":"After Submission","text":"<p>Your question: - Appears in team's \"Open\" tab - Can be upvoted by others - Will be answered by moderators - May be tagged for organization</p> <p>Timeline: Questions typically answered within 24-48 hours.</p>"},{"location":"guides/user/submitting-questions/#edit-or-delete","title":"Edit or Delete","text":"<p>Cannot edit after submission (prevents confusion with upvotes).</p> <p>To change: 1. Delete question (if allowed) 2. Submit new version</p> <p>Or: Wait for moderator to answer and clarify in follow-up.</p>"},{"location":"guides/user/submitting-questions/#content-moderation","title":"Content Moderation","text":"<p>Questions are automatically screened for: - Profanity - Toxic language - Spam patterns</p> <p>Flagged questions go to review queue. You'll be notified if question is rejected.</p> <p>See handbook/TRUST_AND_SAFETY.md.</p>"},{"location":"guides/user/submitting-questions/#tips","title":"Tips","text":"<ol> <li>Search first - Check if question already asked</li> <li>Be specific - \"When will X launch?\" vs. \"What's the status?\"</li> <li>One topic - Ask separate questions for separate topics</li> <li>Context helps - Briefly explain why you're asking</li> <li>Team matters - Submit to most relevant team</li> </ol>"},{"location":"guides/user/submitting-questions/#related","title":"Related","text":"<ul> <li>Upvoting - Vote on other questions</li> <li>Search &amp; Browse - Find existing answers</li> <li>Teams - Understand team structure</li> </ul>"},{"location":"guides/user/teams/","title":"Teams","text":"<p>Understand team organization and how to switch teams.</p>"},{"location":"guides/user/teams/#team-structure","title":"Team Structure","text":"<p>Questions and pulse data are organized by team: - Engineering - Product - Marketing - General - (etc.)</p> <p>Each team has: - Team-specific questions - Team-specific pulse data - Team-specific moderators - Team-specific permissions</p>"},{"location":"guides/user/teams/#switch-teams","title":"Switch Teams","text":"<p>Click team name in navigation and select different team.</p> <p>What changes: - Questions shown (team-filtered) - Submit question defaults to that team - Pulse dashboard shows team data</p>"},{"location":"guides/user/teams/#your-primary-team","title":"Your Primary Team","text":"<p>Your primary team is your default: - Set by admin during onboarding - Determines initial view on login - Used for pulse cohort assignment - Shown in your profile</p> <p>Change primary team: 1. Click profile icon 2. Select \"Profile\" 3. Choose \"Primary Team\" 4. Save</p>"},{"location":"guides/user/teams/#team-memberships","title":"Team Memberships","text":"<p>You can be member of multiple teams: - View questions in all your teams - Submit questions to any team - Different roles per team possible</p> <p>Example: - Engineering: Member - Product: Viewer - General: Member</p>"},{"location":"guides/user/teams/#all-teams-view","title":"All Teams View","text":"<p>Admins and owners can view \"All Teams\": - Organization-wide question view - Aggregated pulse data - Useful for leadership</p> <p>Access: Click \"All Teams\" in navigation (if available).</p>"},{"location":"guides/user/teams/#team-question-counts","title":"Team Question Counts","text":"<p>Navigation shows question counts per team: - Open questions (number in badge) - Helps identify active teams - Real-time updates</p>"},{"location":"guides/user/teams/#team-urls","title":"Team URLs","text":"<p>Each team has a shareable URL: - <code>/engineering/open</code> - Engineering open questions - <code>/product/answered</code> - Product answered questions - <code>/general/all</code> - General all questions</p> <p>Use for: - Bookmarks - Sharing specific views - Deep linking</p>"},{"location":"guides/user/teams/#team-creation","title":"Team Creation","text":"<p>Only admins can create teams.</p> <p>Request new team: 1. Submit question to \"General\" 2. Tag with \"Feature Request\" 3. Admin will review</p>"},{"location":"guides/user/teams/#team-permissions","title":"Team Permissions","text":"<p>Permissions are team-scoped:</p> <p>Moderators: - Can only moderate their assigned teams - Cannot access other teams' moderation features</p> <p>Members: - Can view and participate in all teams - Can submit questions to any team</p> <p>Admins/Owners: - Full access to all teams - Can manage all teams' content</p> <p>See Admin Guide - Roles.</p>"},{"location":"guides/user/teams/#tips","title":"Tips","text":"<ol> <li>Submit to right team - Choose team most relevant to question</li> <li>Check multiple teams - Answer might be in related team</li> <li>Set primary team - Makes your default view most useful</li> <li>Use All Teams - (if admin) for org-wide view</li> </ol>"},{"location":"guides/user/teams/#related","title":"Related","text":"<ul> <li>Submitting Questions - Choose team when submitting</li> <li>Search &amp; Browse - Filter by team</li> <li>Profile - Set primary team</li> </ul>"},{"location":"guides/user/upvoting/","title":"Upvoting Questions","text":"<p>Upvote questions to signal importance and priority.</p>"},{"location":"guides/user/upvoting/#how-to-upvote","title":"How to Upvote","text":"<p>Click the upvote arrow (\u25b2) next to any question.</p> <p>Visual feedback: - Hollow triangle = not upvoted - Filled triangle = you upvoted - Number shows total upvotes</p>"},{"location":"guides/user/upvoting/#why-upvote","title":"Why Upvote","text":"<p>Upvoting helps: - Prioritize: Moderators see most important questions - Surface trends: Popular topics become visible - Save time: Avoid duplicate questions - Influence: Shape what gets answered first</p>"},{"location":"guides/user/upvoting/#rules","title":"Rules","text":"<p>Cannot upvote: - Your own questions - Same question twice (one vote per question)</p> <p>Can upvote: - Anonymous questions - Answered questions - Questions in any team</p>"},{"location":"guides/user/upvoting/#upvote-strategy","title":"Upvote Strategy","text":"<p>Upvote when: - Question affects you directly - Topic is time-sensitive - Answer would help many people - Question is well-articulated</p> <p>Don't upvote: - Just to be nice - Questions you don't care about - Duplicate questions (upvote original instead)</p>"},{"location":"guides/user/upvoting/#sorting","title":"Sorting","text":"<p>Questions are sorted by upvotes (highest first) by default.</p> <p>This means: - Most upvoted questions appear at top - Moderators see high-priority questions first - Community drives the agenda</p>"},{"location":"guides/user/upvoting/#remove-upvote","title":"Remove Upvote","text":"<p>Click upvote arrow again to remove your vote.</p> <p>Upvote count decreases by 1.</p>"},{"location":"guides/user/upvoting/#upvote-counts","title":"Upvote Counts","text":"<p>Typical ranges: - 1-3 upvotes: Individual interest - 4-10 upvotes: Team concern - 10+ upvotes: High priority topic</p> <p>Note: Counts depend on team size.</p>"},{"location":"guides/user/upvoting/#real-time-updates","title":"Real-Time Updates","text":"<p>Upvote counts update in real-time: - See others' upvotes immediately - No page refresh needed - Server-Sent Events (SSE) powered</p>"},{"location":"guides/user/upvoting/#privacy","title":"Privacy","text":"<p>Upvotes are private: - Others cannot see who upvoted - Only total count is visible - Maintains voting independence</p> <p>Tracked for: - Preventing double-voting - Audit purposes</p>"},{"location":"guides/user/upvoting/#tips","title":"Tips","text":"<ol> <li>Upvote liberally - Help prioritize what matters</li> <li>Check existing - Upvote existing question vs. submitting duplicate</li> <li>Revisit - Upvote new questions as they appear</li> <li>Team scope - Upvotes are team-specific</li> </ol>"},{"location":"guides/user/upvoting/#related","title":"Related","text":"<ul> <li>Submitting Questions - Ask questions</li> <li>Search &amp; Browse - Find questions</li> </ul>"},{"location":"handbook/","title":"PulseStage Handbook","text":"<p>This handbook is the source of truth for product vision, architecture decisions, and operational contracts. It guides both human developers and AI assistants working on PulseStage.</p>"},{"location":"handbook/#purpose","title":"Purpose","text":"<p>The handbook ensures: 1. Consistency - All code aligns with documented architecture 2. Clarity - Decisions are documented with context (ADRs) 3. Contracts - APIs, events, and UX are stable and predictable 4. Onboarding - New contributors understand \"why\" and \"how\"</p>"},{"location":"handbook/#structure","title":"Structure","text":""},{"location":"handbook/#core-documents","title":"Core Documents","text":"<ul> <li>PRODUCT_VISION.md - 1-page problem/solution/principles</li> <li>PERSONAS.md - 4 key user types and their needs</li> <li>USE-CASES.md - Critical user flows with success metrics</li> <li>DATA_MODEL_SNAPSHOT.md - Entity relationships, invariants, and schema reference</li> <li>TENANCY_MODEL.md - Multi-tenant isolation rules (absolute)</li> <li>SECURITY_MODEL.md - Auth, roles, anonymity, audit</li> </ul>"},{"location":"handbook/#technical-contracts","title":"Technical Contracts","text":"<ul> <li>API_CONTRACTS/ - OpenAPI spec, SSE events, versioning</li> <li>UX_CONTRACTS.md - Key screens, states, URLs, accessibility</li> <li>NONFUNCTIONAL.md - SLOs, rate limits, retention policies</li> <li>TEST_STRATEGY.md - Coverage targets, test types</li> </ul>"},{"location":"handbook/#operations","title":"Operations","text":"<ul> <li>OPERATIONS.md - Runbook, probes, backups, dev environment</li> <li>RELEASE_CHECKLIST.md - Pre-deployment validation</li> </ul>"},{"location":"handbook/#decisions","title":"Decisions","text":"<ul> <li>DECISIONS/ - Architecture Decision Records (ADRs)</li> <li>ADR-0001: Subdomain-per-tenant routing</li> <li>ADR-0002: SSE for realtime (not WebSockets)</li> <li>ADR-0003: Fixed role model (admin/moderator/participant)</li> </ul>"},{"location":"handbook/#key-principles","title":"Key Principles","text":""},{"location":"handbook/#1-team-first-architecture","title":"1. Team-First Architecture","text":"<p>PulseStage is team-first with organizational rollups: - Users have a <code>primaryTeamId</code> - Pulse surveys and Q&amp;A are team-scoped - \"All Teams\" views aggregate across teams - Moderators have team-scoped access</p>"},{"location":"handbook/#2-tenant-isolation-absolute","title":"2. Tenant Isolation (Absolute)","text":"<ul> <li>Every entity has <code>tenantId</code></li> <li>ALL queries filter by <code>tenantId</code></li> <li>No cross-tenant joins or searches</li> <li>Migrations preserve isolation</li> </ul>"},{"location":"handbook/#3-anonymity-by-default","title":"3. Anonymity by Default","text":"<ul> <li>Pulse responses have NO <code>userId</code> field</li> <li>Q&amp;A questions are anonymous</li> <li>Aggregates only shown when <code>n &gt;= threshold</code></li> </ul>"},{"location":"handbook/#4-contracts-code","title":"4. Contracts &gt; Code","text":"<ul> <li>OpenAPI spec is canonical for API</li> <li>Event schemas are versioned (semver)</li> <li>Database invariants are enforced</li> <li>UX contracts define URLs and states</li> </ul>"},{"location":"handbook/#alignment-with-cursorrules","title":"Alignment with .cursorrules","text":"<p>The handbook defines what and why. The <code>.cursorrules</code> file defines how to develop: - Handbook: \"Tenant isolation is absolute\" - Rules: \"Run <code>make preflight</code> before user testing\"</p> <p>Both must stay in sync. Conflicts should be resolved by discussing with the project maintainer.</p>"},{"location":"handbook/#usage-guidelines","title":"Usage Guidelines","text":""},{"location":"handbook/#for-human-developers","title":"For Human Developers","text":"<ol> <li>Read PRODUCT_VISION and PERSONAS first</li> <li>Check DATA_MODEL_SNAPSHOT before schema changes</li> <li>Review ADRs when making architectural decisions</li> <li>Update handbook when adding features</li> </ol>"},{"location":"handbook/#for-ai-assistants","title":"For AI Assistants","text":"<ol> <li>Reference handbook for intent and constraints</li> <li>Follow .cursorrules for development workflow</li> <li>Propose handbook updates when finding inconsistencies</li> <li>Ask user to resolve conflicts between handbook and code</li> </ol>"},{"location":"handbook/#when-code-diverges-from-handbook","title":"When Code Diverges from Handbook","text":"<ol> <li>Determine which is correct (usually code wins for current state)</li> <li>Update handbook to reflect reality</li> <li>Document the change in relevant ADR or commit message</li> <li>Notify maintainer if it represents an architectural shift</li> </ol>"},{"location":"handbook/#maintenance","title":"Maintenance","text":"<ul> <li>Update frequency: With every significant feature or architectural change</li> <li>Owner: Project maintainer approves all handbook changes</li> <li>Format: Markdown, concise, no fluff</li> <li>Versioning: Track in git alongside code</li> </ul>"},{"location":"handbook/#quick-reference","title":"Quick Reference","text":"<ul> <li>Full API docs: <code>/api/openapi.yaml</code> (served at <code>GET /docs</code> in dev)</li> <li>Database schema: <code>/api/prisma/schema.prisma</code></li> <li>SSE implementation: <code>/api/src/lib/eventBus.ts</code></li> <li>Development rules: <code>/.cursorrules</code></li> <li>Architecture docs: <code>/docs/architecture/</code></li> </ul>"},{"location":"handbook/ADMIN_GUIDE/","title":"Administrator Guide","text":"<p>Audience: Administrators and owners managing PulseStage deployments.</p> <p>Prerequisites: <code>admin.access</code> permission (admin or owner role).</p>"},{"location":"handbook/ADMIN_GUIDE/#admin-panel-access","title":"Admin Panel Access","text":"<p>URL: <code>/admin</code> (relative to your deployment)</p> <p>Permission Required: <code>admin.access</code></p> <p>Roles with Access: - Admin: Full admin panel access - Owner: Full admin panel access - Moderator: Limited access (moderation queue only)</p>"},{"location":"handbook/ADMIN_GUIDE/#tenant-settings-management","title":"Tenant Settings Management","text":"<p>Endpoint: <code>GET/POST /admin/tenant-settings</code></p>"},{"location":"handbook/ADMIN_GUIDE/#settings-structure","title":"Settings Structure","text":""},{"location":"handbook/ADMIN_GUIDE/#1-questions-configuration","title":"1. Questions Configuration","text":"<pre><code>questions: {\n  minLength: 10,     // Minimum question length (characters)\n  maxLength: 2000    // Maximum question length (characters)\n}\n</code></pre> <p>Use Cases: - Prevent spam (too short) - Prevent essays (too long) - Encourage concise questions</p>"},{"location":"handbook/ADMIN_GUIDE/#2-users-configuration","title":"2. Users Configuration","text":"<pre><code>users: {\n  defaultRole: 'member'  // 'viewer' | 'member' | 'moderator' | 'admin' | 'owner'\n}\n</code></pre> <p>Use Cases: - Set default role for new OAuth users - Restrict new users to viewer-only - Auto-promote to member</p>"},{"location":"handbook/ADMIN_GUIDE/#3-security-configuration","title":"3. Security Configuration","text":"<pre><code>security: {\n  sessionTimeout: 8,          // Hours (user sessions)\n  adminSessionTimeout: 8,     // Hours (admin sessions)\n  rateLimits: {\n    questionsPerHour: 10,     // Max questions user can submit\n    upvotesPerMinute: 20,     // Max upvotes per minute\n    responsesPerHour: 5,      // Max answers per hour\n    searchPerMinute: 30       // Max searches per minute\n  }\n}\n</code></pre> <p>Use Cases: - Increase timeout for trusted environments - Tighten rate limits if abuse detected - Balance UX vs security</p>"},{"location":"handbook/ADMIN_GUIDE/#4-branding-configuration","title":"4. Branding Configuration","text":"<pre><code>branding: {\n  theme: 'refined-teal',         // 'executive-blue' | 'modern-purple' | 'refined-teal'\n  primaryColor: '#14B8A6',       // Override theme primary (optional)\n  accentColor: '#FB923C',        // Override theme accent (optional)\n  logoUrl: 'https://...',        // Custom logo URL\n  faviconUrl: 'https://...'      // Custom favicon URL\n}\n</code></pre> <p>Use Cases: - White-label deployment - Match company branding - A/B test themes</p> <p>See: <code>/handbook/INTEGRATIONS/THEMES.md</code> (to be created) for theme details</p>"},{"location":"handbook/ADMIN_GUIDE/#5-features-configuration","title":"5. Features Configuration","text":"<pre><code>features: {\n  allowAnonymousQuestions: true,      // Let users submit without login\n  requireQuestionApproval: false,     // All questions go to moderation queue\n  enableEmailNotifications: false     // Send email notifications\n}\n</code></pre> <p>Use Cases: - Disable anonymous for sensitive topics - Enable approval for new deployments - Turn on notifications when email configured</p>"},{"location":"handbook/ADMIN_GUIDE/#6-pulse-configuration","title":"6. Pulse Configuration","text":"<pre><code>pulse: {\n  enabled: false,               // Feature flag\n  anonThreshold: 5,             // Min responses to show aggregates\n  defaultCadence: 'weekly',     // 'weekly' | 'biweekly' | 'monthly'\n  defaultTime: '09:00',         // HH:mm format\n  rotatingCohorts: true,        // Enable cohort rotation\n  channelSlack: false,          // Slack DM delivery (future)\n  channelEmail: true            // Email delivery\n}\n</code></pre> <p>See: <code>/handbook/PULSE_SYSTEM.md</code> for full pulse documentation</p>"},{"location":"handbook/ADMIN_GUIDE/#email-queue-monitoring","title":"Email Queue Monitoring","text":"<p>Endpoint: <code>GET /admin/email-queue</code></p> <p>Permission: <code>admin.access</code></p>"},{"location":"handbook/ADMIN_GUIDE/#queue-metrics","title":"Queue Metrics","text":"<pre><code>{\n  \"metrics\": {\n    \"active\": 2,        // Currently processing\n    \"waiting\": 15,      // Queued\n    \"completed\": 342,   // Successfully sent\n    \"failed\": 3         // Failed (check errors)\n  }\n}\n</code></pre>"},{"location":"handbook/ADMIN_GUIDE/#recent-jobs","title":"Recent Jobs","text":"<p>Active Jobs: - Currently being processed - Shows attempt number</p> <p>Waiting Jobs: - Queued for processing - Shows timestamp queued</p> <p>Completed Jobs: - Last 20 successful sends - Shows completion timestamp - Includes message ID (for tracking)</p> <p>Failed Jobs: - Last 20 failures - Critical: Shows failure reason - Shows number of attempts</p>"},{"location":"handbook/ADMIN_GUIDE/#common-failure-reasons","title":"Common Failure Reasons","text":"Error Cause Fix <code>SMTP connection timeout</code> Network/firewall issue Check SMTP host accessibility <code>Authentication failed</code> Invalid credentials Verify SMTP_USER/SMTP_PASS <code>Invalid API key</code> Resend key wrong Check RESEND_API_KEY <code>Recipient rejected</code> Invalid email address Clean up user email data <code>Rate limit exceeded</code> Too many emails Slow down sending or upgrade plan"},{"location":"handbook/ADMIN_GUIDE/#troubleshooting","title":"Troubleshooting","text":"<p>No emails sending: 1. Check Redis connection (required for queue) 2. Check email worker started (logs: \"Email worker started\") 3. Check provider credentials 4. Review failed jobs for errors</p> <p>Emails stuck in queue: 1. Check <code>waiting</code> count 2. Verify worker is processing (check <code>active</code>) 3. Restart email worker if stuck</p>"},{"location":"handbook/ADMIN_GUIDE/#moderation-queue","title":"Moderation Queue","text":"<p>Endpoint: <code>/moderation/queue</code> (frontend)</p> <p>API: <code>GET /questions?status=UNDER_REVIEW</code></p> <p>Permission: <code>question.answer</code> (moderators+)</p>"},{"location":"handbook/ADMIN_GUIDE/#queue-contents","title":"Queue Contents","text":"<p>Questions flagged by content moderation system: - Medium/low confidence violations - User-reported content (future) - Manual review requests (future)</p>"},{"location":"handbook/ADMIN_GUIDE/#moderation-actions","title":"Moderation Actions","text":"<p>Approve: - Changes status from <code>UNDER_REVIEW</code> \u2192 <code>OPEN</code> - Question becomes visible to all users - Audit log created</p> <p>Reject: - Deletes question - User notified (future) - Audit log created</p> <p>Edit &amp; Approve: - Moderator fixes minor issues (typos, formatting) - Then approves - Original content preserved in audit log</p>"},{"location":"handbook/ADMIN_GUIDE/#team-scoping","title":"Team Scoping","text":"<p>Moderators: See questions from their teams only</p> <p>Admins: See questions from all teams in tenant</p> <p>Example: - Moderator on Engineering team \u2192 Only sees Engineering questions - Admin \u2192 Sees all questions across all teams</p>"},{"location":"handbook/ADMIN_GUIDE/#audit-logs","title":"Audit Logs","text":"<p>Endpoint: <code>GET /admin/audit-logs</code></p> <p>Permission: <code>audit.view</code> (admin or owner only)</p>"},{"location":"handbook/ADMIN_GUIDE/#query-parameters","title":"Query Parameters","text":"<pre><code>?userId=&lt;uuid&gt;         Filter by user\n?action=&lt;string&gt;       Filter by action type\n?entityType=&lt;string&gt;   Filter by entity (question, answer, user, etc.)\n?entityId=&lt;uuid&gt;       Filter by specific entity\n?startDate=&lt;ISO date&gt;  Filter by date range (start)\n?endDate=&lt;ISO date&gt;    Filter by date range (end)\n?limit=50              Results per page\n?offset=0              Pagination offset\n</code></pre>"},{"location":"handbook/ADMIN_GUIDE/#logged-actions","title":"Logged Actions","text":"<p>Questions: - <code>question.create</code> - <code>question.update</code> - <code>question.delete</code> - <code>question.answer</code> - <code>question.pin</code> - <code>question.freeze</code> - <code>question.moderation.flagged</code> - <code>question.auto_reject</code> - <code>question.approve</code> - <code>question.reject</code></p> <p>Upvotes: - <code>upvote.add</code> - <code>upvote.remove</code></p> <p>Tags: - <code>tag.create</code> - <code>tag.add</code> - <code>tag.remove</code> - <code>tag.delete</code></p> <p>Users: - <code>user.create</code> - <code>user.update</code> - <code>user.delete</code> - <code>user.login</code> - <code>user.logout</code></p> <p>Teams: - <code>team.create</code> - <code>team.update</code> - <code>team.delete</code> - <code>team_member.add</code> - <code>team_member.remove</code> - <code>team_member.role_change</code></p> <p>Settings: - <code>settings.update</code></p>"},{"location":"handbook/ADMIN_GUIDE/#audit-log-entry","title":"Audit Log Entry","text":"<pre><code>{\n  \"id\": \"uuid\",\n  \"tenantId\": \"uuid\",\n  \"userId\": \"uuid\",\n  \"action\": \"question.moderation.flagged\",\n  \"entityType\": \"question\",\n  \"entityId\": \"uuid\",\n  \"before\": { ... },        // State before change\n  \"after\": { ... },         // State after change\n  \"ipAddress\": \"192.168.1.1\",\n  \"userAgent\": \"Mozilla/5.0 ...\",\n  \"metadata\": {             // Additional context\n    \"reasons\": [\"profanity\"],\n    \"confidence\": \"high\",\n    \"providers\": [\"local\", \"openai\"]\n  },\n  \"createdAt\": \"2025-01-15T14:23:45Z\"\n}\n</code></pre>"},{"location":"handbook/ADMIN_GUIDE/#use-cases","title":"Use Cases","text":"<p>Security Investigation: <pre><code>GET /admin/audit-logs?action=user.login&amp;startDate=2025-01-01\n</code></pre></p> <p>Change Tracking: <pre><code>GET /admin/audit-logs?entityType=settings&amp;action=settings.update\n</code></pre></p> <p>User Activity: <pre><code>GET /admin/audit-logs?userId=&lt;uuid&gt;&amp;limit=100\n</code></pre></p> <p>Moderation Review: <pre><code>GET /admin/audit-logs?action=question.moderation.flagged\n</code></pre></p>"},{"location":"handbook/ADMIN_GUIDE/#data-export","title":"Data Export","text":"<p>Permission: <code>data.export</code> (admin or owner only)</p> <p>Status: Partially implemented</p>"},{"location":"handbook/ADMIN_GUIDE/#planned-export-types","title":"Planned Export Types","text":"<ol> <li>Questions Export</li> <li>All questions (open + answered)</li> <li>CSV or JSON format</li> <li> <p>Includes: body, status, upvotes, responses, timestamps</p> </li> <li> <p>Pulse Data Export</p> </li> <li>Aggregate pulse responses</li> <li>Never includes individual responses (anonymity)</li> <li>CSV or JSON format</li> <li> <p>Includes: question, team, average score, response count, date range</p> </li> <li> <p>Audit Logs Export</p> </li> <li>Full audit trail</li> <li>CSV or JSON format</li> <li> <p>Includes: all audit log fields</p> </li> <li> <p>Users Export</p> </li> <li>User directory</li> <li>CSV or JSON format</li> <li>Includes: email, name, role, teams, join date</li> </ol>"},{"location":"handbook/ADMIN_GUIDE/#export-workflow-planned","title":"Export Workflow (Planned)","text":"<ol> <li>Admin requests export via UI</li> <li>Background job generates file</li> <li>Email sent with download link</li> <li>Link expires after 24 hours</li> <li>File auto-deleted after 7 days</li> </ol>"},{"location":"handbook/ADMIN_GUIDE/#user-management","title":"User Management","text":""},{"location":"handbook/ADMIN_GUIDE/#list-users","title":"List Users","text":"<p>Endpoint: <code>GET /users</code></p> <p>Permission: <code>member.view.all</code> (admin or owner)</p> <p>Response: <pre><code>[\n  {\n    \"id\": \"uuid\",\n    \"email\": \"user@example.com\",\n    \"name\": \"Alice Developer\",\n    \"primaryTeamId\": \"uuid\",\n    \"createdAt\": \"2025-01-01T00:00:00Z\"\n  }\n]\n</code></pre></p>"},{"location":"handbook/ADMIN_GUIDE/#create-user","title":"Create User","text":"<p>Endpoint: <code>POST /admin/users</code></p> <p>Permission: <code>member.add</code> (admin or owner)</p> <p>Request: <pre><code>{\n  \"email\": \"newuser@example.com\",\n  \"name\": \"New User\",\n  \"ssoId\": \"optional-sso-id\"\n}\n</code></pre></p>"},{"location":"handbook/ADMIN_GUIDE/#update-user","title":"Update User","text":"<p>Endpoint: <code>PUT /admin/users/:id</code></p> <p>Permission: <code>member.edit</code> (owner only)</p> <p>Use Cases: - Change primary team - Update name/email - Deactivate user</p>"},{"location":"handbook/ADMIN_GUIDE/#delete-user","title":"Delete User","text":"<p>Endpoint: <code>DELETE /admin/users/:id</code></p> <p>Permission: <code>member.remove</code> (owner only)</p> <p>Effect: - User deleted - Questions remain (anonymized) - Pulse responses remain (already anonymous) - Audit logs remain</p>"},{"location":"handbook/ADMIN_GUIDE/#team-management","title":"Team Management","text":""},{"location":"handbook/ADMIN_GUIDE/#create-team","title":"Create Team","text":"<p>Endpoint: <code>POST /admin/teams</code></p> <p>Permission: <code>team.create</code> (admin or owner)</p> <p>Request: <pre><code>{\n  \"name\": \"Engineering\",\n  \"slug\": \"engineering\",\n  \"description\": \"Engineering team questions\"\n}\n</code></pre></p>"},{"location":"handbook/ADMIN_GUIDE/#add-team-member","title":"Add Team Member","text":"<p>Endpoint: <code>POST /admin/teams/:teamId/members</code></p> <p>Permission: <code>member.add</code> (admin or owner)</p> <p>Request: <pre><code>{\n  \"userId\": \"uuid\",\n  \"role\": \"member\"  // 'viewer' | 'member' | 'moderator' | 'admin' | 'owner'\n}\n</code></pre></p>"},{"location":"handbook/ADMIN_GUIDE/#change-member-role","title":"Change Member Role","text":"<p>Endpoint: <code>PUT /admin/teams/:teamId/members/:userId</code></p> <p>Permission: <code>member.edit</code> (owner only)</p> <p>Request: <pre><code>{\n  \"role\": \"moderator\"\n}\n</code></pre></p>"},{"location":"handbook/ADMIN_GUIDE/#presentation-mode","title":"Presentation Mode","text":"<p>URL: <code>/:teamSlug/open/present</code></p> <p>Permission: <code>presentation.access</code> (moderator+ only)</p> <p>Features: - Full-screen display for meetings - Keyboard shortcuts (Space=next, H=highest, Esc=exit) - Auto-tags questions with \"Currently Presenting\" - Real-time updates via SSE</p> <p>Use Cases: - All-hands meetings - Town halls - Q&amp;A sessions</p> <p>See: <code>/handbook/PRODUCT_VISION.md</code> for details</p>"},{"location":"handbook/ADMIN_GUIDE/#search-tags","title":"Search &amp; Tags","text":""},{"location":"handbook/ADMIN_GUIDE/#full-text-search","title":"Full-Text Search","text":"<p>Endpoint: <code>GET /questions?search=&lt;term&gt;</code></p> <p>Technology: PostgreSQL full-text search with prefix matching</p> <p>Features: - Stemming (e.g., \"working\" matches \"work\") - Prefix matching (e.g., \"polic\" matches \"policy\") - Ranked results</p>"},{"location":"handbook/ADMIN_GUIDE/#tag-management","title":"Tag Management","text":"<p>Endpoints: - <code>GET /tags</code> - List all tags - <code>POST /admin/tags</code> - Create tag (admin) - <code>PUT /admin/tags/:id</code> - Update tag (admin) - <code>DELETE /admin/tags/:id</code> - Delete tag (admin)</p> <p>Default Tags: - Currently Presenting - Feature Request - Bug - Question - Process - Technical</p> <p>Custom Tags: - Admins can create custom tags - Color-coded for visual organization</p>"},{"location":"handbook/ADMIN_GUIDE/#monitoring-diagnostics","title":"Monitoring &amp; Diagnostics","text":""},{"location":"handbook/ADMIN_GUIDE/#health-checks","title":"Health Checks","text":"<p>Endpoints: - <code>GET /health</code> - Basic health (always 200 if process alive) - <code>GET /health/live</code> - Liveness probe (Kubernetes) - <code>GET /health/ready</code> - Readiness probe (DB + Redis healthy)</p>"},{"location":"handbook/ADMIN_GUIDE/#service-status","title":"Service Status","text":"<p>Check: - API server: <code>curl http://localhost:3000/health</code> - Database: <code>GET /health/ready</code> (includes DB check) - Redis: <code>GET /health/ready</code> (includes Redis check) - Email queue: <code>GET /admin/email-queue</code></p>"},{"location":"handbook/ADMIN_GUIDE/#logs","title":"Logs","text":"<p>Development: - Console output - Debug logs enabled</p> <p>Production: - Structured JSON logs (recommended) - Log aggregation (Datadog, CloudWatch, etc.) - Error tracking (Sentry, etc.)</p>"},{"location":"handbook/ADMIN_GUIDE/#backup-recovery","title":"Backup &amp; Recovery","text":"<p>Status: Deployment-specific</p>"},{"location":"handbook/ADMIN_GUIDE/#recommended-practices","title":"Recommended Practices","text":"<ol> <li>Database Backups:</li> <li>Nightly pg_dump</li> <li>Weekly role backups</li> <li>7-14 day retention</li> <li> <p>Monthly restore tests</p> </li> <li> <p>Audit Log Retention:</p> </li> <li>Keep indefinitely (or per compliance requirements)</li> <li> <p>Archive older logs to cold storage</p> </li> <li> <p>Disaster Recovery:</p> </li> <li>Document restore procedures</li> <li>Test recovery quarterly</li> <li>Keep backups in separate region</li> </ol> <p>See: <code>/handbook/OPERATIONS.md</code> for deployment details</p>"},{"location":"handbook/ADMIN_GUIDE/#security-best-practices","title":"Security Best Practices","text":""},{"location":"handbook/ADMIN_GUIDE/#production-checklist","title":"Production Checklist","text":"<ul> <li> HTTPS enabled (SSL certificate)</li> <li> Redis configured (rate limiting + sessions)</li> <li> Strong SESSION_SECRET (32+ random characters)</li> <li> OAuth configured (no demo mode in production)</li> <li> Rate limiting active (verify <code>/health/ready</code> shows Redis)</li> <li> Email configured (SMTP or Resend)</li> <li> Audit logs enabled (default)</li> <li> Regular backups (database + audit logs)</li> <li> Security scans (<code>make security</code> before deploy)</li> <li> Environment variables secured (not in code)</li> </ul>"},{"location":"handbook/ADMIN_GUIDE/#monitoring-alerts-recommended","title":"Monitoring Alerts (Recommended)","text":"<ul> <li>Database connection failures</li> <li>Redis connection failures</li> <li>Email queue failures (&gt;10 failed jobs)</li> <li>Rate limit exceeded events (spike detection)</li> <li>Moderation queue size (&gt;50 items)</li> <li>Failed login attempts (&gt;20/hour)</li> </ul>"},{"location":"handbook/ADMIN_GUIDE/#troubleshooting_1","title":"Troubleshooting","text":""},{"location":"handbook/ADMIN_GUIDE/#users-cant-login","title":"Users Can't Login","text":"<p>Check: 1. OAuth configured (<code>/auth/modes</code> endpoint) 2. Callback URLs correct 3. Session store working (Redis in production) 4. No rate limiting errors (429 responses)</p>"},{"location":"handbook/ADMIN_GUIDE/#questions-not-appearing","title":"Questions Not Appearing","text":"<p>Check: 1. Question status (OPEN vs UNDER_REVIEW) 2. Team scoping (user in correct team?) 3. Tenant isolation (correct tenant header?)</p>"},{"location":"handbook/ADMIN_GUIDE/#pulse-not-sending","title":"Pulse Not Sending","text":"<p>Check: 1. Pulse enabled in tenant settings 2. Pulse schedule exists and enabled 3. Cohorts exist with users 4. Active questions exist 5. Email worker running (requires Redis) 6. Cron scheduler running</p> <p>See: <code>/handbook/PULSE_SYSTEM.md</code> for full troubleshooting</p>"},{"location":"handbook/ADMIN_GUIDE/#related-documentation","title":"Related Documentation","text":"<ul> <li><code>/handbook/SECURITY_MODEL.md</code> - Security architecture</li> <li><code>/handbook/OPERATIONS.md</code> - Deployment &amp; operations</li> <li><code>/handbook/TRUST_AND_SAFETY.md</code> - Content moderation</li> <li><code>/handbook/PULSE_SYSTEM.md</code> - Pulse configuration</li> <li><code>/handbook/INTEGRATIONS/EMAIL.md</code> - Email setup</li> <li><code>/handbook/AUTHENTICATION.md</code> - Auth configuration</li> </ul>"},{"location":"handbook/AUTHENTICATION/","title":"Authentication System","text":"<p>Purpose: Secure user authentication with multiple methods for development and production.</p> <p>Architecture: Multi-mode system supporting Demo, GitHub OAuth, and Google OAuth.</p>"},{"location":"handbook/AUTHENTICATION/#authentication-modes","title":"Authentication Modes","text":"<p>PulseStage supports 3 authentication modes:</p> <ol> <li>Demo Mode - Development only, no credentials required</li> <li>GitHub OAuth - Production-ready, social login</li> <li>Google OAuth - Production-ready, social login</li> </ol> <p>Multiple modes can be enabled simultaneously. Users see available options on the login page.</p>"},{"location":"handbook/AUTHENTICATION/#mode-selection-priority","title":"Mode Selection &amp; Priority","text":""},{"location":"handbook/AUTHENTICATION/#automatic-mode-detection","title":"Automatic Mode Detection","text":"<p>The system automatically enables modes based on configuration:</p> <pre><code>// Demo mode\nif (AUTH_MODE_DEMO=true || NODE_ENV=development) {\n  enableDemoMode()\n}\n\n// OAuth modes\nif (GITHUB_CLIENT_ID &amp;&amp; GITHUB_CLIENT_SECRET) {\n  enableGitHubOAuth()\n}\n\nif (GOOGLE_CLIENT_ID &amp;&amp; GOOGLE_CLIENT_SECRET) {\n  enableGoogleOAuth()\n}\n</code></pre>"},{"location":"handbook/AUTHENTICATION/#api-endpoint","title":"API Endpoint","text":"<p>GET /auth/modes - Returns available authentication modes</p> <p>Response: <pre><code>{\n  \"modes\": [\"demo\", \"oauth\"],\n  \"demo\": {\n    \"enabled\": true,\n    \"users\": [\"admin\", \"alice\", \"bob\", \"moderator\"]\n  },\n  \"oauth\": {\n    \"github\": true,\n    \"google\": true\n  }\n}\n</code></pre></p> <p>Frontend uses this to render appropriate login buttons.</p>"},{"location":"handbook/AUTHENTICATION/#demo-mode-development-only","title":"Demo Mode (Development Only)","text":"<p>Purpose: Quick testing without OAuth setup</p> <p>Security: Only enabled in development or with <code>AUTH_MODE_DEMO=true</code></p> <p>Users: Predefined demo users (admin, alice, bob, moderator)</p>"},{"location":"handbook/AUTHENTICATION/#configuration","title":"Configuration","text":"<pre><code># Auto-enabled in development\nNODE_ENV=development\n\n# Or explicitly enable\nAUTH_MODE_DEMO=true\n</code></pre>"},{"location":"handbook/AUTHENTICATION/#flow","title":"Flow","text":"<ol> <li>User clicks demo login button</li> <li>Frontend redirects to <code>GET /auth/demo?user=alice&amp;tenant=default</code></li> <li>Backend validates user exists in seed data</li> <li>Session created with user info</li> <li>Redirect back to frontend with <code>?demo=true</code></li> </ol>"},{"location":"handbook/AUTHENTICATION/#seed-data-integration","title":"Seed Data Integration","text":"<p>Demo users MUST exist in seed data: - Email format: <code>{username}@pulsestage.app</code> - SSO ID: Same as username (e.g., <code>admin</code>, not <code>demo-admin</code>) - Primary teams: Assigned via seed script</p>"},{"location":"handbook/AUTHENTICATION/#limitations","title":"Limitations","text":"<ul> <li>No password validation</li> <li>No real SSO provider</li> <li>Bypasses security checks</li> <li>NEVER use in production</li> </ul>"},{"location":"handbook/AUTHENTICATION/#github-oauth-production","title":"GitHub OAuth (Production)","text":"<p>Purpose: Let users authenticate with GitHub accounts</p> <p>Provider: GitHub OAuth 2.0</p>"},{"location":"handbook/AUTHENTICATION/#configuration_1","title":"Configuration","text":"<pre><code># Required environment variables\nGITHUB_CLIENT_ID=your_github_client_id\nGITHUB_CLIENT_SECRET=your_github_client_secret\nGITHUB_CALLBACK_URL=https://yourdomain.com/auth/github/callback\n\n# Development\nGITHUB_CALLBACK_URL=http://localhost:3000/auth/github/callback\n</code></pre>"},{"location":"handbook/AUTHENTICATION/#setup-steps","title":"Setup Steps","text":"<ol> <li>Create GitHub OAuth App:</li> <li>Go to GitHub Settings &gt; Developer settings &gt; OAuth Apps</li> <li>Click \"New OAuth App\"</li> <li>Application name: <code>PulseStage - Your Company</code></li> <li>Homepage URL: <code>https://yourdomain.com</code></li> <li>Authorization callback URL: <code>https://yourdomain.com/auth/github/callback</code></li> <li>Register application</li> <li> <p>Copy Client ID and Client Secret</p> </li> <li> <p>Configure Environment: <pre><code>GITHUB_CLIENT_ID=abc123...\nGITHUB_CLIENT_SECRET=secret123...\nGITHUB_CALLBACK_URL=https://yourdomain.com/auth/github/callback\n</code></pre></p> </li> <li> <p>Test:</p> </li> <li>Restart API server</li> <li>Check <code>/auth/modes</code> includes GitHub</li> <li>Click \"Sign in with GitHub\" on login page</li> </ol>"},{"location":"handbook/AUTHENTICATION/#oauth-flow","title":"OAuth Flow","text":"<pre><code>User clicks \"Sign in with GitHub\"\n  \u2193\nRedirect to GitHub authorization page\n  \u2193\nUser approves (or already authorized)\n  \u2193\nGitHub redirects to callback URL with code\n  \u2193\nBackend exchanges code for access token\n  \u2193\nBackend fetches user profile from GitHub API\n  \u2193\nBackend creates or updates user in database\n  \u2193\nSession created\n  \u2193\nRedirect to frontend\n</code></pre>"},{"location":"handbook/AUTHENTICATION/#user-provisioning","title":"User Provisioning","text":"<p>On first login: - Create user in database - Email from GitHub profile - Name from GitHub profile - Avatar URL from GitHub profile - Assign to default team (if configured) - Default role: <code>member</code> (or tenant setting)</p> <p>On subsequent logins: - Update name/avatar if changed - Session refreshed</p>"},{"location":"handbook/AUTHENTICATION/#github-api-scopes","title":"GitHub API Scopes","text":"<p>Requested scopes: - <code>user:email</code> - Read email address (required)</p> <p>Not requested: - Repo access - Organization access - Private data</p>"},{"location":"handbook/AUTHENTICATION/#google-oauth-production","title":"Google OAuth (Production)","text":"<p>Purpose: Let users authenticate with Google accounts</p> <p>Provider: Google OAuth 2.0</p>"},{"location":"handbook/AUTHENTICATION/#configuration_2","title":"Configuration","text":"<pre><code># Required environment variables\nGOOGLE_CLIENT_ID=your_google_client_id.apps.googleusercontent.com\nGOOGLE_CLIENT_SECRET=your_google_client_secret\nGOOGLE_CALLBACK_URL=https://yourdomain.com/auth/google/callback\n\n# Development\nGOOGLE_CALLBACK_URL=http://localhost:3000/auth/google/callback\n</code></pre>"},{"location":"handbook/AUTHENTICATION/#setup-steps_1","title":"Setup Steps","text":"<ol> <li>Create Google OAuth Client:</li> <li>Go to Google Cloud Console &gt; APIs &amp; Services &gt; Credentials</li> <li>Create credentials &gt; OAuth client ID</li> <li>Application type: Web application</li> <li>Name: <code>PulseStage - Your Company</code></li> <li>Authorized redirect URIs: <code>https://yourdomain.com/auth/google/callback</code></li> <li>Create</li> <li> <p>Copy Client ID and Client Secret</p> </li> <li> <p>Configure Environment: <pre><code>GOOGLE_CLIENT_ID=123-abc.apps.googleusercontent.com\nGOOGLE_CLIENT_SECRET=secret123...\nGOOGLE_CALLBACK_URL=https://yourdomain.com/auth/google/callback\n</code></pre></p> </li> <li> <p>Test:</p> </li> <li>Restart API server</li> <li>Check <code>/auth/modes</code> includes Google</li> <li>Click \"Sign in with Google\" on login page</li> </ol>"},{"location":"handbook/AUTHENTICATION/#oauth-flow_1","title":"OAuth Flow","text":"<p>(Same as GitHub, different provider)</p>"},{"location":"handbook/AUTHENTICATION/#user-provisioning_1","title":"User Provisioning","text":"<p>On first login: - Create user in database - Email from Google profile - Name from Google profile - Avatar URL from Google profile (optional) - Assign to default team (if configured) - Default role: <code>member</code> (or tenant setting)</p> <p>On subsequent logins: - Update name/avatar if changed - Session refreshed</p>"},{"location":"handbook/AUTHENTICATION/#google-api-scopes","title":"Google API Scopes","text":"<p>Requested scopes: - <code>profile</code> - Read basic profile info - <code>email</code> - Read email address</p> <p>Not requested: - Drive access - Calendar access - Gmail access</p>"},{"location":"handbook/AUTHENTICATION/#session-management","title":"Session Management","text":"<p>Technology: express-session with Redis (production) or memory (development)</p>"},{"location":"handbook/AUTHENTICATION/#session-configuration","title":"Session Configuration","text":"<pre><code>{\n  secret: SESSION_SECRET,\n  resave: false,\n  saveUninitialized: false,\n  cookie: {\n    secure: NODE_ENV === 'production',  // HTTPS only in prod\n    httpOnly: true,                      // No JavaScript access\n    maxAge: 8 hours (users) / 8 hours (admins),\n    sameSite: 'lax'\n  },\n  store: RedisStore (prod) || MemoryStore (dev)\n}\n</code></pre>"},{"location":"handbook/AUTHENTICATION/#session-contents","title":"Session Contents","text":"<pre><code>req.session = {\n  user: {\n    id: \"uuid\",\n    email: \"user@example.com\",\n    name: \"Alice Developer\",\n    role: \"member\",\n    tenantId: \"tenant-uuid\"\n  },\n  tenantSlug: \"default\"\n}\n</code></pre>"},{"location":"handbook/AUTHENTICATION/#session-lifetime","title":"Session Lifetime","text":"<ul> <li>Users: 8 hours (configurable via tenant settings)</li> <li>Admins: 8 hours (configurable via tenant settings)</li> <li>Idle timeout: None (fixed expiration from creation)</li> <li>Remember me: Not yet implemented</li> </ul>"},{"location":"handbook/AUTHENTICATION/#session-storage","title":"Session Storage","text":"<p>Development: - In-memory store (MemoryStore) - Lost on server restart - Single-server only</p> <p>Production: - Redis store (connect-redis) - Persists across restarts - Supports multiple servers (load balancing) - Requires <code>REDIS_URL</code></p>"},{"location":"handbook/AUTHENTICATION/#multi-tenancy-authentication","title":"Multi-Tenancy &amp; Authentication","text":""},{"location":"handbook/AUTHENTICATION/#tenant-resolution","title":"Tenant Resolution","text":"<p>Order of precedence: 1. <code>x-tenant-id</code> header (API requests) 2. Subdomain (e.g., <code>acme.pulsestage.app</code> \u2192 tenant <code>acme</code>) 3. Default tenant (<code>default</code>)</p>"},{"location":"handbook/AUTHENTICATION/#session-tenant-binding","title":"Session &amp; Tenant Binding","text":"<ul> <li>User logs in \u2192 tenant determined at login time</li> <li>Session stores <code>tenantSlug</code></li> <li>All subsequent requests use session tenant</li> <li>User cannot switch tenants without re-login</li> </ul>"},{"location":"handbook/AUTHENTICATION/#cross-tenant-authentication","title":"Cross-Tenant Authentication","text":"<p>Not supported: - Users cannot access multiple tenants with one session - Each tenant has isolated user base - Same email can exist in multiple tenants (different users)</p>"},{"location":"handbook/AUTHENTICATION/#logout","title":"Logout","text":"<p>Endpoint: <code>POST /auth/logout</code></p> <p>Flow: 1. Destroy session 2. Clear session cookie 3. Return success</p> <p>Frontend: <pre><code>await apiClient.logout()\nnavigate('/login')\n</code></pre></p>"},{"location":"handbook/AUTHENTICATION/#security-considerations","title":"Security Considerations","text":""},{"location":"handbook/AUTHENTICATION/#csrf-protection","title":"CSRF Protection","text":"<p>Enabled: Yes (via <code>csurf</code> middleware)</p> <p>Mechanism: - CSRF token generated per session - Token required for state-changing requests (POST, PUT, DELETE) - Token validated server-side</p>"},{"location":"handbook/AUTHENTICATION/#session-hijacking","title":"Session Hijacking","text":"<p>Mitigations: - <code>httpOnly</code> cookies (no JavaScript access) - <code>secure</code> cookies in production (HTTPS only) - <code>sameSite: lax</code> (CSRF protection) - Session timeout (8 hours)</p>"},{"location":"handbook/AUTHENTICATION/#brute-force-protection","title":"Brute Force Protection","text":"<p>Mechanism: Rate limiting (see <code>/handbook/SECURITY_MODEL.md</code>)</p> <p>Limits: - 5 login attempts per 5 minutes (per IP + tenant) - Redis-based (production only) - Development bypasses rate limiting</p>"},{"location":"handbook/AUTHENTICATION/#development-vs-production","title":"Development vs Production","text":"Feature Development Production Demo Mode Enabled (default) Disabled (unless forced) OAuth Optional Required Session Store Memory Redis (required) HTTPS Not required Required CSRF Enabled Enabled Rate Limiting Disabled Enabled (required)"},{"location":"handbook/AUTHENTICATION/#troubleshooting","title":"Troubleshooting","text":""},{"location":"handbook/AUTHENTICATION/#oauth-callback-error-invalid-redirect-uri","title":"OAuth Callback Error: \"Invalid redirect URI\"","text":"<p>Cause: Callback URL mismatch</p> <p>Fix: 1. Check <code>GITHUB_CALLBACK_URL</code> / <code>GOOGLE_CALLBACK_URL</code> in <code>.env</code> 2. Ensure it matches OAuth app configuration exactly 3. Include protocol (<code>http://</code> or <code>https://</code>) 4. No trailing slash</p>"},{"location":"handbook/AUTHENTICATION/#session-lost-on-server-restart-development","title":"Session Lost on Server Restart (Development)","text":"<p>Cause: Memory-based session store</p> <p>Fix: - Expected behavior in development - Use Redis for persistent sessions - Re-login after restart</p>"},{"location":"handbook/AUTHENTICATION/#oauth-error-invalid-client","title":"OAuth Error: \"Invalid client\"","text":"<p>Cause: Incorrect Client ID or Secret</p> <p>Fix: 1. Regenerate credentials in OAuth provider console 2. Update <code>.env</code> with new values 3. Restart API server</p>"},{"location":"handbook/AUTHENTICATION/#user-created-but-not-in-database","title":"User Created but Not in Database","text":"<p>Cause: User provisioning failed</p> <p>Fix: 1. Check logs for database errors 2. Ensure tenant exists 3. Check default role is valid</p>"},{"location":"handbook/AUTHENTICATION/#future-enhancements","title":"Future Enhancements","text":""},{"location":"handbook/AUTHENTICATION/#planned-features","title":"Planned Features","text":"<ol> <li>SAML SSO - Enterprise single sign-on</li> <li>OIDC - OpenID Connect support</li> <li>Magic Links - Passwordless email login</li> <li>Remember Me - Persistent sessions</li> <li>2FA - Two-factor authentication</li> <li>Session Management UI - View/revoke active sessions</li> </ol>"},{"location":"handbook/AUTHENTICATION/#configuration-options-planned","title":"Configuration Options (Planned)","text":"<pre><code>{\n  auth: {\n    modes: ['demo', 'github', 'google', 'saml', 'oidc'],\n    allowedDomains: ['@company.com'],  // Email domain whitelist\n    requireEmailVerification: true,\n    session: {\n      timeout: 8,         // hours\n      remember: 30,       // days (if \"remember me\" checked)\n      maxConcurrent: 3    // Max sessions per user\n    }\n  }\n}\n</code></pre>"},{"location":"handbook/AUTHENTICATION/#related-documentation","title":"Related Documentation","text":"<ul> <li><code>/handbook/SECURITY_MODEL.md</code> - Authentication security</li> <li><code>/handbook/OPERATIONS.md</code> - Redis setup for sessions</li> <li><code>/handbook/DECISIONS/ADR-0003-roles.md</code> - User roles &amp; permissions</li> <li><code>/api/src/lib/auth/</code> - Implementation details</li> </ul>"},{"location":"handbook/DATA_MODEL_SNAPSHOT/","title":"Data Model Snapshot","text":""},{"location":"handbook/DATA_MODEL_SNAPSHOT/#overview","title":"Overview","text":"<p>PulseStage is team-first with organizational rollups. Every user has a primary team, and both Q&amp;A and Pulse data are scoped to teams, with \"All Teams\" views available for admins.</p>"},{"location":"handbook/DATA_MODEL_SNAPSHOT/#core-entities","title":"Core Entities","text":""},{"location":"handbook/DATA_MODEL_SNAPSHOT/#tenant","title":"Tenant","text":"<p>Purpose: Absolute isolation boundary for all multi-tenant data. - Every entity (except Tenant itself) MUST have <code>tenantId</code> - Subdomain-based tenant resolution (per ADR-0001) - Example: <code>acme.pulsestage.app</code> \u2192 tenant slug <code>acme</code></p>"},{"location":"handbook/DATA_MODEL_SNAPSHOT/#team","title":"Team","text":"<p>Purpose: Primary organizational unit for team-scoped Q&amp;A and Pulse surveys. - Teams belong to a tenant - Users have a <code>primaryTeamId</code> for main affiliation - Questions and Pulse data are associated with teams</p>"},{"location":"handbook/DATA_MODEL_SNAPSHOT/#user","title":"User","text":"<p>Purpose: Represents participants, moderators, and admins. - Key field: <code>primaryTeamId</code> - determines pulse distribution and team affiliation - Authentication: SSO via <code>ssoId</code> or demo mode in development - Roles: <code>admin</code>, <code>moderator</code>, <code>participant</code> (per ADR-0003) - Email format (demo): <code>{username}@pulsestage.app</code></p>"},{"location":"handbook/DATA_MODEL_SNAPSHOT/#question-qa","title":"Question (Q&amp;A)","text":"<p>Purpose: Anonymous questions submitted for team all-hands/town halls. - Team-scoped via <code>teamId</code> - Anonymous by default (no <code>userId</code> foreign key) - Status: <code>OPEN</code>, <code>ANSWERED</code>, <code>UNDER_REVIEW</code> - Supports tags, upvotes, pinning, and moderation</p>"},{"location":"handbook/DATA_MODEL_SNAPSHOT/#pulsequestion","title":"PulseQuestion","text":"<p>Purpose: Template questions for recurring sentiment surveys. - Fields:   - <code>text</code> - Question text (max 200 characters)   - <code>active</code> - Whether question is in rotation   - <code>tenantId</code> - Tenant isolation - Example: \"How satisfied are you with work-life balance?\" - Used by: Scheduler selects from active questions for daily pulse sends</p>"},{"location":"handbook/DATA_MODEL_SNAPSHOT/#pulsecohort","title":"PulseCohort","text":"<p>Purpose: Groups of users who receive pulse invites on the same schedule. - Fields:   - <code>name</code> - Cohort identifier (e.g., \"weekday-0\", \"weekend-1\")   - <code>userIds</code> - JSON array of user IDs in this cohort   - <code>tenantId</code> - Tenant isolation - Rotation: Cohorts receive different questions on different days - Assignment: Users assigned to cohorts during seeding or onboarding - Purpose: Distribute survey load, reduce fatigue, enable question rotation</p>"},{"location":"handbook/DATA_MODEL_SNAPSHOT/#pulseschedule","title":"PulseSchedule","text":"<p>Purpose: Tenant-level configuration for pulse sending. - Fields:   - <code>tenantId</code> - Which tenant this schedule applies to   - <code>enabled</code> - Master on/off switch   - <code>cadence</code> - <code>WEEKLY</code>, <code>BIWEEKLY</code>, <code>MONTHLY</code>   - <code>time</code> - HH:mm format (e.g., \"09:00\")   - <code>timezone</code> - Timezone for scheduling (e.g., \"America/New_York\")   - <code>rotatingCohorts</code> - Whether to use cohort rotation   - <code>numCohorts</code> - How many cohorts to rotate through - Used by: Daily cron job to determine if/when to send pulses</p>"},{"location":"handbook/DATA_MODEL_SNAPSHOT/#pulseinvite","title":"PulseInvite","text":"<p>Purpose: Tracks individual pulse invitations sent to users. - Fields:   - <code>token</code> - Unique token for one-tap response (UUID)   - <code>userId</code> - Which user received this invite   - <code>questionId</code> - Which pulse question   - <code>teamId</code> - Copied from <code>user.primaryTeamId</code> at creation   - <code>cohortName</code> - Which cohort this user belongs to (optional)   - <code>sentAt</code> - When email was sent   - <code>expiresAt</code> - Token expiration (default: 7 days)   - <code>respondedAt</code> - When user responded (NULL if not yet responded)   - <code>tenantId</code> - Tenant isolation - Token security: Single-use, time-limited, unpredictable (UUID v4) - One-tap flow: Email contains links like <code>/pulse/respond?token=abc&amp;score=4</code></p>"},{"location":"handbook/DATA_MODEL_SNAPSHOT/#pulseresponse","title":"PulseResponse","text":"<p>Purpose: Anonymous sentiment responses (ANONYMITY-CRITICAL). - Fields:   - <code>inviteId</code> - Link to invite (for deduplication)   - <code>questionId</code> - Which question was answered   - <code>teamId</code> - Copied from <code>invite.teamId</code> for team-scoped aggregates   - <code>score</code> - Likert scale response (1-5)   - <code>respondedAt</code> - Timestamp   - <code>tenantId</code> - Tenant isolation - CRITICAL INVARIANT: NO <code>userId</code> field - responses cannot be traced to individuals - Schema enforcement: <code>userId</code> column does not exist - Anonymity guarantee: Even admins cannot link responses to users - Aggregates: Only shown when <code>COUNT(*) &gt;= threshold</code> (default: 5)</p>"},{"location":"handbook/DATA_MODEL_SNAPSHOT/#entity-relationships","title":"Entity Relationships","text":"<pre><code>Tenant (1) \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 (n) Team\n                        \u2502\n                        \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 (n) User\n                        \u2502                 \u2514\u2500\u2500 primaryTeamId \u2192 Team\n                        \u2502\n                        \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 (n) Question\n                        \u2502                 \u2514\u2500\u2500 teamId \u2192 Team\n                        \u2502\n                        \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 (n) PulseQuestion\n                        \u2502\n                        \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 (n) PulseCohort\n                        \u2502                 \u2514\u2500\u2500 userIds (JSON array)\n                        \u2502\n                        \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 (1) PulseSchedule\n                        \u2502\n                        \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 (n) PulseInvite\n                        \u2502                 \u251c\u2500\u2500 userId \u2192 User\n                        \u2502                 \u251c\u2500\u2500 questionId \u2192 PulseQuestion\n                        \u2502                 \u2514\u2500\u2500 teamId \u2192 Team (from user.primaryTeamId)\n                        \u2502\n                        \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 (n) PulseResponse\n                                          \u251c\u2500\u2500 inviteId \u2192 PulseInvite\n                                          \u251c\u2500\u2500 questionId \u2192 PulseQuestion\n                                          \u2514\u2500\u2500 teamId \u2192 Team (from invite.teamId)\n                                          (NO userId - anonymity preserved)\n\nTeam (1) \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 (n) User (as primaryTeam)\n                        \u2502\n                        \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 (n) TeamMembership\n                        \u2502\n                        \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 (n) Question\n                        \u2502\n                        \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 (n) PulseInvite/PulseResponse\n</code></pre>"},{"location":"handbook/DATA_MODEL_SNAPSHOT/#critical-invariants","title":"Critical Invariants","text":""},{"location":"handbook/DATA_MODEL_SNAPSHOT/#tenant-isolation-must-never-violate","title":"Tenant Isolation (MUST NEVER VIOLATE)","text":"<ol> <li>Every entity MUST have <code>tenantId</code> (except Tenant model)</li> <li>ALL queries MUST filter by <code>tenantId</code></li> <li>NO cross-tenant joins or searches</li> <li>Aggregations are per-tenant only</li> <li>Logs/metrics MUST include <code>tenantId</code> and <code>requestId</code></li> </ol>"},{"location":"handbook/DATA_MODEL_SNAPSHOT/#anonymity-must-preserve","title":"Anonymity (MUST PRESERVE)","text":"<ol> <li><code>PulseResponse</code> MUST NOT have <code>userId</code> field</li> <li><code>Question</code> submissions are anonymous (no <code>userId</code>)</li> <li>Aggregates only shown when <code>n &gt;= threshold</code> (typically 5)</li> <li>Audit logs MUST NOT log PII from anonymous responses</li> </ol>"},{"location":"handbook/DATA_MODEL_SNAPSHOT/#team-scoping-primary-architecture","title":"Team Scoping (PRIMARY ARCHITECTURE)","text":"<ol> <li>Users MUST have <code>primaryTeamId</code> for pulse distribution</li> <li><code>PulseInvite.teamId</code> is set from <code>user.primaryTeamId</code> at creation</li> <li><code>PulseResponse.teamId</code> is copied from <code>invite.teamId</code> at submission</li> <li>Questions are team-scoped via <code>question.teamId</code></li> <li>\"All Teams\" views are aggregations, not a separate data store</li> </ol>"},{"location":"handbook/DATA_MODEL_SNAPSHOT/#data-integrity","title":"Data Integrity","text":"<ol> <li>User's <code>primaryTeamId</code> can be NULL during setup/migration</li> <li>Team <code>isActive</code> flag controls visibility, not hard deletes</li> <li>Soft deletes preserve audit trail for questions</li> <li>Migrations MUST preserve <code>tenantId</code> isolation</li> </ol>"},{"location":"handbook/DATA_MODEL_SNAPSHOT/#authorization-model","title":"Authorization Model","text":""},{"location":"handbook/DATA_MODEL_SNAPSHOT/#roles-per-tenant-per-adr-0003","title":"Roles (per tenant, per ADR-0003)","text":"<ul> <li>viewer: Read-only access to questions and pulse data</li> <li>member: Can submit questions, respond to pulse, upvote</li> <li>moderator: Team-scoped moderation (via TeamMembership)</li> <li>admin: Tenant-wide administration and moderation</li> <li>owner: Full tenant control including settings and user management</li> </ul>"},{"location":"handbook/DATA_MODEL_SNAPSHOT/#permission-checks","title":"Permission Checks","text":"<ul> <li>Server-side enforcement on EVERY write and sensitive read</li> <li>Middleware: <code>requireAuth</code>, <code>requireRole</code>, <code>requirePermission</code></li> <li>Frontend: Conditional UI rendering (not security boundary)</li> </ul>"},{"location":"handbook/DATA_MODEL_SNAPSHOT/#current-scale-demo-data","title":"Current Scale (Demo Data)","text":"<ul> <li>50 users: 4 login users (admin, alice, bob, moderator) + 46 dummy users</li> <li>2 teams: Engineering, Product</li> <li>36 Q&amp;A questions: 10 open + 10 answered per team</li> <li>12 weeks pulse data: ~800 responses with team-specific trends</li> <li>81.6% participation rate: Realistic demo engagement</li> </ul>"},{"location":"handbook/DATA_MODEL_SNAPSHOT/#full-schema-reference","title":"Full Schema Reference","text":"<p>Canonical source of truth: <code>/api/prisma/schema.prisma</code></p> <p>Run <code>npx prisma studio</code> to explore the database interactively.</p>"},{"location":"handbook/DEVELOPMENT/","title":"Development Workflow &amp; Testing Protocol","text":"<p>This document outlines the required workflow for development and testing to ensure a consistent, functional experience.</p>"},{"location":"handbook/DEVELOPMENT/#core-principle","title":"\ud83c\udfaf Core Principle","text":"<p>The development environment should ALWAYS be functional and ready for user testing.</p> <p>Before asking the user to test ANYTHING, the AI assistant must: 1. Run the pre-flight check 2. Verify all critical systems are operational 3. Confirm the user can log in and access core features</p>"},{"location":"handbook/DEVELOPMENT/#versioning","title":"\ud83d\udce6 Versioning","text":"<p>PulseStage follows Semantic Versioning 2.0.0 (semver.org).</p>"},{"location":"handbook/DEVELOPMENT/#version-format","title":"Version Format","text":"<p><code>MAJOR.MINOR.PATCH</code> (e.g., <code>0.1.0</code>)</p> <ul> <li>MAJOR (X.0.0) - Breaking changes requiring user action</li> <li>MINOR (0.X.0) - New features, backward compatible</li> <li>PATCH (0.0.X) - Bug fixes, security patches, documentation</li> </ul>"},{"location":"handbook/DEVELOPMENT/#when-to-increment","title":"When to Increment","text":""},{"location":"handbook/DEVELOPMENT/#patch-00x-ai-increments-automatically","title":"PATCH (0.0.X) - AI Increments Automatically","text":"<ul> <li>Bug fixes (non-breaking)</li> <li>Documentation updates</li> <li>Security patches (non-breaking)</li> <li>UI tweaks, styling improvements</li> <li>Test improvements</li> <li>Linting fixes</li> </ul>"},{"location":"handbook/DEVELOPMENT/#minor-0x0-ai-proposes-user-approves","title":"MINOR (0.X.0) - AI Proposes, User Approves","text":"<ul> <li>New features (pulse system, presentation mode)</li> <li>New API endpoints (backward compatible)</li> <li>New configuration options (with defaults)</li> <li>Database migrations (automatic, no data loss)</li> <li>Performance improvements</li> <li>New integrations (optional)</li> </ul>"},{"location":"handbook/DEVELOPMENT/#major-x00-ai-warns-user-approves-before-implementation","title":"MAJOR (X.0.0) - AI Warns, User Approves Before Implementation","text":"<ul> <li>Breaking API changes (remove/change endpoints)</li> <li>Breaking database migrations (data loss, manual steps)</li> <li>Breaking authentication changes (re-auth required)</li> <li>Removed environment variables (no backward compatibility)</li> <li>Removed features (no deprecation period)</li> <li>Breaking Docker image changes (docker-compose updates required)</li> </ul>"},{"location":"handbook/DEVELOPMENT/#pre-100-versions","title":"Pre-1.0.0 Versions","text":"<p>Current version: 0.1.0 (pre-stable)</p> <ul> <li>Breaking changes may occur in MINOR versions during <code>0.x.x</code></li> <li>Version <code>1.0.0</code> indicates stable public API</li> <li>See CHANGELOG.md for version history</li> </ul>"},{"location":"handbook/DEVELOPMENT/#version-locations","title":"Version Locations","text":"<p>Versions must be synchronized across: - <code>api/package.json</code> - <code>web/package.json</code> - <code>CHANGELOG.md</code> - <code>README.md</code> (badge) - Git tags (<code>v0.1.0</code>) - Docker images (<code>ghcr.io/seanmdalton/pulsestage-api:0.1.0</code>)</p>"},{"location":"handbook/DEVELOPMENT/#ai-responsibilities","title":"AI Responsibilities","text":"<ol> <li>Automatically increment PATCH for bug fixes, docs, security patches</li> <li>Propose MINOR when adding features, wait for user approval</li> <li>Warn about MAJOR breaking changes, get approval BEFORE implementing</li> <li>Update all version locations when incrementing</li> <li>Update CHANGELOG.md with changes under appropriate version</li> </ol>"},{"location":"handbook/DEVELOPMENT/#changelog-format","title":"Changelog Format","text":"<p>Follow Keep a Changelog:</p> <pre><code>## [Unreleased]\n### Added\n- New feature X\n### Fixed\n- Bug fix Y\n\n## [0.2.0] - 2025-11-15\n### Added\n- Pulse analytics dashboard\n</code></pre>"},{"location":"handbook/DEVELOPMENT/#pre-flight-check-required","title":"Pre-Flight Check (REQUIRED)","text":""},{"location":"handbook/DEVELOPMENT/#when-to-run","title":"When to Run","text":"<ul> <li>ALWAYS before asking the user to test</li> <li>After major changes (database schema, authentication, seeding)</li> <li>After restarting services</li> <li>When debugging \"it's not working\" issues</li> </ul>"},{"location":"handbook/DEVELOPMENT/#how-to-run","title":"How to Run","text":"<pre><code>make preflight\n</code></pre>"},{"location":"handbook/DEVELOPMENT/#what-it-checks","title":"What It Checks","text":"<ol> <li>[OK] Docker services running (postgres, redis, mailpit)</li> <li>[OK] Database connectivity</li> <li>[OK] API server health (http://localhost:3000/health)</li> <li>[OK] Frontend server (http://localhost:5173)</li> <li>[OK] Authentication flow (E2E demo login)</li> <li>[OK] Seed data validation (users, questions, pulse data)</li> <li>[OK] Core API endpoints responding</li> </ol>"},{"location":"handbook/DEVELOPMENT/#exit-codes","title":"Exit Codes","text":"<ul> <li><code>0</code> - All checks passed, ready for testing</li> <li><code>1</code> - Critical checks failed, DO NOT ask user to test</li> </ul>"},{"location":"handbook/DEVELOPMENT/#security-scanning-required-before-push","title":"Security Scanning (REQUIRED Before Push)","text":""},{"location":"handbook/DEVELOPMENT/#when-to-run_1","title":"When to Run","text":"<ul> <li>ALWAYS before pushing to git</li> <li>After updating dependencies</li> <li>After changing Docker images</li> <li>Before releasing</li> </ul>"},{"location":"handbook/DEVELOPMENT/#how-to-run_1","title":"How to Run","text":"<pre><code>make security        # Run security scans only\nmake validate-ci     # Run ALL CI checks (includes security)\n</code></pre>"},{"location":"handbook/DEVELOPMENT/#what-it-checks_1","title":"What It Checks","text":"<ol> <li>[OK] Trivy Docker image scans (API + Web images)</li> <li>[OK] HIGH/CRITICAL vulnerabilities in base images</li> <li>[OK] Vulnerable dependencies</li> <li>[OK] OS-level vulnerabilities</li> </ol>"},{"location":"handbook/DEVELOPMENT/#exit-codes_1","title":"Exit Codes","text":"<ul> <li><code>0</code> - No HIGH/CRITICAL vulnerabilities found</li> <li><code>1</code> - Security issues found, DO NOT push</li> </ul>"},{"location":"handbook/DEVELOPMENT/#if-security-scans-fail","title":"If Security Scans Fail","text":"<p>DO NOT update <code>.trivyignore</code> without user approval!</p> <p>Instead: 1. Check if base images can be updated (<code>node:24-alpine</code>, <code>nginx:alpine</code>) 2. Check if vulnerable npm packages can be updated 3. Research if vulnerabilities are actually exploitable in our context 4. Consult with user if a legitimate false positive</p> <p>Example: Go stdlib vulnerabilities in Alpine base image are often not exploitable via Node.js apps, but still require user approval to ignore.</p>"},{"location":"handbook/DEVELOPMENT/#standard-development-workflow","title":"\ud83d\udd04 Standard Development Workflow","text":""},{"location":"handbook/DEVELOPMENT/#1-initial-setup-one-time","title":"1. Initial Setup (One-time)","text":"<pre><code>make setup      # Generate .env file\nmake install    # Install dependencies\ndocker-compose up -d  # Start services\n</code></pre>"},{"location":"handbook/DEVELOPMENT/#2-seed-database","title":"2. Seed Database","text":"<pre><code>make db-seed    # Reset &amp; seed all data (idempotent)\n</code></pre> <p>This command: - Resets the entire database - Creates tenant, users, teams, tags - Seeds Q&amp;A questions (5 open + 5 answered per team) - Seeds 8 weeks of pulse responses - Creates pending pulse invites - Runs 20 validation tests</p>"},{"location":"handbook/DEVELOPMENT/#3-start-development-servers","title":"3. Start Development Servers","text":"<p>Option A: Separate terminals (recommended) <pre><code># Terminal 1 - API\ncd api &amp;&amp; npm run dev\n\n# Terminal 2 - Frontend\ncd web &amp;&amp; npm run dev\n</code></pre></p> <p>Option B: Background processes <pre><code>cd api &amp;&amp; npm run dev &gt; /tmp/api.log 2&gt;&amp;1 &amp;\ncd web &amp;&amp; npm run dev &gt; /tmp/web.log 2&gt;&amp;1 &amp;\n</code></pre></p>"},{"location":"handbook/DEVELOPMENT/#4-run-pre-flight-check","title":"4. Run Pre-Flight Check","text":"<pre><code>make preflight\n</code></pre>"},{"location":"handbook/DEVELOPMENT/#5-user-testing","title":"5. User Testing","text":"<p>Only proceed to user testing if pre-flight check passes with exit code 0.</p>"},{"location":"handbook/DEVELOPMENT/#critical-requirements","title":"\ud83d\udea8 Critical Requirements","text":""},{"location":"handbook/DEVELOPMENT/#before-asking-user-to-test","title":"Before Asking User to Test","text":"<ul> <li> Pre-flight check passes</li> <li> Both API and frontend servers are running</li> <li> No console errors in API logs</li> <li> User can log in (validated by pre-flight)</li> <li> Seed data is valid (validated by pre-flight)</li> </ul>"},{"location":"handbook/DEVELOPMENT/#after-making-changes","title":"After Making Changes","text":"<ul> <li> Restart affected services</li> <li> Run pre-flight check again</li> <li> Test the specific change manually</li> <li> Check for console errors</li> <li> Verify no regressions in related features</li> </ul>"},{"location":"handbook/DEVELOPMENT/#common-issues-fixes","title":"\ud83d\udee0 Common Issues &amp; Fixes","text":""},{"location":"handbook/DEVELOPMENT/#site-isnt-running","title":"\"Site isn't running\"","text":"<pre><code># Check processes\nps aux | grep -E \"(tsx|vite|node)\"\n\n# Restart API\ncd api &amp;&amp; npm run dev\n\n# Restart Frontend\ncd web &amp;&amp; npm run dev\n\n# Verify\nmake preflight\n</code></pre>"},{"location":"handbook/DEVELOPMENT/#cant-log-in","title":"\"Can't log in\"","text":"<pre><code># Re-seed database\nmake db-seed\n\n# Check seed data\nmake db-test-seed\n\n# Verify SSO IDs match\ncd api &amp;&amp; npx tsx -e \"\nimport { PrismaClient } from '@prisma/client';\nconst prisma = new PrismaClient();\nprisma.user.findMany({ where: { tenantId: (await prisma.tenant.findUnique({ where: { slug: 'default' } })).id }, select: { email: true, ssoId: true } }).then(console.log);\n\"\n</code></pre>"},{"location":"handbook/DEVELOPMENT/#no-data-in-ui","title":"\"No data in UI\"","text":"<pre><code># Check if seed ran successfully\nmake db-test-seed\n\n# Check data in database\ncd api &amp;&amp; npx tsx -e \"\nimport { PrismaClient } from '@prisma/client';\nconst prisma = new PrismaClient();\nconst tenant = await prisma.tenant.findUnique({ where: { slug: 'default' } });\nconsole.log({\n  users: await prisma.user.count({ where: { tenantId: tenant.id } }),\n  questions: await prisma.question.count({ where: { tenantId: tenant.id } }),\n  pulseResponses: await prisma.pulseResponse.count({ where: { tenantId: tenant.id } })\n});\n\"\n\n# Re-seed if needed\nmake db-seed\n</code></pre>"},{"location":"handbook/DEVELOPMENT/#seed-data-expectations","title":"\ud83d\udcca Seed Data Expectations","text":"<p>After running <code>make db-seed</code>, the system should have:</p>"},{"location":"handbook/DEVELOPMENT/#users-5","title":"Users (5)","text":"<ul> <li><code>admin@demo.pulsestage.dev</code> (admin role)</li> <li><code>alice@demo.pulsestage.dev</code> (moderator)</li> <li><code>bob@demo.pulsestage.dev</code> (member)</li> <li><code>diana@demo.pulsestage.dev</code> (member)</li> <li><code>charlie@demo.pulsestage.dev</code> (member)</li> </ul> <p>All users have SSO IDs matching their email prefix (e.g., <code>admin</code>, <code>alice</code>, etc.)</p>"},{"location":"handbook/DEVELOPMENT/#teams-4","title":"Teams (4)","text":"<ul> <li>General (all users)</li> <li>Engineering (5 open + 5 answered questions)</li> <li>People (5 open + 5 answered questions)</li> <li>Product (5 open + 5 answered questions)</li> </ul>"},{"location":"handbook/DEVELOPMENT/#qa-questions-36-total","title":"Q&amp;A Questions (36 total)","text":"<ul> <li>At least 20 questions across all teams</li> <li>Mix of open and answered status</li> <li>Mix of priorities and tags</li> </ul>"},{"location":"handbook/DEVELOPMENT/#pulse-data","title":"Pulse Data","text":"<ul> <li>10 active pulse questions</li> <li>8 weeks of historical responses (\u226550 total)</li> <li>~70% participation rate</li> <li>5-35 pending invites for users</li> <li>2 cohorts with user assignments</li> </ul>"},{"location":"handbook/DEVELOPMENT/#tenant","title":"Tenant","text":"<ul> <li>Slug: <code>default</code></li> <li>Name: \"Default Organization\"</li> <li>Pulse feature enabled</li> </ul>"},{"location":"handbook/DEVELOPMENT/#best-practices","title":"\ud83c\udf93 Best Practices","text":""},{"location":"handbook/DEVELOPMENT/#1-always-use-make-commands","title":"1. Always Use <code>make</code> Commands","text":"<p>Don't run scripts directly. Use the Makefile commands: - [OK] <code>make db-seed</code> - [OK] <code>make preflight</code> - [OK] <code>make db-test-seed</code> - [ERROR] <code>cd api &amp;&amp; npx tsx scripts/...</code></p>"},{"location":"handbook/DEVELOPMENT/#2-validate-before-requesting-user-testing","title":"2. Validate Before Requesting User Testing","text":"<pre><code># Good workflow\nmake db-seed\nmake preflight  # \u2190 REQUIRED\n# [only if exit code 0] \"Please test feature X at URL Y\"\n\n# Bad workflow\nmake db-seed\n# \"Please test feature X\" \u2190 Missing pre-flight!\n</code></pre>"},{"location":"handbook/DEVELOPMENT/#3-check-logs-when-debugging","title":"3. Check Logs When Debugging","text":"<pre><code># API logs (if running in background)\ntail -f /tmp/api.log\n\n# Frontend logs\ntail -f /tmp/web.log\n\n# Docker services\ndocker-compose logs -f postgres\ndocker-compose logs -f redis\n</code></pre>"},{"location":"handbook/DEVELOPMENT/#4-restart-services-after-code-changes","title":"4. Restart Services After Code Changes","text":"<p>Code changes requiring restart: - Authentication logic - Database queries - Environment variables - Session management</p> <p>Code changes NOT requiring restart (hot reload): - React components (frontend) - API route handlers (with tsx watch) - Styles</p>"},{"location":"handbook/DEVELOPMENT/#seed-architecture","title":"\ud83c\udfd7\ufe0f Seed Architecture","text":""},{"location":"handbook/DEVELOPMENT/#design-principle","title":"Design Principle","text":"<p>Reusable logic in <code>src/</code>, CLI scripts as thin wrappers.</p> <p>This architectural decision ensures: - Seed logic is compiled by TypeScript (<code>tsconfig.json</code> includes <code>src/</code>) - Functions can be imported by API endpoints (e.g., <code>/admin/reset-demo</code>) - CLI scripts remain simple entry points for manual execution - Docker builds include all necessary code in <code>dist/</code></p>"},{"location":"handbook/DEVELOPMENT/#directory-structure","title":"Directory Structure","text":"<pre><code>api/\n\u251c\u2500\u2500 src/\n\u2502   \u251c\u2500\u2500 seed/                 # Reusable seed modules\n\u2502   \u2502   \u2514\u2500\u2500 pulse-invites.ts  # Pulse invite seeding logic\n\u2502   \u251c\u2500\u2500 seed-demo-data.ts     # Q&amp;A demo data seeding\n\u2502   \u251c\u2500\u2500 seed-pulse-data.ts    # Pulse historical data seeding\n\u2502   \u251c\u2500\u2500 seed-teams.ts         # Team seeding\n\u2502   \u2514\u2500\u2500 app.ts                # API imports from src/\n\u2514\u2500\u2500 scripts/\n    \u251c\u2500\u2500 reset-and-seed-all.ts # CLI wrapper\n    \u251c\u2500\u2500 seed-pulse-demo.ts    # CLI wrapper\n    \u2514\u2500\u2500 seed-pulse-invites.ts # CLI wrapper\n</code></pre>"},{"location":"handbook/DEVELOPMENT/#rules","title":"Rules","text":"<ol> <li><code>src/</code> files contain all business logic and are compiled to <code>dist/</code></li> <li><code>scripts/</code> files are thin wrappers that call functions from <code>src/</code></li> <li>NEVER import from <code>scripts/</code> in <code>src/</code> files - breaks compilation</li> <li>Always test TypeScript builds before pushing Docker changes</li> </ol>"},{"location":"handbook/DEVELOPMENT/#example-pulse-invites","title":"Example: Pulse Invites","text":"<p>Reusable Logic (<code>src/seed/pulse-invites.ts</code>): <pre><code>export async function seedPulseInvites(tenantSlug = 'default', userLimit = 10) {\n  // Core business logic\n  const tenant = await prisma.tenant.findUnique({ where: { slug: tenantSlug } });\n  // ... create invites ...\n  return createdCount;\n}\n</code></pre></p> <p>CLI Wrapper (<code>scripts/seed-pulse-invites.ts</code>): <pre><code>import { seedPulseInvites } from '../src/seed/pulse-invites.js';\n\nasync function main() {\n  await seedPulseInvites('default', 10);\n}\n\nmain();\n</code></pre></p> <p>API Usage (<code>src/app.ts</code>): <pre><code>const { seedPulseInvites } = await import('./seed/pulse-invites.js');\nawait seedPulseInvites('default', 10);\n</code></pre></p>"},{"location":"handbook/DEVELOPMENT/#why-this-matters","title":"Why This Matters","text":"<p>Problem: Importing from <code>scripts/</code> in <code>src/</code> files causes <code>MODULE_NOT_FOUND</code> errors in production because: - <code>tsconfig.json</code> only compiles <code>src/</code> directory (<code>\"include\": [\"src\"]</code>) - <code>scripts/</code> files are NOT copied to <code>dist/</code> in Docker builds - Runtime imports fail when deployed</p> <p>Solution: Keep all reusable logic in <code>src/</code>, use <code>scripts/</code> only for CLI entry points.</p>"},{"location":"handbook/DEVELOPMENT/#debugging-checklist","title":"Debugging Checklist","text":"<p>When something isn't working:</p> <ol> <li> <p>Check Services <pre><code>docker-compose ps\nps aux | grep -E \"(tsx|vite)\"\n</code></pre></p> </li> <li> <p>Check Connectivity <pre><code>curl http://localhost:3000/health\ncurl http://localhost:5173\n</code></pre></p> </li> <li> <p>Check Database <pre><code>make db-test-seed\n</code></pre></p> </li> <li> <p>Check Logs</p> </li> <li>Look for errors in API logs</li> <li>Check browser console for frontend errors</li> <li> <p>Check Docker logs for service issues</p> </li> <li> <p>Run Pre-Flight <pre><code>make preflight\n</code></pre></p> </li> <li> <p>If All Else Fails - Full Reset <pre><code># Kill all processes\nsudo killall -9 node tsx\n\n# Restart services\ndocker-compose restart\n\n# Re-seed\nmake db-seed\n\n# Start servers\ncd api &amp;&amp; npm run dev &gt; /tmp/api.log 2&gt;&amp;1 &amp;\ncd web &amp;&amp; npm run dev &gt; /tmp/web.log 2&gt;&amp;1 &amp;\n\n# Validate\nsleep 10 &amp;&amp; make preflight\n</code></pre></p> </li> </ol>"},{"location":"handbook/DEVELOPMENT/#ai-assistant-workflow","title":"AI Assistant Workflow","text":""},{"location":"handbook/DEVELOPMENT/#required-steps-before-requesting-user-testing","title":"Required Steps Before Requesting User Testing","text":"<ol> <li>Make Changes</li> <li>Implement feature</li> <li>Update seed data if needed</li> <li> <p>Update tests if needed</p> </li> <li> <p>Restart Affected Services <pre><code># If API changes\ncd api &amp;&amp; npm run dev\n\n# If Frontend changes (usually not needed due to hot reload)\ncd web &amp;&amp; npm run dev\n</code></pre></p> </li> <li> <p>Run Pre-Flight Check <pre><code>make preflight\n</code></pre></p> </li> <li> <p>Check Exit Code</p> </li> <li>If <code>0</code>: Proceed to step 5</li> <li> <p>If <code>1</code>: Debug issues, fix, repeat from step 2</p> </li> <li> <p>Request User Testing</p> </li> <li>Provide specific URL to test</li> <li>Describe what to look for</li> <li>Mention any known limitations</li> </ol>"},{"location":"handbook/DEVELOPMENT/#example-output","title":"Example Output","text":"<pre><code>[OK] Pre-flight check passed! Ready for testing.\n\nPlease test the new Pulse Dashboard feature:\n1. Log in as admin@demo.pulsestage.dev\n2. Navigate to http://localhost:5173/admin/pulse\n3. You should see 8 weeks of pulse data with charts\n\nExpected behavior:\n- Overall trend chart shows 8 data points\n- Participation rate shows ~70%\n- Question breakdowns display individual trends\n</code></pre>"},{"location":"handbook/DEVELOPMENT/#quick-reference","title":"Quick Reference","text":""},{"location":"handbook/DEVELOPMENT/#daily-development-start","title":"Daily Development Start","text":"<pre><code>docker-compose up -d    # Start Docker services\nmake db-seed           # Ensure fresh data\ncd api &amp;&amp; npm run dev  # Terminal 1\ncd web &amp;&amp; npm run dev  # Terminal 2\nmake preflight         # Validate\n</code></pre>"},{"location":"handbook/DEVELOPMENT/#after-making-changes_1","title":"After Making Changes","text":"<pre><code># [restart services if needed]\nmake preflight         # Always validate\n</code></pre>"},{"location":"handbook/DEVELOPMENT/#troubleshooting","title":"Troubleshooting","text":"<pre><code>make preflight         # See what's broken\nmake db-seed          # Fix seed data issues\ndocker-compose restart # Fix Docker issues\n</code></pre> <p>Remember: The pre-flight check is not optional. It's a required step before every user testing request.</p>"},{"location":"handbook/NONFUNCTIONAL/","title":"Non-Functional Requirements","text":""},{"location":"handbook/NONFUNCTIONAL/#slos-demo","title":"SLOs (demo)","text":"<ul> <li>API p95 latency &lt; 400 ms</li> <li>SSE reconnect &lt; 3 s</li> <li>Error rate &lt; 0.5% on happy paths</li> </ul>"},{"location":"handbook/NONFUNCTIONAL/#rate-limits","title":"Rate Limits","text":"<ul> <li>Per-tenant &amp; per-IP to prevent noisy neighbors</li> </ul>"},{"location":"handbook/NONFUNCTIONAL/#retention","title":"Retention","text":"<ul> <li>Pulse invites: 90 days</li> <li>Pulse aggregates &amp; AMA content: configurable per-tenant</li> </ul>"},{"location":"handbook/OPERATIONS/","title":"Operations (Runbook)","text":""},{"location":"handbook/OPERATIONS/#services-architecture","title":"Services Architecture","text":""},{"location":"handbook/OPERATIONS/#development-services","title":"Development Services","text":"<p>PulseStage development uses Docker Compose to orchestrate 5 services:</p>"},{"location":"handbook/OPERATIONS/#1-api-server","title":"1. API Server","text":"<ul> <li>Image: <code>ghcr.io/seanmdalton/pulsestage-api:latest</code> (or local <code>pulsestage-api:latest</code>)</li> <li>Port: 3000</li> <li>Technology: Node.js + Express + Prisma</li> <li>Dependencies: PostgreSQL (required), Redis (optional in dev)</li> <li>Hot Reload: Enabled via volume mounts</li> </ul>"},{"location":"handbook/OPERATIONS/#2-web-frontend","title":"2. Web Frontend","text":"<ul> <li>Image: <code>ghcr.io/seanmdalton/pulsestage-web:latest</code> (or local <code>pulsestage-web:latest</code>)</li> <li>Port: 5173</li> <li>Technology: Vite + React + TypeScript</li> <li>Hot Reload: Enabled</li> <li>API URL: <code>http://localhost:3000</code></li> </ul>"},{"location":"handbook/OPERATIONS/#3-postgresql-database","title":"3. PostgreSQL Database","text":"<ul> <li>Image: <code>postgres:16-alpine</code></li> <li>Port: 5432</li> <li>Database: <code>ama</code></li> <li>User/Password: <code>app/app</code> (development only)</li> <li>Persistence: Docker volume <code>pgdata</code></li> </ul>"},{"location":"handbook/OPERATIONS/#4-redis-optional-in-dev","title":"4. Redis (Optional in Dev)","text":"<ul> <li>Image: <code>redis:7-alpine</code></li> <li>Port: 6379</li> <li>Purpose: </li> <li>Session storage (optional in dev, uses memory fallback)</li> <li>Rate limiting (disabled in dev)</li> <li>Email queue (optional in dev)</li> <li>Note: Not required for basic development</li> </ul>"},{"location":"handbook/OPERATIONS/#5-mailpit-development-only","title":"5. Mailpit (Development Only)","text":"<ul> <li>Image: <code>axllent/mailpit:latest</code></li> <li>Ports: </li> <li>8025 (Web UI for viewing emails)</li> <li>1025 (SMTP server)</li> <li>Purpose: Local email testing (captures all outbound emails)</li> <li>Web UI: <code>http://localhost:8025</code></li> <li>Not used in production - Replace with real SMTP or Resend</li> </ul>"},{"location":"handbook/OPERATIONS/#production-services","title":"Production Services","text":"<p>Production deployments require:</p> <ol> <li>API Server (Node.js)</li> <li>Redis REQUIRED (sessions + rate limiting + email queue)</li> <li>OAuth configured (GitHub/Google)</li> <li> <p>HTTPS enabled</p> </li> <li> <p>Web Frontend (Static files via nginx)</p> </li> <li>Served via CDN or nginx</li> <li> <p>Environment variables baked at build time</p> </li> <li> <p>PostgreSQL (Managed database recommended)</p> </li> <li>AWS RDS, Google Cloud SQL, or self-hosted</li> <li>Automated backups</li> <li> <p>Connection pooling</p> </li> <li> <p>Redis (Managed cache recommended)</p> </li> <li>AWS ElastiCache, Google Memorystore, or self-hosted</li> <li>Persistence enabled</li> <li> <p>REQUIRED for production</p> </li> <li> <p>Email Service</p> </li> <li>SMTP server (self-hosted or provider)</li> <li>OR Resend (recommended)</li> <li>Mailpit NOT used in production</li> </ol>"},{"location":"handbook/OPERATIONS/#development-vs-production","title":"Development vs Production","text":"Feature Development Production API Server Docker (hot reload) Kubernetes/ECS/VM Web Frontend Vite dev server (port 5173) Nginx static files PostgreSQL Docker (postgres:16-alpine) Managed database (RDS, etc.) Redis Optional (Docker) Required (ElastiCache, etc.) Email Mailpit (local capture) SMTP or Resend (live delivery) Authentication Demo mode enabled OAuth only (GitHub/Google) Rate Limiting Disabled Enabled (Redis-based) Sessions Memory store Redis store HTTPS Optional Required"},{"location":"handbook/OPERATIONS/#development-environment","title":"Development Environment","text":""},{"location":"handbook/OPERATIONS/#local-docker-build-system","title":"Local Docker Build System","text":"<ul> <li><code>make build</code> - Build local Docker images (<code>pulsestage-api:latest</code>, <code>pulsestage-web:latest</code>)</li> <li><code>docker-compose.yaml</code> - Production config (references <code>ghcr.io</code> images)</li> <li><code>docker-compose.override.yaml</code> - Development override (uses local image tags)</li> <li>Purpose: Security scanning with Trivy on local builds before push</li> </ul>"},{"location":"handbook/OPERATIONS/#key-commands","title":"Key Commands","text":"<ul> <li><code>make preflight</code> - [REQUIRED] Validate entire dev environment before user testing</li> <li><code>make validate-ci</code> - Run ALL CI checks locally (tests, linting, formatting, security)</li> <li><code>make dev</code> - Start development (foreground, hot reload)</li> <li><code>make up</code> - Start services in background (hot reload)</li> <li><code>make down</code> - Stop all services</li> <li><code>make db-seed</code> - Reset &amp; seed all data (idempotent)</li> <li><code>make security</code> - Run Trivy scans on local images</li> </ul>"},{"location":"handbook/OPERATIONS/#demo-mode-development-only","title":"Demo Mode (Development Only)","text":"<ul> <li>Endpoint: <code>GET /auth/demo?user={username}&amp;tenant={tenant}</code></li> <li>Demo users: <code>admin</code>, <code>alice</code>, <code>bob</code>, <code>moderator</code></li> <li>Email format: <code>{username}@pulsestage.app</code></li> <li>SSO IDs: Same as username (e.g., <code>admin</code>, not <code>demo-admin</code>)</li> <li>Demo data: 50 users, 2 teams (Engineering, Product), 12 weeks pulse history</li> <li>NOT available in production (security requirement)</li> </ul>"},{"location":"handbook/OPERATIONS/#email-testing-with-mailpit","title":"Email Testing with Mailpit","text":"<ul> <li>Web UI: <code>http://localhost:8025</code> - View all captured emails</li> <li>SMTP Server: <code>localhost:1025</code> - Application sends here</li> <li>Purpose: Test email templates and delivery without sending real emails</li> <li>All emails captured locally - Nothing sent externally</li> <li>Mailpit is development-only - Not used in production</li> </ul>"},{"location":"handbook/OPERATIONS/#rate-limiting-in-development","title":"Rate Limiting in Development","text":"<ul> <li>Status: Disabled (for ease of development)</li> <li>Reason: Allows rapid testing without hitting limits</li> <li>Production: Rate limiting REQUIRED (Redis-based, per-tenant/IP)</li> <li>See: <code>/handbook/SECURITY_MODEL.md</code> for rate limit details</li> </ul>"},{"location":"handbook/OPERATIONS/#health-probes","title":"Health Probes","text":""},{"location":"handbook/OPERATIONS/#endpoints","title":"Endpoints","text":"<ul> <li><code>GET /health</code> - Basic health check (always returns 200 if process alive)</li> <li><code>GET /health/live</code> - Liveness probe (Kubernetes-compatible)</li> <li><code>GET /health/ready</code> - Readiness probe (DB + Redis healthy, migrations complete)</li> </ul>"},{"location":"handbook/OPERATIONS/#health-check-details","title":"Health Check Details","text":"<p><code>/health</code> Response: <pre><code>{\n  \"status\": \"ok\",\n  \"timestamp\": \"2025-01-15T14:23:45Z\"\n}\n</code></pre></p> <p><code>/health/ready</code> Response (Success): <pre><code>{\n  \"status\": \"ready\",\n  \"checks\": {\n    \"database\": \"ok\",\n    \"redis\": \"ok\",\n    \"migrations\": \"ok\"\n  }\n}\n</code></pre></p> <p><code>/health/ready</code> Response (Failure): <pre><code>{\n  \"status\": \"not_ready\",\n  \"checks\": {\n    \"database\": \"ok\",\n    \"redis\": \"failed\",\n    \"migrations\": \"ok\"\n  }\n}\n</code></pre></p>"},{"location":"handbook/OPERATIONS/#kubernetes-configuration","title":"Kubernetes Configuration","text":"<pre><code>livenessProbe:\n  httpGet:\n    path: /health/live\n    port: 3000\n  initialDelaySeconds: 10\n  periodSeconds: 30\n\nreadinessProbe:\n  httpGet:\n    path: /health/ready\n    port: 3000\n  initialDelaySeconds: 5\n  periodSeconds: 10\n</code></pre>"},{"location":"handbook/OPERATIONS/#backups","title":"Backups","text":"<ul> <li>Nightly pg_dump; weekly roles; 7\u201314 day retention</li> <li>Restore test monthly</li> </ul>"},{"location":"handbook/OPERATIONS/#observability","title":"Observability","text":"<ul> <li>JSON logs with tenantId/requestId</li> <li>Metrics: http reqs/latency/errors, SSE connections, pulse sends/responses</li> </ul>"},{"location":"handbook/OPERATIONS/#pre-flight-validation","title":"Pre-Flight Validation","text":"<p>Before requesting user testing, ALWAYS run: <pre><code>make preflight\n</code></pre> Validates: Docker services, DB connectivity, API health, frontend access, auth flow, seed data integrity, core endpoints.</p>"},{"location":"handbook/PERSONAS/","title":"Personas (max 4)","text":""},{"location":"handbook/PERSONAS/#participant-employee","title":"Participant (Employee)","text":"<ul> <li>Jobs: submit/upvote questions, respond to weekly pulse, see answers/results</li> <li>Context: Has a primary team; pulse surveys are team-specific</li> <li>Must haves: anonymity, 1-tap flows, mobile friendly</li> </ul>"},{"location":"handbook/PERSONAS/#moderator-meeting-runner-comms","title":"Moderator (Meeting runner / Comms)","text":"<ul> <li>Jobs: curate/merge/flag questions, run the live queue, summarize outcomes</li> <li>Context: Team-scoped access; manages questions for assigned teams only</li> <li>Must haves: keyboard shortcuts, moderation tools, audit trail, team selector</li> </ul>"},{"location":"handbook/PERSONAS/#leader-presenter-exec","title":"Leader (Presenter / Exec)","text":"<ul> <li>Jobs: present Q&amp;A cleanly, see pulse trends &amp; movers, assign actions</li> <li>Context: Views team-specific dashboards with \"All Teams\" rollup option</li> <li>Must haves: presenter mode, trend heatmap, simple exports, team filtering</li> </ul>"},{"location":"handbook/PERSONAS/#tenant-admin-ithr-owner","title":"Tenant Admin (IT/HR owner)","text":"<ul> <li>Jobs: configure SSO, tenant settings, pulse cadence, thresholds, exports</li> <li>Context: Global access across all teams within tenant</li> <li>Must haves: strict RBAC, audit log, backups/retention, feature flags, team management</li> </ul>"},{"location":"handbook/PRODUCT_VISION/","title":"PulseStage \u2014 Product Vision (1-pager)","text":""},{"location":"handbook/PRODUCT_VISION/#problem","title":"Problem","text":"<p>Town halls and engagement surveys are noisy, infrequent, and slow to close the loop. Leaders need a clear way to hear questions, respond live, and track sentiment continuously\u2014without heavy process or vendor lock-in.</p>"},{"location":"handbook/PRODUCT_VISION/#what-pulsestage-is","title":"What PulseStage Is","text":"<ul> <li>Open-source, tenant-aware Q&amp;A + weekly micro-pulse listening</li> <li>Team-first architecture with organizational rollup views</li> <li>Real-time presenter UX; anonymous, up-vote\u2013only questions</li> <li>Lightweight pulse signals integrated with all-hands follow-through</li> </ul>"},{"location":"handbook/PRODUCT_VISION/#key-features","title":"Key Features","text":""},{"location":"handbook/PRODUCT_VISION/#1-presentation-mode","title":"1. Presentation Mode","text":"<ul> <li>Full-screen display for team meetings and all-hands</li> <li>Keyboard-driven navigation (Space/Enter=next, H=highest upvoted, Esc=exit)</li> <li>Auto-tagging questions as \"Currently Presenting\"</li> <li>Real-time updates via Server-Sent Events (SSE)</li> <li>Team-scoped questions for focused discussions</li> <li>Permission-gated (moderators and admins only)</li> </ul> <p>Use Case: Project on screen during meetings, navigate through questions live, team sees answers in real-time.</p>"},{"location":"handbook/PRODUCT_VISION/#2-powerful-search-filtering","title":"2. Powerful Search &amp; Filtering","text":"<ul> <li>Full-text search with PostgreSQL (stemming + prefix matching)</li> <li>Tag filtering (custom tags + defaults: Feature Request, Bug, Question, etc.)</li> <li>Date range filtering for historical analysis</li> <li>Team filtering for scoped views</li> <li>Ranked results by relevance</li> </ul> <p>Use Case: Find related questions quickly, filter by topic/team/timeframe.</p>"},{"location":"handbook/PRODUCT_VISION/#3-customizable-theming-branding","title":"3. Customizable Theming &amp; Branding","text":"<ul> <li>3 professionally designed themes:</li> <li>Executive Blue: Corporate, trustworthy</li> <li>Modern Purple: Creative, innovative</li> <li>Refined Teal: Balanced, modern (default)</li> <li>Light/Dark mode toggle (per-user preference)</li> <li>System theme detection (respects OS preference)</li> <li>Custom branding:</li> <li>Logo URL</li> <li>Favicon URL</li> <li>Primary/accent color overrides</li> <li>Welcome message</li> <li>Live preview of theme changes</li> </ul> <p>Use Case: White-label deployment, match company branding, A/B test themes.</p>"},{"location":"handbook/PRODUCT_VISION/#4-content-moderation","title":"4. Content Moderation","text":"<ul> <li>Cascading filters (local + optional OpenAI)</li> <li>Tiered response: Auto-reject (high confidence) or review queue (medium/low)</li> <li>Team-scoped moderation queue for moderators</li> <li>Comprehensive audit trail of all moderation actions</li> </ul> <p>See: <code>/handbook/TRUST_AND_SAFETY.md</code></p>"},{"location":"handbook/PRODUCT_VISION/#5-multi-mode-authentication","title":"5. Multi-Mode Authentication","text":"<ul> <li>GitHub OAuth (production-ready)</li> <li>Google OAuth (production-ready)</li> <li>Demo mode (development only)</li> <li>Session management with Redis (production) or memory (development)</li> </ul> <p>See: <code>/handbook/AUTHENTICATION.md</code></p>"},{"location":"handbook/PRODUCT_VISION/#6-email-notifications","title":"6. Email Notifications","text":"<ul> <li>BullMQ queue with Redis backend</li> <li>Multiple providers (SMTP, Resend)</li> <li>React-email templates for beautiful emails</li> <li>Admin monitoring (queue metrics, failed jobs)</li> <li>Development testing with Mailpit (local email capture)</li> </ul> <p>See: <code>/handbook/INTEGRATIONS/EMAIL.md</code></p>"},{"location":"handbook/PRODUCT_VISION/#7-weekly-pulse-system","title":"7. Weekly Pulse System","text":"<ul> <li>Rotating cohorts for distributed survey load</li> <li>One-tap email responses (no login required)</li> <li>Anonymity-first design (no userId in responses)</li> <li>Threshold enforcement (only show aggregates when n \u2265 5)</li> <li>Team-scoped with organizational rollups</li> </ul> <p>See: <code>/handbook/PULSE_SYSTEM.md</code></p>"},{"location":"handbook/PRODUCT_VISION/#principles-truths-invariants","title":"Principles (Truths &amp; Invariants)","text":"<ul> <li>Tenant isolation is absolute (data, auth, search, metrics).</li> <li>Anonymous by default; only aggregates above threshold are shown.</li> <li>Contracts &gt; code: OpenAPI, event schemas, and DB invariants are source of truth.</li> <li>Accessibility &amp; performance are features, not afterthoughts.</li> </ul>"},{"location":"handbook/PRODUCT_VISION/#out-of-scope-for-now","title":"Out of Scope (for now)","text":"<ul> <li>HRIS/SCIM deep integrations, advanced analytics modeling, custom role builders.</li> </ul>"},{"location":"handbook/PULSE_SYSTEM/","title":"Weekly Pulse System","text":"<p>Purpose: Regular, anonymous team pulse checks with rotating questions and cohorts.</p> <p>Key Principle: Anonymity-first design - responses cannot be traced to individuals.</p>"},{"location":"handbook/PULSE_SYSTEM/#overview","title":"Overview","text":"<p>The Pulse system sends weekly check-in questions to users via email, collecting anonymous sentiment data while respecting privacy.</p>"},{"location":"handbook/PULSE_SYSTEM/#core-guarantees","title":"Core Guarantees","text":"<ol> <li>Anonymity: Responses stored WITHOUT user ID</li> <li>Threshold Enforcement: Aggregates only shown when n \u2265 threshold (default: 5)</li> <li>Team-Scoped: Questions and responses associated with teams</li> <li>Rotating Cohorts: Different users receive different questions</li> <li>One-Tap Response: Email links with unique tokens (no login required)</li> </ol>"},{"location":"handbook/PULSE_SYSTEM/#architecture","title":"Architecture","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  Pulse Schedule \u2502  (Cron: daily at 9:00 AM)\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502\n         \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Cohort Selector \u2502  (Which cohort gets pulse today?)\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502\n         \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502Question Rotation\u2502  (Round-robin through active questions)\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502\n         \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Invite Generator\u2502  (Create unique tokens, send emails)\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502\n         \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Email Delivery  \u2502  (BullMQ queue \u2192 user inboxes)\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502\n         \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  User Response  \u2502  (One-tap email link)\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502\n         \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Store Response  \u2502  (NO user ID, only score + team + question)\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502\n         \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  Aggregation    \u2502  (Calculate team averages, check threshold)\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"handbook/PULSE_SYSTEM/#cohort-system","title":"Cohort System","text":"<p>Purpose: Distribute questions evenly, avoid survey fatigue.</p>"},{"location":"handbook/PULSE_SYSTEM/#what-is-a-cohort","title":"What is a Cohort?","text":"<p>A cohort is a group of users who receive pulse invites on the same day(s) of the week.</p> <p>Example: - Weekday Cohort (Mon-Fri): 60% of users - Weekend Cohort (Sat-Sun): 40% of users</p>"},{"location":"handbook/PULSE_SYSTEM/#cohort-assignment","title":"Cohort Assignment","text":"<p>Created during seeding or user onboarding: <pre><code>// Deterministic assignment based on user ID\nconst cohortIndex = hashUserId(user.id) % numCohorts\nassignUserToCohort(user, `cohort-${cohortIndex}`)\n</code></pre></p> <p>Result: Each user belongs to exactly one cohort.</p>"},{"location":"handbook/PULSE_SYSTEM/#rotation-schedule","title":"Rotation Schedule","text":"<p>Daily rotation (default: 9:00 AM): <pre><code>Day of Week \u2192 Cohort Index\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nMonday    (1) \u2192 Cohort 0\nTuesday   (2) \u2192 Cohort 1\nWednesday (3) \u2192 Cohort 2\nThursday  (4) \u2192 Cohort 3\nFriday    (5) \u2192 Cohort 4\nSaturday  (6) \u2192 Cohort 4 (wrap around)\nSunday    (0) \u2192 Cohort 4 (wrap around)\n</code></pre></p> <p>Simplified (2 cohorts): <pre><code>Weekday  \u2192 Cohort 0\nWeekend  \u2192 Cohort 1\n</code></pre></p>"},{"location":"handbook/PULSE_SYSTEM/#benefits","title":"Benefits","text":"<ol> <li>Load Distribution: Not all users get pulse on same day</li> <li>Question Variety: Each cohort gets different questions</li> <li>Participation Boost: Less survey fatigue</li> <li>Daily Freshness: New responses every day</li> </ol>"},{"location":"handbook/PULSE_SYSTEM/#question-management","title":"Question Management","text":""},{"location":"handbook/PULSE_SYSTEM/#question-types","title":"Question Types","text":"<p>All pulse questions share: - Short text (max 200 characters) - Likert scale response (1-5) - Active/inactive status - Team association (optional)</p> <p>Example Questions: - \"How satisfied are you with work-life balance?\" - \"Do you have the resources needed to succeed?\" - \"How engaged do you feel with your work?\" - \"Rate your team collaboration this week\"</p>"},{"location":"handbook/PULSE_SYSTEM/#question-rotation","title":"Question Rotation","text":"<p>Round-robin algorithm: <pre><code>const questions = getActiveQuestions(tenantId)\nconst cohortIndex = getCohortIndex(cohortName)  // \"weekday-0\" \u2192 0\nconst questionIndex = cohortIndex % questions.length\nconst selectedQuestion = questions[questionIndex]\n</code></pre></p> <p>Result: Each cohort gets a different question, cycles through all questions over time.</p>"},{"location":"handbook/PULSE_SYSTEM/#admin-management","title":"Admin Management","text":"<p>Endpoints: - <code>GET /admin/pulse/questions</code> - List all questions - <code>POST /admin/pulse/questions</code> - Create new question - <code>PUT /admin/pulse/questions/:id</code> - Update question - <code>DELETE /admin/pulse/questions/:id</code> - Deactivate question</p> <p>UI: Admin panel (planned)</p>"},{"location":"handbook/PULSE_SYSTEM/#invite-system","title":"Invite System","text":""},{"location":"handbook/PULSE_SYSTEM/#invite-generation","title":"Invite Generation","text":"<p>When cron runs: 1. Determine today's cohort 2. Select question (round-robin) 3. Get users in cohort 4. For each user:    - Generate unique token (UUID)    - Create PulseInvite record    - Queue email job</p> <p>Invite Record: <pre><code>{\n  id: \"uuid\",\n  token: \"unique-token-abc123\",\n  userId: \"user-uuid\",\n  questionId: \"question-uuid\",\n  cohortName: \"weekday-0\",\n  teamId: user.primaryTeamId,  // Associated with user's primary team\n  sentAt: \"2025-01-15T09:00:00Z\",\n  expiresAt: \"2025-01-22T09:00:00Z\",  // 7 days\n  respondedAt: null,  // Updated when user responds\n  tenantId: \"tenant-uuid\"\n}\n</code></pre></p>"},{"location":"handbook/PULSE_SYSTEM/#email-template","title":"Email Template","text":"<p>Subject: \"Weekly Pulse - How are you feeling?\"</p> <p>Body: <pre><code>Hi Alice,\n\nQuick check-in for this week:\n\n\"How satisfied are you with work-life balance?\"\n\n[1] [2] [3] [4] [5]\n(Click a number to respond - no login required!)\n\nYour response is anonymous and helps improve our team.\n\nLink expires in 7 days.\n\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nPulseStage \u2022 [Unsubscribe]\n</code></pre></p> <p>One-Tap Links: <pre><code>https://yourcompany.com/pulse/respond?token=abc123&amp;score=1\nhttps://yourcompany.com/pulse/respond?token=abc123&amp;score=2\nhttps://yourcompany.com/pulse/respond?token=abc123&amp;score=3\nhttps://yourcompany.com/pulse/respond?token=abc123&amp;score=4\nhttps://yourcompany.com/pulse/respond?token=abc123&amp;score=5\n</code></pre></p>"},{"location":"handbook/PULSE_SYSTEM/#token-security","title":"Token Security","text":"<ul> <li>Unique per invite: Cannot reuse tokens</li> <li>Single-use: Token invalidated after response</li> <li>Time-limited: 7-day expiration</li> <li>Unpredictable: UUID v4 (122 bits of entropy)</li> <li>HTTPS-only: Tokens transmitted securely (production)</li> </ul>"},{"location":"handbook/PULSE_SYSTEM/#response-flow","title":"Response Flow","text":""},{"location":"handbook/PULSE_SYSTEM/#user-experience","title":"User Experience","text":"<ol> <li>User receives email (9:00 AM on their cohort day)</li> <li>Clicks a score button (1-5)</li> <li>Redirected to confirmation page</li> <li>Response stored anonymously</li> <li>Thank you message displayed</li> </ol> <p>No login required. Token authenticates the invite.</p>"},{"location":"handbook/PULSE_SYSTEM/#backend-processing","title":"Backend Processing","text":"<p>Endpoint: <code>GET /pulse/respond?token=abc123&amp;score=4</code></p> <p>Flow: <pre><code>// 1. Validate token\nconst invite = await prisma.pulseInvite.findUnique({ where: { token } })\nif (!invite || invite.respondedAt || invite.expiresAt &lt; now) {\n  return error(\"Invalid or expired invite\")\n}\n\n// 2. Create response (NO userId!)\nawait prisma.pulseResponse.create({\n  data: {\n    inviteId: invite.id,\n    questionId: invite.questionId,\n    teamId: invite.teamId,\n    score: score,\n    respondedAt: now,\n    tenantId: invite.tenantId\n    // NOTE: NO userId field!\n  }\n})\n\n// 3. Mark invite as responded\nawait prisma.pulseInvite.update({\n  where: { id: invite.id },\n  data: { respondedAt: now }\n})\n\n// 4. Show confirmation page\nreturn \"Thank you! Your response has been recorded.\"\n</code></pre></p>"},{"location":"handbook/PULSE_SYSTEM/#anonymity-enforcement","title":"Anonymity Enforcement","text":"<p>Critical: <code>PulseResponse</code> table has NO <code>userId</code> field.</p> <p>Schema: <pre><code>model PulseResponse {\n  id          String   @id @default(uuid())\n  inviteId    String   // Link to invite (for deduplication)\n  questionId  String   // Which question\n  teamId      String?  // Which team (for team-scoped aggregates)\n  score       Int      // 1-5\n  respondedAt DateTime\n  tenantId    String   // Tenant isolation\n\n  // NO userId field!\n  // NO email field!\n  // NO IP address field!\n}\n</code></pre></p> <p>Result: Responses cannot be traced to individuals, even by admins.</p>"},{"location":"handbook/PULSE_SYSTEM/#aggregation-display","title":"Aggregation &amp; Display","text":""},{"location":"handbook/PULSE_SYSTEM/#threshold-enforcement","title":"Threshold Enforcement","text":"<p>Default threshold: 5 responses</p> <p>Rule: Only show aggregates when <code>count(responses) &gt;= threshold</code></p> <p>Example: <pre><code>// Team A: 12 responses \u2192 Show average\n// Team B: 3 responses \u2192 Show \"Insufficient responses\"\n</code></pre></p>"},{"location":"handbook/PULSE_SYSTEM/#aggregate-calculation","title":"Aggregate Calculation","text":"<p>Endpoint: <code>GET /pulse/summary?range=12w&amp;team=team-id</code></p> <p>Query: <pre><code>SELECT \n  questionId,\n  teamId,\n  COUNT(*) as responseCount,\n  AVG(score) as averageScore,\n  STDDEV(score) as stdDev,\n  MIN(respondedAt) as firstResponse,\n  MAX(respondedAt) as lastResponse\nFROM PulseResponse\nWHERE tenantId = :tenantId\n  AND respondedAt &gt;= :startDate\n  AND respondedAt &lt;= :endDate\n  AND (teamId = :teamId OR :teamId IS NULL)\nGROUP BY questionId, teamId\nHAVING COUNT(*) &gt;= :threshold  -- CRITICAL: Enforces threshold\n</code></pre></p>"},{"location":"handbook/PULSE_SYSTEM/#response-format","title":"Response Format","text":"<pre><code>{\n  \"summary\": {\n    \"totalResponses\": 847,\n    \"totalInvites\": 1040,\n    \"participationRate\": 81.4,\n    \"dateRange\": {\n      \"start\": \"2024-10-15\",\n      \"end\": \"2025-01-15\"\n    }\n  },\n  \"questions\": [\n    {\n      \"id\": \"question-uuid\",\n      \"text\": \"How satisfied are you with work-life balance?\",\n      \"responseCount\": 156,\n      \"averageScore\": 3.8,\n      \"trend\": {\n        \"weekly\": [\n          { \"week\": \"2024-W42\", \"avg\": 3.6, \"count\": 12 },\n          { \"week\": \"2024-W43\", \"avg\": 3.9, \"count\": 14 },\n          ...\n        ]\n      },\n      \"byTeam\": [\n        {\n          \"teamId\": \"team-uuid\",\n          \"teamName\": \"Engineering\",\n          \"responseCount\": 67,  // \u2265 5, show data\n          \"averageScore\": 3.7\n        },\n        {\n          \"teamId\": \"team-uuid-2\",\n          \"teamName\": \"Product\",\n          \"responseCount\": 3,   // &lt; 5, suppress\n          \"averageScore\": null,\n          \"message\": \"Insufficient responses to protect anonymity\"\n        }\n      ]\n    }\n  ]\n}\n</code></pre>"},{"location":"handbook/PULSE_SYSTEM/#visualization","title":"Visualization","text":"<p>Dashboard displays: - Line charts (weekly trends) - Bar charts (team comparisons, only if \u2265 threshold) - Participation rate - Top/bottom questions</p>"},{"location":"handbook/PULSE_SYSTEM/#scheduler","title":"Scheduler","text":"<p>Technology: node-cron</p> <p>Schedule: Daily at 9:00 AM (configurable)</p> <p>Script: <code>api/scripts/cron/send-pulse-invites.ts</code></p>"},{"location":"handbook/PULSE_SYSTEM/#cron-configuration","title":"Cron Configuration","text":"<pre><code>// Runs every day at 9:00 AM\ncron.schedule('0 9 * * *', async () =&gt; {\n  await processPulseSends(prisma)\n})\n</code></pre>"},{"location":"handbook/PULSE_SYSTEM/#processing-logic","title":"Processing Logic","text":"<pre><code>async function processPulseSends(prisma) {\n  // 1. Get all tenants\n  const tenants = await prisma.tenant.findMany()\n\n  for (const tenant of tenants) {\n    // 2. Check if pulse enabled\n    const settings = tenant.settings?.settings\n    if (!settings?.pulse?.enabled) continue\n\n    // 3. Get schedule\n    const schedule = await prisma.pulseSchedule.findUnique({\n      where: { tenantId: tenant.id }\n    })\n    if (!schedule || !schedule.rotatingCohorts) continue\n\n    // 4. Determine today's cohort\n    const cohortName = getTodaysCohort()\n\n    // 5. Send invites\n    await triggerPulseForCohort(prisma, tenant.id, cohortName)\n  }\n}\n</code></pre>"},{"location":"handbook/PULSE_SYSTEM/#deployment","title":"Deployment","text":"<p>Development: - Cron runs in API process - Can trigger manually: <code>npm run cron:pulse</code></p> <p>Production: - Cron runs in API process (always-on server) - OR external cron (crontab, Kubernetes CronJob) - Recommend: Kubernetes CronJob for reliability</p>"},{"location":"handbook/PULSE_SYSTEM/#configuration","title":"Configuration","text":""},{"location":"handbook/PULSE_SYSTEM/#tenant-settings","title":"Tenant Settings","text":"<pre><code>{\n  pulse: {\n    enabled: false,            // Feature flag\n    anonThreshold: 5,          // Min responses to show aggregates\n    defaultCadence: 'weekly',  // 'weekly' | 'biweekly' | 'monthly'\n    defaultTime: '09:00',      // HH:mm format\n    rotatingCohorts: true,     // Enable cohort rotation\n    channelSlack: false,       // Future: Slack DM delivery\n    channelEmail: true         // Email delivery (default)\n  }\n}\n</code></pre>"},{"location":"handbook/PULSE_SYSTEM/#pulse-schedule-per-tenant","title":"Pulse Schedule (Per Tenant)","text":"<pre><code>{\n  tenantId: \"tenant-uuid\",\n  enabled: true,\n  cadence: \"weekly\",\n  time: \"09:00\",\n  timezone: \"America/New_York\",\n  rotatingCohorts: true,\n  numCohorts: 5\n}\n</code></pre>"},{"location":"handbook/PULSE_SYSTEM/#privacy-compliance","title":"Privacy &amp; Compliance","text":""},{"location":"handbook/PULSE_SYSTEM/#gdpr-considerations","title":"GDPR Considerations","text":"<p>Right to Access: - Users can request their invite history - Cannot retrieve responses (no userId link)</p> <p>Right to Erasure: - Delete user \u2192 delete invites - Responses remain (anonymized)</p> <p>Data Minimization: - Only store essential data - No IP addresses, user agents, or other tracking</p>"},{"location":"handbook/PULSE_SYSTEM/#anonymity-verification","title":"Anonymity Verification","text":"<p>Audit query (admins can run): <pre><code>-- Verify NO userId in responses\nSELECT COUNT(*) FROM PulseResponse WHERE userId IS NOT NULL;\n-- Expected: 0 (column doesn't exist)\n\n-- Verify threshold enforcement\nSELECT questionId, teamId, COUNT(*)\nFROM PulseResponse\nGROUP BY questionId, teamId\nHAVING COUNT(*) &lt; 5;\n-- Should NOT appear in dashboards\n</code></pre></p>"},{"location":"handbook/PULSE_SYSTEM/#development-vs-production","title":"Development vs Production","text":"Feature Development Production Cron Scheduler Runs in API process Kubernetes CronJob (recommended) Email Delivery Mailpit (local testing) SMTP or Resend Redis Optional Required (for email queue) Anonymity Enforced Enforced Threshold Configurable (default: 5) Configurable (default: 5)"},{"location":"handbook/PULSE_SYSTEM/#troubleshooting","title":"Troubleshooting","text":""},{"location":"handbook/PULSE_SYSTEM/#invites-not-sending","title":"Invites Not Sending","text":"<p>Check: 1. Pulse enabled in tenant settings 2. PulseSchedule exists and enabled 3. Cohorts exist with users assigned 4. Active questions exist 5. Email worker running (requires Redis) 6. Cron scheduler running</p> <p>Debug: <pre><code># Check tenant settings\npsql -c \"SELECT settings FROM TenantSettings WHERE tenantId='...'\"\n\n# Check schedule\npsql -c \"SELECT * FROM PulseSchedule WHERE tenantId='...'\"\n\n# Check cohorts\npsql -c \"SELECT name, jsonb_array_length(userIds::jsonb) as userCount FROM PulseCohort\"\n\n# Manually trigger\nnpm run cron:pulse\n</code></pre></p>"},{"location":"handbook/PULSE_SYSTEM/#responses-not-appearing","title":"Responses Not Appearing","text":"<p>Check: 1. Token valid (not expired, not already used) 2. Response saved to database 3. Aggregates meet threshold (\u2265 5)</p> <p>Debug: <pre><code>-- Check invite status\nSELECT * FROM PulseInvite WHERE token = 'abc123';\n\n-- Check response count\nSELECT questionId, teamId, COUNT(*) \nFROM PulseResponse \nGROUP BY questionId, teamId;\n</code></pre></p>"},{"location":"handbook/PULSE_SYSTEM/#threshold-not-enforced","title":"Threshold Not Enforced","text":"<p>Symptom: Small teams seeing individual scores</p> <p>Fix: 1. Check query includes <code>HAVING COUNT(*) &gt;= :threshold</code> 2. Verify frontend suppresses low-count teams 3. Audit query logic</p>"},{"location":"handbook/PULSE_SYSTEM/#future-enhancements","title":"Future Enhancements","text":""},{"location":"handbook/PULSE_SYSTEM/#planned-features","title":"Planned Features","text":"<ol> <li>Slack Integration - Send invites via Slack DM</li> <li>Custom Cadences - Biweekly, monthly, custom schedules</li> <li>Question Library - Pre-built questions by category</li> <li>Benchmarking - Compare to industry averages</li> <li>Alerts - Notify admins of score drops</li> <li>Comments - Optional anonymous feedback text</li> <li>Multi-Question Pulses - Multiple questions per invite</li> </ol>"},{"location":"handbook/PULSE_SYSTEM/#related-documentation","title":"Related Documentation","text":"<ul> <li><code>/handbook/INTEGRATIONS/EMAIL.md</code> - Email delivery</li> <li><code>/handbook/DATA_MODEL_SNAPSHOT.md</code> - Pulse table schemas</li> <li><code>/handbook/SECURITY_MODEL.md</code> - Anonymity guarantees</li> <li><code>/api/src/pulse/</code> - Implementation details</li> </ul>"},{"location":"handbook/RELEASE_CHECKLIST/","title":"Release Checklist (demo/prod)","text":"<ul> <li> Migrations applied; backfill scripts run</li> <li> Feature flags set (PULSE_ENABLED, channels)</li> <li> Secrets rotated (ADMIN_KEY, SSO, SMTP)</li> <li> /ready green; SSE heartbeat confirmed</li> <li> CORS/CSP verified for domains</li> <li> Backups enabled; restore tested</li> <li> Docs updated (vision/use-cases/swagger/openapi/events)</li> </ul>"},{"location":"handbook/SECURITY_MODEL/","title":"Security Model","text":""},{"location":"handbook/SECURITY_MODEL/#auth-roles","title":"Auth &amp; Roles","text":""},{"location":"handbook/SECURITY_MODEL/#role-hierarchy","title":"Role Hierarchy","text":"<ul> <li>Roles: <code>viewer</code>, <code>member</code>, <code>moderator</code>, <code>admin</code>, <code>owner</code> (per-tenant, per ADR-0003)</li> <li>viewer: Read-only access (view questions, pulse data)</li> <li>member: Can submit questions, respond to pulse, upvote</li> <li>moderator: Team-scoped moderation rights (answer, tag, pin questions)</li> <li>admin: Tenant-wide administration and moderation (all teams)</li> <li>owner: Full tenant control including settings and user management</li> <li>Authorization enforced server-side on every write and sensitive read.</li> </ul>"},{"location":"handbook/SECURITY_MODEL/#authentication-methods","title":"Authentication Methods","text":"<ul> <li>Production: GitHub OAuth, Google OAuth (required)</li> <li>Development: Demo mode (disabled in production)</li> <li>Session Management: Redis-backed sessions (production), memory-backed (development)</li> <li>Session Lifetime: 8 hours (configurable per tenant)</li> </ul> <p>See: <code>/handbook/AUTHENTICATION.md</code> for full details</p>"},{"location":"handbook/SECURITY_MODEL/#rate-limiting-production-only","title":"Rate Limiting (Production Only)","text":""},{"location":"handbook/SECURITY_MODEL/#architecture","title":"Architecture","text":"<ul> <li>Technology: Redis-based rate limiting (per-tenant, per-IP)</li> <li>Requirement: Redis MUST be configured in production (security critical)</li> <li>Development: Rate limiting disabled for ease of development</li> </ul>"},{"location":"handbook/SECURITY_MODEL/#rate-limit-tiers","title":"Rate Limit Tiers","text":"<p>Read Operations: - 100 requests/minute (generous limits)</p> <p>Write Operations: - Create question: 10/minute - Create comment: 20/minute - Upvote: 30/minute - Update: 20/minute - Delete: 10/minute</p> <p>Sensitive Operations: - Auth attempt: 5 per 5 minutes - Password reset: 3 per hour - Email send: 10 per hour - Admin action: 50 per 15 minutes</p> <p>Search/Export: - Search: 60/minute - Export: 5 per 15 minutes</p>"},{"location":"handbook/SECURITY_MODEL/#per-tenant-isolation","title":"Per-Tenant Isolation","text":"<p>Rate limits are enforced per-tenant AND per-IP: <pre><code>Key format: rate:{route}:{tenantId}:{ip}\n</code></pre> This prevents one tenant from exhausting limits for others.</p>"},{"location":"handbook/SECURITY_MODEL/#response-to-rate-limit-exceeded","title":"Response to Rate Limit Exceeded","text":"<pre><code>HTTP 429 Too Many Requests\n{\n  \"error\": \"Too many requests\",\n  \"message\": \"Rate limit exceeded. Maximum 10 requests per minute.\"\n}\n</code></pre>"},{"location":"handbook/SECURITY_MODEL/#production-requirement","title":"Production Requirement","text":"<p>If Redis is not available in production: - API refuses to start (security requirement) - Rate limiting is CRITICAL for preventing abuse</p>"},{"location":"handbook/SECURITY_MODEL/#content-moderation","title":"Content Moderation","text":""},{"location":"handbook/SECURITY_MODEL/#tiered-moderation-system","title":"Tiered Moderation System","text":"<p>PulseStage uses cascading filters to detect harmful content:</p> <p>Filter Layers: 1. Local Filter (always active):    - Profanity detection    - Spam patterns (repeated chars, excessive URLs)    - Toxic language (hate speech, harmful content)    - Excessive capitalization</p> <ol> <li>OpenAI Moderation API (optional, recommended for production):</li> <li>11 categories (hate, harassment, violence, self-harm, sexual content)</li> <li>Context-aware detection</li> <li>Multi-language support</li> </ol>"},{"location":"handbook/SECURITY_MODEL/#response-tiers","title":"Response Tiers","text":"<ul> <li>High Confidence: Auto-reject (400 error returned to user)</li> <li>Medium/Low Confidence: Send to moderation queue (UNDER_REVIEW status)</li> </ul>"},{"location":"handbook/SECURITY_MODEL/#audit-trail","title":"Audit Trail","text":"<p>All moderation actions are logged: - Content flagged - Reasons for flagging - Moderation provider (local, OpenAI) - Confidence level - Manual moderator decisions</p> <p>See: <code>/handbook/TRUST_AND_SAFETY.md</code> for full details</p>"},{"location":"handbook/SECURITY_MODEL/#anonymity-privacy","title":"Anonymity &amp; Privacy","text":""},{"location":"handbook/SECURITY_MODEL/#pulse-anonymity-guarantees","title":"Pulse Anonymity Guarantees","text":"<ul> <li>PulseResponse table has NO userId field (enforced at schema level)</li> <li>Responses cannot be traced to individuals, even by admins</li> <li>Only aggregates shown when <code>n &gt;= threshold</code> (default: 5)</li> <li>Individual responses never exposed</li> </ul> <p>Schema Enforcement: <pre><code>model PulseResponse {\n  id          String   @id @default(uuid())\n  questionId  String\n  teamId      String?\n  score       Int      // 1-5\n  // NO userId field - anonymity by design\n}\n</code></pre></p>"},{"location":"handbook/SECURITY_MODEL/#qa-submissions","title":"Q&amp;A Submissions","text":"<ul> <li>Questions are attributed to submitter (not anonymous by default)</li> <li>Optional: <code>allowAnonymousQuestions</code> setting (future)</li> <li>Moderators can see question authors</li> </ul>"},{"location":"handbook/SECURITY_MODEL/#data-minimization","title":"Data Minimization","text":"<ul> <li>Only essential data collected</li> <li>No tracking cookies or analytics (by default)</li> <li>User agents and IP addresses logged only for security (audit logs)</li> </ul> <p>See: <code>/handbook/PULSE_SYSTEM.md</code> for pulse privacy details</p>"},{"location":"handbook/SECURITY_MODEL/#audit-logging","title":"Audit Logging","text":""},{"location":"handbook/SECURITY_MODEL/#comprehensive-action-tracking","title":"Comprehensive Action Tracking","text":"<p>All significant actions are logged asynchronously (non-blocking):</p> <p>Categories: - Question lifecycle (create, update, delete, answer, pin, freeze) - Moderation actions (flag, approve, reject) - Upvotes (add, remove) - Tags (create, add, remove, delete) - User management (create, update, delete, login, logout) - Team management (create, update, delete, add member, remove member, role change) - Settings changes</p>"},{"location":"handbook/SECURITY_MODEL/#audit-log-entry-structure","title":"Audit Log Entry Structure","text":"<pre><code>{\n  \"id\": \"uuid\",\n  \"tenantId\": \"uuid\",\n  \"userId\": \"uuid\",              // Who performed the action\n  \"action\": \"question.create\",\n  \"entityType\": \"question\",\n  \"entityId\": \"uuid\",\n  \"before\": { ... },             // State before change (if applicable)\n  \"after\": { ... },              // State after change (if applicable)\n  \"ipAddress\": \"192.168.1.1\",    // Security context\n  \"userAgent\": \"Mozilla/5.0 ...\",// Security context\n  \"metadata\": { ... },           // Additional context\n  \"createdAt\": \"2025-01-15T14:23:45Z\"\n}\n</code></pre>"},{"location":"handbook/SECURITY_MODEL/#retention-access","title":"Retention &amp; Access","text":"<ul> <li>Retention: Indefinite (or per tenant configuration)</li> <li>Access: Admin and owner roles only (<code>audit.view</code> permission)</li> <li>Immutability: Append-only, cannot be modified or deleted</li> <li>Tenant Isolation: Audit logs filtered by tenant</li> </ul>"},{"location":"handbook/SECURITY_MODEL/#query-api","title":"Query API","text":"<p>Admins can query audit logs by: - User ID - Action type - Entity type/ID - Date range - IP address (security investigations)</p> <p>See: <code>/handbook/ADMIN_GUIDE.md</code> for audit log usage</p>"},{"location":"handbook/SECURITY_MODEL/#headers-sessions","title":"Headers &amp; Sessions","text":""},{"location":"handbook/SECURITY_MODEL/#security-headers","title":"Security Headers","text":"<ul> <li>Helmet: Enabled (CSP, X-Frame-Options, X-Content-Type-Options, etc.)</li> <li>CORS: Restricted to configured origins (default: <code>http://localhost:5173</code> in dev)</li> <li>HSTS: Enabled in production (force HTTPS)</li> </ul>"},{"location":"handbook/SECURITY_MODEL/#cookie-security","title":"Cookie Security","text":"<p>Session cookies configured with: - <code>Secure</code>: true (production only, requires HTTPS) - <code>HttpOnly</code>: true (no JavaScript access) - <code>SameSite</code>: Lax (CSRF protection) - <code>MaxAge</code>: 8 hours (configurable)</p>"},{"location":"handbook/SECURITY_MODEL/#csrf-protection","title":"CSRF Protection","text":"<ul> <li>Enabled: Yes (via <code>csurf</code> middleware)</li> <li>Mechanism: Token per session, validated on state-changing requests</li> <li>Exemptions: SSE connections (read-only)</li> </ul>"},{"location":"handbook/SECURITY_MODEL/#multi-tenancy-security","title":"Multi-Tenancy Security","text":""},{"location":"handbook/SECURITY_MODEL/#tenant-isolation","title":"Tenant Isolation","text":"<ul> <li>Every database query MUST filter by tenantId</li> <li>No cross-tenant joins (enforced by query patterns)</li> <li>Tenant context middleware validates tenant exists and sets context</li> <li>Session-tenant binding: User session locked to single tenant</li> </ul>"},{"location":"handbook/SECURITY_MODEL/#tenant-resolution","title":"Tenant Resolution","text":"<p>Order of precedence: 1. <code>x-tenant-id</code> header 2. Subdomain (e.g., <code>acme.pulsestage.app</code> \u2192 tenant <code>acme</code>) 3. Default tenant (<code>default</code>)</p>"},{"location":"handbook/SECURITY_MODEL/#cross-tenant-attacks","title":"Cross-Tenant Attacks","text":"<p>Mitigations: - All queries filtered by tenantId (enforced in middleware) - User IDs scoped to tenant (UUID collision impossible) - API endpoints validate tenant context before any operation</p> <p>See: <code>/handbook/TENANCY_MODEL.md</code> for full multi-tenancy details</p>"},{"location":"handbook/SECURITY_MODEL/#development-vs-production-security","title":"Development vs Production Security","text":"Feature Development Production Rate Limiting Disabled Required (Redis-based) Session Store Memory Redis (required) HTTPS Optional Required Secure Cookies false true Demo Auth Enabled Disabled OAuth Optional Required Content Moderation Active (both filters) Active (both filters) Audit Logging Active Active"},{"location":"handbook/SECURITY_MODEL/#security-checklist-production","title":"Security Checklist (Production)","text":"<p>Before deploying to production:</p> <ul> <li> Redis configured (<code>REDIS_URL</code> set)</li> <li> Strong <code>SESSION_SECRET</code> (32+ random characters)</li> <li> OAuth configured (GitHub and/or Google)</li> <li> Demo mode disabled (<code>AUTH_MODE_DEMO != true</code>)</li> <li> HTTPS enabled (SSL certificate)</li> <li> CORS origins configured (not <code>*</code>)</li> <li> Rate limiting verified (<code>GET /health/ready</code> shows Redis healthy)</li> <li> Security scans passed (<code>make security</code>)</li> <li> Environment variables secured (not in code, use secrets manager)</li> <li> Database backups configured</li> <li> Audit logs retention configured</li> <li> Monitoring/alerting configured</li> </ul>"},{"location":"handbook/SECURITY_MODEL/#incident-response","title":"Incident Response","text":""},{"location":"handbook/SECURITY_MODEL/#security-event-logging","title":"Security Event Logging","text":"<p>All security-relevant events logged: - Failed login attempts - Rate limit violations - Content moderation flags (high confidence) - Admin/owner actions - Session anomalies</p>"},{"location":"handbook/SECURITY_MODEL/#monitoring-alerts-recommended","title":"Monitoring Alerts (Recommended)","text":"<ul> <li>Failed login spike (&gt;20/hour)</li> <li>Rate limit exceeded spike (&gt;100/hour)</li> <li>Moderation auto-reject spike (&gt;10/hour)</li> <li>Database connection failures</li> <li>Redis connection failures</li> </ul>"},{"location":"handbook/SECURITY_MODEL/#breach-response-plan","title":"Breach Response Plan","text":"<ol> <li>Detect: Monitoring alerts trigger</li> <li>Contain: Rate limiting, block IPs if needed</li> <li>Investigate: Query audit logs</li> <li>Remediate: Patch vulnerability, rotate secrets</li> <li>Notify: Users if data affected (per GDPR/local laws)</li> </ol>"},{"location":"handbook/SECURITY_MODEL/#related-documentation","title":"Related Documentation","text":"<ul> <li><code>/handbook/AUTHENTICATION.md</code> - Auth implementation</li> <li><code>/handbook/TRUST_AND_SAFETY.md</code> - Content moderation</li> <li><code>/handbook/ADMIN_GUIDE.md</code> - Admin security features</li> <li><code>/handbook/TENANCY_MODEL.md</code> - Multi-tenancy security</li> <li><code>/handbook/PULSE_SYSTEM.md</code> - Pulse anonymity</li> <li><code>/handbook/DECISIONS/ADR-0003-roles.md</code> - Role definitions</li> </ul>"},{"location":"handbook/TENANCY_MODEL/","title":"Tenancy Model \u2014 Invariants","text":"<ul> <li>Every entity includes <code>tenantId</code>. All queries must filter by <code>tenantId</code>.</li> <li>Subdomain \u2192 <code>tenantId</code> is canonical for web; API auth includes tenant claims.</li> <li>No cross-tenant joins or searches. Aggregations are per-tenant.</li> <li>Migrations must preserve <code>tenantId</code> and isolation.</li> <li>Logs/metrics include <code>tenantId</code> and <code>requestId</code>.</li> </ul>"},{"location":"handbook/TEST_STRATEGY/","title":"Test Strategy","text":"<ul> <li>Unit: domain/pulse aggregation, anonymity thresholds</li> <li>Integration: token \u2192 /pulse/respond; summary hides n&lt;threshold</li> </ul> <p>Coverage floor (initial): 70% lines (grow with maturity).</p>"},{"location":"handbook/TRUST_AND_SAFETY/","title":"Trust &amp; Safety: Content Moderation","text":"<p>Purpose: Protect users from harmful content while minimizing false positives.</p> <p>Architecture: Cascading filter system (local + optional AI) with tiered response.</p>"},{"location":"handbook/TRUST_AND_SAFETY/#moderation-philosophy","title":"Moderation Philosophy","text":"<p>PulseStage uses a tiered moderation approach:</p> <ol> <li>Prevention: Automated filters catch obvious violations</li> <li>Review: Borderline content goes to moderator queue</li> <li>Transparency: Users notified with clear reasons</li> <li>Privacy: All moderation actions audit-logged</li> </ol> <p>Goal: Balance safety with free expression.</p>"},{"location":"handbook/TRUST_AND_SAFETY/#filter-architecture","title":"Filter Architecture","text":""},{"location":"handbook/TRUST_AND_SAFETY/#cascading-filters","title":"Cascading Filters","text":"<pre><code>User submits question/answer\n  \u2193\nLocal Filter (always runs)\n  \u2193\nOpenAI Filter (if API key configured)\n  \u2193\nCombine Results\n  \u2193\nTiered Response (high/medium/low confidence)\n</code></pre> <p>Content is flagged if EITHER filter flags it.</p>"},{"location":"handbook/TRUST_AND_SAFETY/#local-filter-always-active","title":"Local Filter (Always Active)","text":"<p>Technology: Rule-based detection (no external dependencies)</p> <p>Detection Patterns:</p>"},{"location":"handbook/TRUST_AND_SAFETY/#1-profanity-detection","title":"1. Profanity Detection","text":"<ul> <li>Library: <code>bad-words</code> (npm)</li> <li>Detects common profanity across languages</li> <li>Updates regularly with community contributions</li> </ul>"},{"location":"handbook/TRUST_AND_SAFETY/#2-spam-detection","title":"2. Spam Detection","text":"<pre><code>// Repeated characters (10+ times)\n/(.)\\1{10,}/i\n\n// Multiple URLs\n/https?:\\/\\/(www\\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\\.[a-zA-Z0-9()]{1,6}\\b/gi\n\n// Spam keywords\n/\\b(buy|cheap|discount|free|click here|limited time|act now|sale|order now)\\b/gi\n\n// Long numbers (phone numbers)\n/\\b\\d{10,}\\b/g\n</code></pre>"},{"location":"handbook/TRUST_AND_SAFETY/#3-toxic-language","title":"3. Toxic Language","text":"<pre><code>// Harmful content patterns\n/\\b(kill yourself|kys|neck yourself)\\b/gi\n/\\b(ni(gg|bb)er|f[a@]gg[o0]t|retard)\\b/gi\n/\\b(rape|molest|abuse)\\b/gi\n</code></pre>"},{"location":"handbook/TRUST_AND_SAFETY/#4-excessive-capitalization","title":"4. Excessive Capitalization","text":"<ul> <li>Detects \"shouting\" (&gt;60% caps)</li> <li>Minimum 20 characters to avoid false positives</li> </ul>"},{"location":"handbook/TRUST_AND_SAFETY/#5-sentiment-analysis","title":"5. Sentiment Analysis","text":"<ul> <li>Library: <code>compromise</code> (NLP)</li> <li>Detects negative sentiment</li> <li>Low confidence signal (doesn't auto-flag)</li> </ul> <p>Confidence Levels: - High: Profanity, spam, or toxic language detected - Medium: Excessive caps or negative sentiment - Low: No issues detected</p>"},{"location":"handbook/TRUST_AND_SAFETY/#openai-filter-optional","title":"OpenAI Filter (Optional)","text":"<p>Configuration: <pre><code>OPENAI_API_KEY=sk-...  # If not set, filter is skipped\n</code></pre></p> <p>Technology: OpenAI Moderation API (<code>text-moderation-latest</code>)</p> <p>Detection Categories: 1. Hate speech 2. Hate/threatening 3. Harassment 4. Harassment/threatening 5. Self-harm 6. Self-harm/intent 7. Self-harm/instructions 8. Sexual content 9. Sexual/minors 10. Violence 11. Violence/graphic</p> <p>Confidence Scoring: - Category scores range 0.0-1.0 - High: Any score &gt; 0.8 - Medium: Any score &gt; 0.5 - Low: All scores &lt; 0.5</p> <p>Benefits: - Catches nuanced violations - Evolves with OpenAI updates - Multi-language support - Context-aware</p> <p>Costs: - Free tier: 1M tokens/month - Paid: $0.002 per 1K tokens (~500 moderations = $0.001)</p>"},{"location":"handbook/TRUST_AND_SAFETY/#tiered-response-system","title":"Tiered Response System","text":""},{"location":"handbook/TRUST_AND_SAFETY/#high-confidence-auto-reject","title":"High Confidence (Auto-Reject)","text":"<p>Trigger: Clear violations (profanity, spam, toxic language)</p> <p>Action: Reject immediately with 400 error</p> <p>User Experience: <pre><code>{\n  \"error\": \"Content does not meet community guidelines\",\n  \"reasons\": [\n    \"Contains profanity\",\n    \"Toxic language detected\"\n  ],\n  \"moderationId\": \"mod_1234567890\"\n}\n</code></pre></p> <p>Rationale: Obvious violations don't need human review.</p>"},{"location":"handbook/TRUST_AND_SAFETY/#mediumlow-confidence-review-queue","title":"Medium/Low Confidence (Review Queue)","text":"<p>Trigger: Borderline content, ambiguous language</p> <p>Action: Set question status to <code>UNDER_REVIEW</code></p> <p>User Experience: - Question submitted successfully - Status shows \"Under Review\" - Notification when approved/rejected</p> <p>Moderator Experience: - Appears in moderation queue - See flagging reasons - Approve or reject with comment</p> <p>Rationale: Human judgment for gray areas.</p>"},{"location":"handbook/TRUST_AND_SAFETY/#moderation-queue-workflow","title":"Moderation Queue Workflow","text":""},{"location":"handbook/TRUST_AND_SAFETY/#for-users","title":"For Users","text":"<ol> <li>Submit question with borderline content</li> <li>Question created with status <code>UNDER_REVIEW</code></li> <li>Not visible to other users yet</li> <li>Receive notification when reviewed</li> </ol>"},{"location":"handbook/TRUST_AND_SAFETY/#for-moderators","title":"For Moderators","text":"<ol> <li>Access moderation queue: <code>/moderation/queue</code></li> <li>View flagged questions with reasons</li> <li>Review content and context</li> <li>Actions:</li> <li>Approve: Change status to <code>OPEN</code>, visible to all</li> <li>Reject: Delete question, notify user</li> <li>Edit &amp; Approve: Fix minor issues, then approve</li> <li>Escalate: Flag for admin review</li> </ol>"},{"location":"handbook/TRUST_AND_SAFETY/#team-scoping","title":"Team Scoping","text":"<p>Moderators see questions from their teams only.</p> <p>Admins see questions from all teams in tenant.</p>"},{"location":"handbook/TRUST_AND_SAFETY/#audit-logging","title":"Audit Logging","text":"<p>All moderation actions are logged:</p>"},{"location":"handbook/TRUST_AND_SAFETY/#events-logged","title":"Events Logged","text":"<ol> <li>Content Flagged</li> <li>Action: <code>question.moderation.flagged</code></li> <li> <p>Metadata: reasons, confidence, providers, moderationId</p> </li> <li> <p>Question Approved</p> </li> <li>Action: <code>question.approve</code></li> <li> <p>Metadata: moderatorId, original reasons</p> </li> <li> <p>Question Rejected</p> </li> <li>Action: <code>question.reject</code></li> <li> <p>Metadata: moderatorId, rejection reason</p> </li> <li> <p>Auto-Reject</p> </li> <li>Action: <code>question.auto_reject</code></li> <li>Metadata: reasons, confidence, providers</li> </ol> <p>Audit logs include: - Tenant ID - User ID (submitter) - Moderator ID (if manual action) - IP address - User agent - Timestamp - Before/after content</p>"},{"location":"handbook/TRUST_AND_SAFETY/#false-positive-handling","title":"False Positive Handling","text":""},{"location":"handbook/TRUST_AND_SAFETY/#user-reports","title":"User Reports","text":"<p>Status: Not yet implemented</p> <p>Planned: - \"Report false positive\" button - Admin can review and adjust filters - Whitelist specific phrases/users</p>"},{"location":"handbook/TRUST_AND_SAFETY/#moderator-override","title":"Moderator Override","text":"<p>Current: Moderators can approve flagged content</p> <p>Effect: - Question becomes visible - Audit log shows override - No impact on future moderation</p>"},{"location":"handbook/TRUST_AND_SAFETY/#development-vs-production","title":"Development vs Production","text":""},{"location":"handbook/TRUST_AND_SAFETY/#development","title":"Development","text":"<ul> <li>Local Filter: Active</li> <li>OpenAI Filter: Active if <code>OPENAI_API_KEY</code> set</li> <li>Audit Logging: Active (development database)</li> <li>Review Queue: Functional</li> </ul> <p>Testing: <pre><code># Test without OpenAI\nunset OPENAI_API_KEY\n\n# Test with OpenAI\nexport OPENAI_API_KEY=sk-...\n</code></pre></p>"},{"location":"handbook/TRUST_AND_SAFETY/#production","title":"Production","text":"<ul> <li>Local Filter: Active (required)</li> <li>OpenAI Filter: Recommended (optional)</li> <li>Audit Logging: Active (production database, retained)</li> <li>Review Queue: Moderators handle queue</li> </ul> <p>Recommendation: Enable OpenAI for production (better accuracy).</p>"},{"location":"handbook/TRUST_AND_SAFETY/#configuration-options","title":"Configuration Options","text":""},{"location":"handbook/TRUST_AND_SAFETY/#tenant-settings-future","title":"Tenant Settings (Future)","text":"<p>Planned settings: <pre><code>{\n  moderation: {\n    autoRejectThreshold: 'high' | 'medium' | 'low',\n    enableOpenAI: true | false,\n    customBannedWords: string[],\n    customAllowedWords: string[],\n    requireApprovalForAll: boolean  // Manual review for everything\n  }\n}\n</code></pre></p> <p>Current: Hardcoded behavior (high = reject, medium/low = review).</p>"},{"location":"handbook/TRUST_AND_SAFETY/#performance-scaling","title":"Performance &amp; Scaling","text":""},{"location":"handbook/TRUST_AND_SAFETY/#latency","title":"Latency","text":"<ul> <li>Local Filter: &lt;5ms (synchronous)</li> <li>OpenAI Filter: 100-500ms (async API call)</li> <li>Total Impact: ~500ms worst case (OpenAI enabled)</li> </ul>"},{"location":"handbook/TRUST_AND_SAFETY/#optimization","title":"Optimization","text":"<ul> <li>Filters run in parallel</li> <li>Local filter can reject before OpenAI completes</li> <li>OpenAI errors don't block submission (local-only fallback)</li> </ul>"},{"location":"handbook/TRUST_AND_SAFETY/#caching-future","title":"Caching (Future)","text":"<p>Planned: - Cache OpenAI results for identical content - Redis-backed cache with 24-hour TTL - Reduce API costs and latency</p>"},{"location":"handbook/TRUST_AND_SAFETY/#compliance-legal","title":"Compliance &amp; Legal","text":""},{"location":"handbook/TRUST_AND_SAFETY/#gdpr","title":"GDPR","text":"<ul> <li>Flagged content stored temporarily (audit logs)</li> <li>User can request deletion of all content</li> <li>Audit logs anonymized after 90 days (planned)</li> </ul>"},{"location":"handbook/TRUST_AND_SAFETY/#age-appropriate-content","title":"Age-Appropriate Content","text":"<ul> <li><code>sexual/minors</code> category auto-rejects (high confidence)</li> <li>Zero tolerance for child safety violations</li> <li>Immediate escalation to admin</li> </ul>"},{"location":"handbook/TRUST_AND_SAFETY/#hate-speech","title":"Hate Speech","text":"<ul> <li>Multi-layer detection (local + OpenAI)</li> <li>Context-aware (OpenAI)</li> <li>Manual review for borderline cases</li> </ul>"},{"location":"handbook/TRUST_AND_SAFETY/#monitoring-metrics","title":"Monitoring &amp; Metrics","text":""},{"location":"handbook/TRUST_AND_SAFETY/#key-metrics-admin-dashboard-planned","title":"Key Metrics (Admin Dashboard - Planned)","text":"<ul> <li>Flagging Rate: % of submissions flagged</li> <li>Auto-Reject Rate: % auto-rejected (high confidence)</li> <li>Review Queue Size: Current pending count</li> <li>False Positive Rate: % approved after review</li> <li>Average Review Time: Time from flag to decision</li> </ul>"},{"location":"handbook/TRUST_AND_SAFETY/#alerts-planned","title":"Alerts (Planned)","text":"<ul> <li>Review queue &gt; 50 items</li> <li>Flagging rate spike (&gt;20% in 1 hour)</li> <li>OpenAI API errors</li> </ul>"},{"location":"handbook/TRUST_AND_SAFETY/#troubleshooting","title":"Troubleshooting","text":""},{"location":"handbook/TRUST_AND_SAFETY/#content-incorrectly-flagged","title":"Content Incorrectly Flagged","text":"<p>Symptoms: Safe content auto-rejected or sent to review</p> <p>Diagnosis: 1. Check audit logs for moderation reasons 2. Test with local filter only (disable OpenAI) 3. Test with OpenAI only (bypass local filter)</p> <p>Solutions: - Add to custom allowed words (future) - Adjust auto-reject threshold (future) - Manually approve from review queue</p>"},{"location":"handbook/TRUST_AND_SAFETY/#content-not-flagged","title":"Content Not Flagged","text":"<p>Symptoms: Harmful content published without review</p> <p>Diagnosis: 1. Check if OpenAI key configured 2. Test content through moderation API 3. Review filter patterns</p> <p>Solutions: - Enable OpenAI filter (if not active) - Report pattern to dev team - Add to local filter patterns - Manual moderation as fallback</p>"},{"location":"handbook/TRUST_AND_SAFETY/#openai-api-errors","title":"OpenAI API Errors","text":"<p>Symptoms: All content goes to review queue</p> <p>Diagnosis: 1. Check API key validity 2. Check OpenAI service status 3. Check rate limits</p> <p>Solutions: - Local filter still active (fallback) - Fix API key or wait for service restoration - Moderators review queue</p>"},{"location":"handbook/TRUST_AND_SAFETY/#best-practices","title":"Best Practices","text":""},{"location":"handbook/TRUST_AND_SAFETY/#for-moderators_1","title":"For Moderators","text":"<ol> <li>Context Matters: Consider intent, not just words</li> <li>Consistency: Apply guidelines uniformly</li> <li>Speed: Review queue within 24 hours</li> <li>Documentation: Note reasons for decisions</li> <li>Escalate: Flag edge cases for admin review</li> </ol>"},{"location":"handbook/TRUST_AND_SAFETY/#for-admins","title":"For Admins","text":"<ol> <li>Monitor Metrics: Track false positive rates</li> <li>Adjust Thresholds: Balance safety vs friction</li> <li>Train Moderators: Provide clear guidelines</li> <li>Review Appeals: User feedback on false positives</li> </ol>"},{"location":"handbook/TRUST_AND_SAFETY/#for-developers","title":"For Developers","text":"<ol> <li>Test Thoroughly: Include edge cases in tests</li> <li>Monitor Performance: OpenAI latency impact</li> <li>Update Patterns: Add new toxic patterns as discovered</li> <li>Cache OpenAI: Reduce costs and latency (planned)</li> </ol>"},{"location":"handbook/TRUST_AND_SAFETY/#related-documentation","title":"Related Documentation","text":"<ul> <li><code>/handbook/SECURITY_MODEL.md</code> - Overall security architecture</li> <li><code>/handbook/ADMIN_GUIDE.md</code> - Moderation queue management</li> <li><code>/handbook/DECISIONS/ADR-0003-roles.md</code> - Moderator permissions</li> <li><code>/api/src/lib/moderation/</code> - Implementation details</li> </ul>"},{"location":"handbook/USE-CASES/","title":"Core Use Cases (persona \u00d7 scenario \u00d7 success)","text":"Persona Use Case Success Metric Key Flows Participant Submit question anonymously Time-to-submit &lt; 15s Select team \u2192 submit \u2192 appears in queue Participant Weekly pulse response (1 tap) Completion rate, &lt;10s time Slack/email \u2192 1 tap \u2192 confirm Moderator Curate &amp; merge questions Reduce duplicates by &gt;30% Team view \u2192 merge, tag, flag Leader Run-of-show live Q&amp;A No-mouse flow; 0 presenter surprises Select team \u2192 queue \u2192 answer Leader View pulse trends by team Compare team sentiment Team selector \u2192 trend charts Tenant Admin Configure pulse cadence &amp; thresholds Weekly send on schedule, n-threshold Settings \u2192 save \u2192 scheduler runs Tenant Admin View \"All Teams\" org rollup See org-wide engagement All Teams view \u2192 aggregated data"},{"location":"handbook/UX_CONTRACTS/","title":"UX Contracts (key screens &amp; states)","text":""},{"location":"handbook/UX_CONTRACTS/#dashboard-default-landing","title":"Dashboard (default landing)","text":"<ul> <li>URL: <code>/:teamSlug/dashboard</code> or <code>/all/dashboard</code> (org rollup)</li> <li>Cards: Pulse Trend (12 wks), Drivers Heatmap, \"This Week's Pulse\" CTA, Live AMA Snapshot</li> <li>Team Selector: Dropdown to switch between teams or \"All Teams\"</li> <li>States: loading, empty (insufficient data), normal, error</li> <li>A11y: keyboard navigable; focus ring on primary actions; contrast \u2265 WCAG AA</li> </ul>"},{"location":"handbook/UX_CONTRACTS/#questions-page","title":"Questions Page","text":"<ul> <li>URL: <code>/:teamSlug/questions</code> or <code>/all/questions</code> (org rollup)</li> <li>Tabs: Open, Answered, Archived</li> <li>Action Bar: Search, Filters, Presentation Mode, Submit Question</li> <li>States: loading, empty, normal, error</li> <li>Team Context Bar: Shows current team with selector</li> </ul>"},{"location":"handbook/UX_CONTRACTS/#pulse-dashboard","title":"Pulse Dashboard","text":"<ul> <li>URL: <code>/:teamSlug/pulse/dashboard</code> or <code>/all/pulse/dashboard</code> (org rollup)</li> <li>Charts: 12-week trend line, participation rate, team-specific sentiment</li> <li>Team Filtering: Show team-specific data or aggregated \"All Teams\" view</li> <li>States: loading, insufficient data (n &lt; threshold), normal, error</li> </ul>"},{"location":"handbook/UX_CONTRACTS/#pulse-response-token-link","title":"Pulse Response (token link)","text":"<ul> <li>1-tap buttons (Likert 1\u20135 or 0\u201310), optional comment</li> <li>Team context shown but not editable (derived from user's primaryTeam)</li> <li>Success: thank-you + link back to Dashboard</li> </ul>"},{"location":"handbook/UX_CONTRACTS/#presenter-mode","title":"Presenter Mode","text":"<ul> <li>URL: <code>/:teamSlug/presentation</code></li> <li>Queue \u2192 Selected \u2192 Answering \u2192 Answered</li> <li>Keyboard shortcuts: J/K (navigate), Enter (select), P (pin), F (flag)</li> <li>Team-scoped question queue</li> </ul>"},{"location":"handbook/API_CONTRACTS/events/","title":"SSE Events (Server-Sent Events)","text":"<p>PulseStage uses Server-Sent Events (SSE) for real-time push updates. See <code>/docs/architecture/real-time.md</code> for full architecture.</p>"},{"location":"handbook/API_CONTRACTS/events/#connection","title":"Connection","text":"<ul> <li>Endpoint: <code>GET /events?tenant={tenantSlug}</code></li> <li>Auth: Requires session authentication</li> <li>Tenant: Resolved from query parameter (SSE can't send custom headers)</li> <li>Format: <code>text/event-stream</code></li> <li>Heartbeat: Every 30 seconds to prevent timeout</li> </ul>"},{"location":"handbook/API_CONTRACTS/events/#event-types","title":"Event Types","text":""},{"location":"handbook/API_CONTRACTS/events/#qa-events-currently-implemented","title":"Q&amp;A Events (Currently Implemented)","text":""},{"location":"handbook/API_CONTRACTS/events/#questioncreated","title":"<code>question:created</code>","text":"<p>Emitted when a participant submits a question. <pre><code>{\n  \"type\": \"question:created\",\n  \"tenantId\": \"uuid\",\n  \"data\": {\n    \"id\": \"uuid\",\n    \"body\": \"Question text\",\n    \"teamId\": \"uuid\",\n    \"status\": \"OPEN\",\n    \"upvoteCount\": 0,\n    \"submittedAt\": \"2025-01-01T00:00:00Z\"\n  },\n  \"timestamp\": 1234567890\n}\n</code></pre></p>"},{"location":"handbook/API_CONTRACTS/events/#questionupvoted","title":"<code>question:upvoted</code>","text":"<p>Emitted when a user upvotes a question. <pre><code>{\n  \"type\": \"question:upvoted\",\n  \"tenantId\": \"uuid\",\n  \"data\": {\n    \"questionId\": \"uuid\",\n    \"upvoteCount\": 5\n  },\n  \"timestamp\": 1234567890\n}\n</code></pre></p>"},{"location":"handbook/API_CONTRACTS/events/#questionanswered","title":"<code>question:answered</code>","text":"<p>Emitted when a moderator/admin answers a question. <pre><code>{\n  \"type\": \"question:answered\",\n  \"tenantId\": \"uuid\",\n  \"data\": {\n    \"id\": \"uuid\",\n    \"status\": \"ANSWERED\",\n    \"responseText\": \"Here's the answer...\"\n  },\n  \"timestamp\": 1234567890\n}\n</code></pre></p>"},{"location":"handbook/API_CONTRACTS/events/#questiontagged-questionuntagged","title":"<code>question:tagged</code>, <code>question:untagged</code>","text":"<p>Emitted when tags are added/removed from a question.</p>"},{"location":"handbook/API_CONTRACTS/events/#questionpinned","title":"<code>question:pinned</code>","text":"<p>Emitted when a question is pinned for presenter mode.</p>"},{"location":"handbook/API_CONTRACTS/events/#questionfrozen","title":"<code>question:frozen</code>","text":"<p>Emitted when the queue is frozen (no new questions accepted).</p>"},{"location":"handbook/API_CONTRACTS/events/#heartbeat","title":"<code>heartbeat</code>","text":"<p>Keepalive ping sent every 30 seconds. <pre><code>{\n  \"type\": \"heartbeat\",\n  \"tenantId\": \"uuid\",\n  \"data\": { \"timestamp\": 1234567890 },\n  \"timestamp\": 1234567890\n}\n</code></pre></p>"},{"location":"handbook/API_CONTRACTS/events/#pulse-events-not-currently-implemented","title":"Pulse Events (Not Currently Implemented)","text":"<p>Future consideration: Should pulse responses trigger SSE events for real-time dashboard updates?</p> <p>Proposed schema for reference (from <code>pulse.response.recorded.v1.json</code>): <pre><code>{\n  \"event\": \"pulse.response.recorded.v1\",\n  \"tenantId\": \"uuid\",\n  \"questionId\": \"uuid\",\n  \"teamId\": \"uuid\",\n  \"score\": 8,\n  \"cohortName\": \"Weekday\",\n  \"submittedAt\": \"2025-01-01T00:00:00Z\"\n}\n</code></pre></p>"},{"location":"handbook/API_CONTRACTS/events/#implementation-reference","title":"Implementation Reference","text":"<ul> <li>EventBus: <code>/api/src/lib/eventBus.ts</code></li> <li>Endpoint: <code>/api/src/app.ts</code> (line ~1947)</li> <li>Client Hook: <code>/web/src/hooks/useSSE.ts</code></li> </ul>"},{"location":"handbook/API_CONTRACTS/events/#versioning","title":"Versioning","text":"<p>When adding/removing fields, use semver versioning in event type names. Do not break existing consumers.</p>"},{"location":"handbook/DECISIONS/ADR-0001-tenancy/","title":"ADR-0001 \u2014 Subdomain-per-tenant routing","text":"<ul> <li>Decision: Subdomain is canonical for tenant resolution; every entity carries tenantId.</li> <li>Consequences: Simpler isolation, clear CORS rules, easy custom domains later.</li> </ul>"},{"location":"handbook/DECISIONS/ADR-0002-realtime/","title":"ADR-0002 \u2014 Realtime via SSE","text":"<ul> <li>Decision: Use SSE for live updates; WebSocket reserved for future bi-directional moderation.</li> <li>Consequences: Simpler infra and proxies; heartbeat every 20\u201330s.</li> </ul>"},{"location":"handbook/DECISIONS/ADR-0003-roles/","title":"ADR-0003 \u2014 Role model","text":"<ul> <li>Decision: Use <code>viewer</code>, <code>member</code>, <code>moderator</code>, <code>admin</code>, <code>owner</code>. No custom roles before v1.0.</li> <li>Roles:</li> <li>viewer: Read-only access to questions and pulse data</li> <li>member: Can submit questions, respond to pulse, upvote</li> <li>moderator: Team-scoped moderation (tag, merge, flag questions)</li> <li>admin: Tenant-wide administration and moderation</li> <li>owner: Full tenant control including settings and user management</li> <li>Consequences: Clear tests/docs; explicit permission boundaries; team-scoped vs tenant-scoped access.</li> </ul>"},{"location":"handbook/INTEGRATIONS/EMAIL/","title":"Email System","text":"<p>Purpose: Send transactional emails for notifications and pulse invites.</p> <p>Architecture: BullMQ job queue with multiple provider support (SMTP, Resend).</p>"},{"location":"handbook/INTEGRATIONS/EMAIL/#development-vs-production","title":"Development vs Production","text":""},{"location":"handbook/INTEGRATIONS/EMAIL/#development-configuration","title":"Development Configuration","text":"<p>Email Testing with Mailpit: - Mailpit provides a local SMTP server and web UI for email testing - Web UI: <code>http://localhost:8025</code> - SMTP server: <code>localhost:1025</code> - No authentication required - All emails captured locally (nothing sent externally)</p> <p>Default Development Settings: <pre><code>EMAIL_PROVIDER=smtp\nSMTP_HOST=localhost\nSMTP_PORT=1025\nSMTP_SECURE=false\nSMTP_FROM_EMAIL=noreply@pulsestage.app\nSMTP_FROM_NAME=PulseStage\n</code></pre></p> <p>Email Worker: - Email worker does NOT start in development (no Redis requirement) - Emails are queued but not processed automatically - To test email sending, configure <code>REDIS_URL</code> to enable worker</p> <p>Testing Emails: 1. Trigger an email action (e.g., answer a question) 2. Open Mailpit UI at <code>http://localhost:8025</code> 3. View rendered email with full HTML/text</p>"},{"location":"handbook/INTEGRATIONS/EMAIL/#production-configuration","title":"Production Configuration","text":"<p>Provider Options:</p>"},{"location":"handbook/INTEGRATIONS/EMAIL/#option-1-smtp-self-hosted","title":"Option 1: SMTP (Self-Hosted)","text":"<p>Best for organizations with existing mail infrastructure.</p> <pre><code>EMAIL_PROVIDER=smtp\nSMTP_HOST=smtp.yourcompany.com\nSMTP_PORT=587\nSMTP_SECURE=true\nSMTP_USER=your-smtp-user\nSMTP_PASS=your-smtp-password\nSMTP_FROM_EMAIL=noreply@yourcompany.com\nSMTP_FROM_NAME=Your Company Name\n</code></pre>"},{"location":"handbook/INTEGRATIONS/EMAIL/#option-2-resend-recommended","title":"Option 2: Resend (Recommended)","text":"<p>Cloud email service with better deliverability.</p> <pre><code>EMAIL_PROVIDER=resend\nRESEND_API_KEY=re_...\nRESEND_FROM_EMAIL=noreply@yourcompany.com\nRESEND_FROM_NAME=Your Company Name\n</code></pre> <p>Requirements: - Redis must be configured (<code>REDIS_URL</code>) - Email worker starts automatically - Queue processes emails in background</p>"},{"location":"handbook/INTEGRATIONS/EMAIL/#email-queue-system","title":"Email Queue System","text":"<p>Technology: BullMQ (Redis-backed job queue)</p> <p>Configuration: - Retry Attempts: 3 with exponential backoff (2s, 4s, 8s) - Retention (Completed): 24 hours, max 1,000 jobs - Retention (Failed): 7 days - Concurrency: 5 emails processed simultaneously</p> <p>Queue Behavior: - Development: Queue created, worker does NOT start (no Redis) - Production: Queue created, worker starts automatically (requires Redis)</p>"},{"location":"handbook/INTEGRATIONS/EMAIL/#email-types","title":"Email Types","text":""},{"location":"handbook/INTEGRATIONS/EMAIL/#1-question-answered-notification","title":"1. Question Answered Notification","text":"<p>Trigger: Moderator/admin answers a question</p> <p>Sent To: Question author</p> <p>Template: React-email based HTML template</p> <p>Content: - User's name - Original question body - Answer text - Responder name - Link to question - Unsubscribe link</p> <p>Example: <pre><code>Subject: Your question was answered!\n\nHi Alice,\n\nYour question \"What is our remote work policy?\" \nwas answered by Bob (Admin).\n\n[View full answer: http://...]\n\n[Unsubscribe from notifications]\n</code></pre></p>"},{"location":"handbook/INTEGRATIONS/EMAIL/#2-pulse-invite","title":"2. Pulse Invite","text":"<p>Trigger: Daily pulse scheduler (cron)</p> <p>Sent To: Users in today's cohort</p> <p>Content: - Personalized greeting - Pulse question text - One-tap response links (scores 1-5) - Unique token for anonymity - 7-day expiration</p> <p>Example: <pre><code>Subject: Weekly Pulse - How are you feeling?\n\nHi Alice,\n\nQuick check-in for this week:\n\"How satisfied are you with work-life balance?\"\n\n[1] [2] [3] [4] [5]\n(one-tap response)\n\nLink expires in 7 days.\n</code></pre></p>"},{"location":"handbook/INTEGRATIONS/EMAIL/#3-direct-email-admin","title":"3. Direct Email (Admin)","text":"<p>Trigger: Admin sends custom email</p> <p>Sent To: Specified recipient(s)</p> <p>Content: Customizable</p>"},{"location":"handbook/INTEGRATIONS/EMAIL/#admin-monitoring","title":"Admin Monitoring","text":"<p>Endpoint: <code>GET /admin/email-queue</code></p> <p>Permission: <code>admin.access</code></p> <p>Metrics: - Active jobs (currently processing) - Waiting jobs (queued) - Completed jobs (last 20) - Failed jobs (last 20 with error details)</p> <p>Use Cases: - Debug email delivery issues - Monitor queue health - View failed job reasons</p> <p>Example Response: <pre><code>{\n  \"metrics\": {\n    \"active\": 2,\n    \"waiting\": 15,\n    \"completed\": 342,\n    \"failed\": 3\n  },\n  \"recentJobs\": {\n    \"active\": [...],\n    \"waiting\": [...],\n    \"completed\": [...],\n    \"failed\": [\n      {\n        \"id\": \"job-123\",\n        \"name\": \"email\",\n        \"failedReason\": \"SMTP connection timeout\",\n        \"attemptsMade\": 3,\n        \"finishedOn\": 1234567890\n      }\n    ]\n  }\n}\n</code></pre></p>"},{"location":"handbook/INTEGRATIONS/EMAIL/#email-templates","title":"Email Templates","text":"<p>Technology: React-email (JSX-based email templates)</p> <p>Location: <code>api/src/lib/email/templates/</code></p> <p>Benefits: - Write emails in React/JSX - Preview in development - Automatic HTML + plain text generation - Type-safe props</p> <p>Example Template: <pre><code>export function QuestionAnsweredEmail({ \n  userName, \n  questionBody, \n  answerBody, \n  responderName, \n  questionUrl, \n  unsubscribeUrl \n}) {\n  return (\n    &lt;Html&gt;\n      &lt;Head /&gt;\n      &lt;Body&gt;\n        &lt;Container&gt;\n          &lt;Heading&gt;Your question was answered!&lt;/Heading&gt;\n          &lt;Text&gt;Hi {userName},&lt;/Text&gt;\n          &lt;Text&gt;Your question \"{questionBody}\" was answered by {responderName}.&lt;/Text&gt;\n          &lt;Button href={questionUrl}&gt;View Answer&lt;/Button&gt;\n          &lt;Hr /&gt;\n          &lt;Link href={unsubscribeUrl}&gt;Unsubscribe&lt;/Link&gt;\n        &lt;/Container&gt;\n      &lt;/Body&gt;\n    &lt;/Html&gt;\n  );\n}\n</code></pre></p>"},{"location":"handbook/INTEGRATIONS/EMAIL/#troubleshooting","title":"Troubleshooting","text":""},{"location":"handbook/INTEGRATIONS/EMAIL/#development-emails-not-appearing-in-mailpit","title":"Development: Emails Not Appearing in Mailpit","text":"<p>Check: 1. Mailpit service is running: <code>docker ps | grep mailpit</code> 2. Mailpit UI accessible: <code>http://localhost:8025</code> 3. SMTP settings correct in <code>.env</code> (host=localhost, port=1025)</p> <p>Fix: <pre><code>make down\nmake up\n</code></pre></p>"},{"location":"handbook/INTEGRATIONS/EMAIL/#production-emails-not-sending","title":"Production: Emails Not Sending","text":"<p>Check: 1. Redis is running and accessible 2. Email worker started (check logs for \"Email worker started\") 3. Provider credentials correct (SMTP or Resend) 4. Queue metrics: <code>GET /admin/email-queue</code></p> <p>Common Errors: - <code>SMTP connection timeout</code> \u2192 Check firewall/network access - <code>Authentication failed</code> \u2192 Verify SMTP credentials - <code>Invalid API key</code> \u2192 Check Resend API key - <code>Redis connection failed</code> \u2192 Ensure REDIS_URL is correct</p>"},{"location":"handbook/INTEGRATIONS/EMAIL/#queue-stuck","title":"Queue Stuck","text":"<p>Diagnosis: <pre><code># Check Redis connection\nredis-cli ping\n\n# Check queue metrics\ncurl http://localhost:3000/admin/email-queue \\\n  -H \"Cookie: connect.sid=...\" \\\n  -H \"x-tenant-id: default\"\n</code></pre></p> <p>Fix: <pre><code># Restart API service to restart worker\nmake restart-api\n</code></pre></p>"},{"location":"handbook/INTEGRATIONS/EMAIL/#unsubscribe-handling","title":"Unsubscribe Handling","text":"<p>Status: Not yet implemented</p> <p>Planned: - User preference stored in database - Email notifications can be disabled per-user - Unsubscribe link in all emails - Admin can disable notifications globally (tenant setting)</p> <p>Current Behavior: - Unsubscribe links included in templates - Link does not yet function (TODO)</p>"},{"location":"handbook/INTEGRATIONS/EMAIL/#configuration-summary","title":"Configuration Summary","text":"Feature Development Production Provider SMTP (Mailpit) SMTP or Resend Queue Created (BullMQ) Created (BullMQ) Worker Not started Starts automatically Redis Optional Required Testing Mailpit UI (port 8025) Live delivery Delivery Local capture External send"},{"location":"handbook/INTEGRATIONS/EMAIL/#related-documentation","title":"Related Documentation","text":"<ul> <li><code>/handbook/OPERATIONS.md</code> - Service configuration</li> <li><code>/handbook/PULSE_SYSTEM.md</code> - Pulse invite emails</li> <li><code>/handbook/ADMIN_GUIDE.md</code> - Queue monitoring</li> <li><code>/api/src/lib/email/</code> - Implementation details</li> </ul>"}]}